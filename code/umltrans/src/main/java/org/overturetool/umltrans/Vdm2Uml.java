//
// THIS FILE IS AUTOMATICALLY GENERATED!!
//
// Generated at 2008-11-08 by the VDM++ to JAVA Code Generator
// (v8.1.1b - Wed 29-Oct-2008 09:29:09)
//
// Supported compilers: jdk 1.4/1.5/1.6
//

// ***** VDMTOOLS START Name=HeaderComment KEEP=NO
// ***** VDMTOOLS END Name=HeaderComment

// ***** VDMTOOLS START Name=package KEEP=NO
package org.overturetool.umltrans;

// ***** VDMTOOLS END Name=package

// ***** VDMTOOLS START Name=imports KEEP=NO

import java.util.Enumeration;
import java.util.HashSet;
import java.util.Iterator;
import java.util.Vector;

import jp.co.csk.vdm.toolbox.VDM.CGException;
import jp.co.csk.vdm.toolbox.VDM.UTIL;

import org.overturetool.ast.imp.OmlScopeQuotes;
import org.overturetool.ast.itf.IOmlAccessDefinition;
import org.overturetool.ast.itf.IOmlAssignmentDefinition;
import org.overturetool.ast.itf.IOmlClass;
import org.overturetool.ast.itf.IOmlDefinitionBlock;
import org.overturetool.ast.itf.IOmlExplicitFunction;
import org.overturetool.ast.itf.IOmlExplicitOperation;
import org.overturetool.ast.itf.IOmlExpression;
import org.overturetool.ast.itf.IOmlFunctionDefinition;
import org.overturetool.ast.itf.IOmlFunctionDefinitions;
import org.overturetool.ast.itf.IOmlGeneralMapType;
import org.overturetool.ast.itf.IOmlInheritanceClause;
import org.overturetool.ast.itf.IOmlInjectiveMapType;
import org.overturetool.ast.itf.IOmlInstanceVariable;
import org.overturetool.ast.itf.IOmlInstanceVariableDefinitions;
import org.overturetool.ast.itf.IOmlInstanceVariableShape;
import org.overturetool.ast.itf.IOmlLiteral;
import org.overturetool.ast.itf.IOmlName;
import org.overturetool.ast.itf.IOmlOperationBody;
import org.overturetool.ast.itf.IOmlOperationDefinition;
import org.overturetool.ast.itf.IOmlOperationDefinitions;
import org.overturetool.ast.itf.IOmlOperationShape;
import org.overturetool.ast.itf.IOmlOptionalType;
import org.overturetool.ast.itf.IOmlPatternIdentifier;
import org.overturetool.ast.itf.IOmlProductType;
import org.overturetool.ast.itf.IOmlScope;
import org.overturetool.ast.itf.IOmlSeq0Type;
import org.overturetool.ast.itf.IOmlSeq1Type;
import org.overturetool.ast.itf.IOmlSetType;
import org.overturetool.ast.itf.IOmlSimpleType;
import org.overturetool.ast.itf.IOmlSpecifications;
import org.overturetool.ast.itf.IOmlSymbolicLiteralExpression;
import org.overturetool.ast.itf.IOmlTextLiteral;
import org.overturetool.ast.itf.IOmlThreadDefinition;
import org.overturetool.ast.itf.IOmlType;
import org.overturetool.ast.itf.IOmlTypeDefinition;
import org.overturetool.ast.itf.IOmlTypeDefinitions;
import org.overturetool.ast.itf.IOmlTypeName;
import org.overturetool.ast.itf.IOmlTypeShape;
import org.overturetool.ast.itf.IOmlUnionType;
import org.overturetool.ast.itf.IOmlValueDefinition;
import org.overturetool.ast.itf.IOmlValueDefinitions;
import org.overturetool.ast.itf.IOmlValueShape;



public class Vdm2Uml {

// ***** VDMTOOLS START Name=vdmComp KEEP=NO
  static UTIL.VDMCompare vdmComp = new UTIL.VDMCompare();
// ***** VDMTOOLS END Name=vdmComp

// ***** VDMTOOLS START Name=classesName KEEP=NO
  private HashSet classesName = new HashSet();
// ***** VDMTOOLS END Name=classesName

// ***** VDMTOOLS START Name=associations KEEP=NO
  private HashSet associations = new HashSet();
// ***** VDMTOOLS END Name=associations

// ***** VDMTOOLS START Name=constraints KEEP=NO
  private HashSet constraints = new HashSet();
// ***** VDMTOOLS END Name=constraints

// ***** VDMTOOLS START Name=runningId KEEP=NO
  private Integer runningId = null;
// ***** VDMTOOLS END Name=runningId


// ***** VDMTOOLS START Name=vdm_init_Vdm2Uml KEEP=NO
  private void vdm_init_Vdm2Uml () throws CGException {
    try {

      classesName = new HashSet();
      associations = new HashSet();
      constraints = new HashSet();
      runningId = new Integer(0);
    }
    catch (Exception e){

      e.printStackTrace(System.out);
      System.out.println(e.getMessage());
    }
  }
// ***** VDMTOOLS END Name=vdm_init_Vdm2Uml


// ***** VDMTOOLS START Name=Vdm2Uml KEEP=NO
  public Vdm2Uml () throws CGException {
    vdm_init_Vdm2Uml();
  }
// ***** VDMTOOLS END Name=Vdm2Uml


// ***** VDMTOOLS START Name=init#1|IOmlSpecifications KEEP=NO
  public IUmlModel init (final IOmlSpecifications specs) throws CGException {

    UmlModel tmpVal_3 = null;
    tmpVal_3 = (UmlModel) (UmlModel) build_uuml((IOmlSpecifications) specs);
    UmlModel model = null;
    model = (UmlModel) tmpVal_3;
    {

      HashSet par_6 = new HashSet();
      HashSet var1_7 = new HashSet();
      HashSet var1_8 = new HashSet();
      var1_8 = model.getDefinitions();
      var1_7 = (HashSet) var1_8.clone();
      var1_7.addAll(associations);
      par_6 = (HashSet) var1_7.clone();
      par_6.addAll(constraints);
      model.setDefinitions(par_6);
      return (IUmlModel) model;
    }
  }
// ***** VDMTOOLS END Name=init#1|IOmlSpecifications


// ***** VDMTOOLS START Name=build_uuml#1|IOmlSpecifications KEEP=NO
  public UmlModel build_uuml (final IOmlSpecifications specs) throws CGException {

    Vector classes = null;
    classes = specs.getClassList();
    Vector uml_uclasses = null;
    {

      Vector res_l_5 = new Vector();
      HashSet resBind_s_7 = new HashSet();
      HashSet riseq_11 = new HashSet();
      int max_12 = classes.size();
      for (int i_13 = 1; i_13 <= max_12; i_13++) 
        riseq_11.add(new Integer(i_13));
      resBind_s_7 = riseq_11;
      Vector bind_l_6 = null;
      bind_l_6 = UTIL.Sort(resBind_s_7);
      Integer i = null;
      for (Iterator enm_19 = bind_l_6.iterator(); enm_19.hasNext(); ) {

        Integer e_9 = UTIL.NumberToInt(enm_19.next());
        i = e_9;
        IUmlClass reselem_14 = null;
        IOmlClass par_15 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= classes.size())) 
          par_15 = (IOmlClass) classes.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        reselem_14 = (IUmlClass) convertVdm2UmlClass((IOmlClass) par_15);
        res_l_5.add(reselem_14);
      }
      uml_uclasses = res_l_5;
    }
    UmlModel rexpr_20 = null;
    HashSet arg_22 = new HashSet();
    HashSet set_24 = new HashSet();
    Enumeration enm_25 = uml_uclasses.elements();
    while ( enm_25.hasMoreElements())
      set_24.add(enm_25.nextElement());
    arg_22 = set_24;
    rexpr_20 = new UmlModel(new String("Root"), arg_22);
    return (UmlModel) rexpr_20;
  }
// ***** VDMTOOLS END Name=build_uuml#1|IOmlSpecifications


// ***** VDMTOOLS START Name=convertVdm2UmlClass#1|IOmlClass KEEP=NO
  public IUmlClass convertVdm2UmlClass (final IOmlClass c) throws CGException {

    String id = null;
    id = c.getIdentifier();
    IOmlInheritanceClause tmpVal_4 = null;
    Boolean cond_6 = null;
    cond_6 = c.hasInheritanceClause();
    if (cond_6.booleanValue()) 
      tmpVal_4 = (IOmlInheritanceClause) c.getInheritanceClause();
    else 
      tmpVal_4 = null;
    IOmlInheritanceClause inh = null;
    inh = (IOmlInheritanceClause) tmpVal_4;
    Vector body = null;
    body = c.getClassBody();
    Boolean isStatic = new Boolean(false);
    Boolean isActive = null;
    Integer var1_10 = null;
    HashSet unArg_11 = new HashSet();
    HashSet res_s_12 = new HashSet();
    {

      HashSet e_set_21 = new HashSet();
      HashSet riseq_23 = new HashSet();
      int max_24 = body.size();
      for (int i_25 = 1; i_25 <= max_24; i_25++) 
        riseq_23.add(new Integer(i_25));
      e_set_21 = riseq_23;
      Integer i = null;
      {
        for (Iterator enm_27 = e_set_21.iterator(); enm_27.hasNext(); ) {

          Integer elem_26 = UTIL.NumberToInt(enm_27.next());
          i = elem_26;
          Boolean pred_16 = null;
          IOmlDefinitionBlock obj_17 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= body.size())) 
            obj_17 = (IOmlDefinitionBlock) body.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          pred_16 = new Boolean(obj_17 instanceof IOmlThreadDefinition);
          if (pred_16.booleanValue()) {

            IOmlDefinitionBlock res_s_13 = null;
            if ((1 <= i.intValue()) && (i.intValue() <= body.size())) 
              res_s_13 = (IOmlDefinitionBlock) body.get(i.intValue() - 1);
            else 
              UTIL.RunTime("Run-Time Error:Illegal index");
            res_s_12.add(res_s_13);
          }
        }
      }
    }
    unArg_11 = res_s_12;
    var1_10 = new Integer(unArg_11.size());
    isActive = new Boolean((var1_10.intValue()) > (new Integer(0).intValue()));
    String tmpVal_29 = null;
    tmpVal_29 = id;
    String name = null;
    name = tmpVal_29;
    Vector tmpVal_30 = null;
    {

      Vector res_l_31 = new Vector();
      HashSet resBind_s_33 = new HashSet();
      HashSet riseq_37 = new HashSet();
      int max_38 = body.size();
      for (int i_39 = 1; i_39 <= max_38; i_39++) 
        riseq_37.add(new Integer(i_39));
      resBind_s_33 = riseq_37;
      Vector bind_l_32 = null;
      bind_l_32 = UTIL.Sort(resBind_s_33);
      Integer i = null;
      for (Iterator enm_48 = bind_l_32.iterator(); enm_48.hasNext(); ) {

        Integer e_35 = UTIL.NumberToInt(enm_48.next());
        i = e_35;
        IUmlDefinitionBlock reselem_40 = null;
        {

          IOmlDefinitionBlock dbs = null;
          if ((1 <= i.intValue()) && (i.intValue() <= body.size())) 
            dbs = (IOmlDefinitionBlock) body.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          reselem_40 = (IUmlDefinitionBlock) (IUmlDefinitionBlock) build_udef_ub((IOmlDefinitionBlock) dbs, name);
        }
        res_l_31.add(reselem_40);
      }
      tmpVal_30 = res_l_31;
    }
    Vector dBlock = null;
    dBlock = tmpVal_30;
    HashSet dBlockSet = new HashSet();
    HashSet res_s_50 = new HashSet();
    {

      HashSet e1_set_57 = new HashSet(dBlock);
      IUmlDefinitionBlock d = null;
      {
        for (Iterator enm_59 = e1_set_57.iterator(); enm_59.hasNext(); ) {

          IUmlDefinitionBlock elem_58 = (IUmlDefinitionBlock) enm_59.next();
          d = (IUmlDefinitionBlock) elem_58;
          if (new Boolean(!UTIL.equals(d, null)).booleanValue()) {
            res_s_50.add(d);
          }
        }
      }
    }
    dBlockSet = res_s_50;
    Boolean isAbstract = testAbstract(body);
    IUmlInheritanceClause supers = (IUmlInheritanceClause) (IUmlInheritanceClause) getSuperClasses((IOmlInheritanceClause) inh);
    UmlVisibilityKind tmpVal_64 = null;
    tmpVal_64 = (UmlVisibilityKind) new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPUBLIC);
    UmlVisibilityKind visibility = null;
    visibility = (UmlVisibilityKind) tmpVal_64;
    UmlTemplateSignature templateParameters = null;
    Boolean cond_68 = null;
    Integer var1_69 = null;
    Vector unArg_70 = null;
    unArg_70 = c.getGenericTypes();
    var1_69 = new Integer(unArg_70.size());
    cond_68 = new Boolean((var1_69.intValue()) > (new Integer(0).intValue()));
    if (cond_68.booleanValue()) {

      HashSet arg_72 = new HashSet();
      HashSet res_s_73 = new HashSet();
      {

        Vector e_set_82 = null;
        e_set_82 = c.getGenericTypes();
        IOmlType t = null;
        {
          for (Iterator enm_84 = e_set_82.iterator(); enm_84.hasNext(); ) {

            IOmlType elem_83 = (IOmlType) enm_84.next();
            t = (IOmlType) elem_83;
            UmlClassifierTemplateParameter res_s_74 = null;
            {

              IOmlTypeName tn = (IOmlTypeName) t;
              String arg_77 = null;
              IOmlName obj_79 = null;
              obj_79 = (IOmlName) tn.getName();
              arg_77 = obj_79.getIdentifier();
              res_s_74 = new UmlClassifierTemplateParameter(arg_77, new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPRIVATE));
            }
            res_s_73.add(res_s_74);
          }
        }
      }
      arg_72 = res_s_73;
      templateParameters = new UmlTemplateSignature(arg_72);
    }
    else 
      templateParameters = null;
    {

      classesName.add(name);
      return (IUmlClass) new UmlClass(name, dBlockSet, isAbstract, supers, visibility, isStatic, isActive, templateParameters);
    }
  }
// ***** VDMTOOLS END Name=convertVdm2UmlClass#1|IOmlClass


// ***** VDMTOOLS START Name=getSuperClasses#1|IOmlInheritanceClause KEEP=NO
  public IUmlInheritanceClause getSuperClasses (final IOmlInheritanceClause inh) throws CGException {
    if (new Boolean(UTIL.equals(inh, null)).booleanValue()) 
      return null;
    else {

      Vector list = null;
      list = inh.getIdentifierList();
      return (IUmlInheritanceClause) new UmlInheritanceClause(list);
    }
  }
// ***** VDMTOOLS END Name=getSuperClasses#1|IOmlInheritanceClause


// ***** VDMTOOLS START Name=testAbstract#1|Vector KEEP=NO
  public Boolean testAbstract (final Vector dBlock) throws CGException {

    Vector opList = null;
    Vector unArg_4 = null;
    {

      Vector res_l_5 = new Vector();
      HashSet resBind_s_7 = new HashSet();
      HashSet riseq_11 = new HashSet();
      int max_12 = dBlock.size();
      for (int i_13 = 1; i_13 <= max_12; i_13++) 
        riseq_11.add(new Integer(i_13));
      resBind_s_7 = riseq_11;
      Vector bind_l_6 = null;
      bind_l_6 = UTIL.Sort(resBind_s_7);
      Integer i = null;
      for (Iterator enm_24 = bind_l_6.iterator(); enm_24.hasNext(); ) {

        Integer e_9 = UTIL.NumberToInt(enm_24.next());
        i = e_9;
        Boolean pred_19 = null;
        IOmlDefinitionBlock obj_20 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= dBlock.size())) 
          obj_20 = (IOmlDefinitionBlock) dBlock.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        pred_19 = new Boolean(obj_20 instanceof IOmlOperationDefinitions);
        if (pred_19.booleanValue()) {

          Vector reselem_14 = null;
          {

            IOmlOperationDefinitions op = null;
            if ((1 <= i.intValue()) && (i.intValue() <= dBlock.size())) 
              op = (IOmlOperationDefinitions) dBlock.get(i.intValue() - 1);
            else 
              UTIL.RunTime("Run-Time Error:Illegal index");
            reselem_14 = op.getOperationList();
          }
          res_l_5.add(reselem_14);
        }
      }
      unArg_4 = res_l_5;
    }
    Vector rdcseq_25 = new Vector();
    for (Iterator enm_28 = unArg_4.iterator(); enm_28.hasNext(); ) {

      Vector e_26 = (Vector) UTIL.ConvertToList(enm_28.next());
      rdcseq_25.addAll(e_26);
    }
    opList = rdcseq_25;
    HashSet hasIsSubClassResp = new HashSet();
    HashSet res_s_30 = new HashSet();
    {

      HashSet e_set_44 = new HashSet();
      HashSet riseq_46 = new HashSet();
      int max_47 = opList.size();
      for (int i_48 = 1; i_48 <= max_47; i_48++) 
        riseq_46.add(new Integer(i_48));
      e_set_44 = riseq_46;
      Integer i = null;
      {
        for (Iterator enm_50 = e_set_44.iterator(); enm_50.hasNext(); ) {

          Integer elem_49 = UTIL.NumberToInt(enm_50.next());
          i = elem_49;
          Boolean pred_38 = null;
          IOmlOperationShape obj_39 = null;
          IOmlOperationDefinition obj_40 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= opList.size())) 
            obj_40 = (IOmlOperationDefinition) opList.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          obj_39 = (IOmlOperationShape) obj_40.getShape();
          pred_38 = new Boolean(obj_39 instanceof IOmlExplicitOperation);
          if (pred_38.booleanValue()) {

            Boolean res_s_31 = null;
            {

              IOmlExplicitOperation explicitOp = null;
              IOmlOperationDefinition obj_34 = null;
              if ((1 <= i.intValue()) && (i.intValue() <= opList.size())) 
                obj_34 = (IOmlOperationDefinition) opList.get(i.intValue() - 1);
              else 
                UTIL.RunTime("Run-Time Error:Illegal index");
              explicitOp = (IOmlExplicitOperation) obj_34.getShape();
              IOmlOperationBody obj_37 = null;
              obj_37 = (IOmlOperationBody) explicitOp.getBody();
              res_s_31 = obj_37.getSubclassResponsibility();
            }
            res_s_30.add(res_s_31);
          }
        }
      }
    }
    hasIsSubClassResp = res_s_30;
    Boolean rexpr_51 = null;
    boolean tmpQuant_52 = false;
    {

      Boolean e = null;
      {
        for (Iterator enm_59 = hasIsSubClassResp.iterator(); enm_59.hasNext() && !tmpQuant_52; ) {

          Boolean elem_58 = (Boolean) enm_59.next();
          e = elem_58;
          if (new Boolean(UTIL.equals(e, new Boolean(true))).booleanValue()) 
            tmpQuant_52 = true;
        }
      }
    }
    rexpr_51 = new Boolean(tmpQuant_52);
    return rexpr_51;
  }
// ***** VDMTOOLS END Name=testAbstract#1|Vector


// ***** VDMTOOLS START Name=build_udef_ub#2|IOmlDefinitionBlock|String KEEP=NO
  private IUmlDefinitionBlock build_udef_ub (final IOmlDefinitionBlock block, final String owner) throws CGException {

    boolean succ_3 = true;
    {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlInstanceVariableDefinitions))) 
        succ_3 = false;
      if (succ_3) {

        IOmlInstanceVariableDefinitions tmp = (IOmlInstanceVariableDefinitions) block;
        return (IUmlDefinitionBlock) build_udef_ublock((IOmlInstanceVariableDefinitions) tmp, owner);
      }
      else {

        succ_3 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlValueDefinitions))) 
          succ_3 = false;
        if (succ_3) {

          IOmlValueDefinitions tmp = (IOmlValueDefinitions) block;
          return (IUmlDefinitionBlock) build_udef_ublock((IOmlValueDefinitions) tmp, owner);
        }
        else {

          succ_3 = true;
          if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlTypeDefinitions))) 
            succ_3 = false;
          if (succ_3) {

            IOmlTypeDefinitions tmp = (IOmlTypeDefinitions) block;
            return (IUmlDefinitionBlock) build_udef_ublock((IOmlTypeDefinitions) tmp, owner);
          }
          else {

            succ_3 = true;
            if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlOperationDefinitions))) 
              succ_3 = false;
            if (succ_3) {

              IOmlOperationDefinitions tmp = (IOmlOperationDefinitions) block;
              return (IUmlDefinitionBlock) build_udef_ublock((IOmlOperationDefinitions) tmp, owner);
            }
            else {

              succ_3 = true;
              if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlFunctionDefinitions))) 
                succ_3 = false;
              if (succ_3) {

                IOmlFunctionDefinitions tmp = (IOmlFunctionDefinitions) block;
                return (IUmlDefinitionBlock) build_udef_ublock((IOmlFunctionDefinitions) tmp, owner);
              }
              else 
                return null;
            }
          }
        }
      }
    }
  }
// ***** VDMTOOLS END Name=build_udef_ub#2|IOmlDefinitionBlock|String


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlInstanceVariableDefinitions|String KEEP=NO
  public IUmlOwnedPropeties build_udef_ublock (final IOmlInstanceVariableDefinitions v, final String owner) throws CGException {

    Vector q = null;
    q = v.getVariablesList();
    Vector tmpVal_5 = null;
    {

      Vector res_l_6 = new Vector();
      HashSet resBind_s_8 = new HashSet();
      HashSet riseq_12 = new HashSet();
      int max_13 = q.size();
      for (int i_14 = 1; i_14 <= max_13; i_14++) 
        riseq_12.add(new Integer(i_14));
      resBind_s_8 = riseq_12;
      Vector bind_l_7 = null;
      bind_l_7 = UTIL.Sort(resBind_s_8);
      Integer i = null;
      for (Iterator enm_25 = bind_l_7.iterator(); enm_25.hasNext(); ) {

        Integer e_10 = UTIL.NumberToInt(enm_25.next());
        i = e_10;
        Boolean pred_20 = null;
        IOmlInstanceVariableShape obj_21 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
          obj_21 = (IOmlInstanceVariableShape) q.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        pred_20 = new Boolean(obj_21 instanceof IOmlInstanceVariable);
        if (pred_20.booleanValue()) {

          IUmlProperty reselem_15 = null;
          IOmlInstanceVariableShape par_16 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
            par_16 = (IOmlInstanceVariableShape) q.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          reselem_15 = (IUmlProperty) buildVariables((IOmlInstanceVariable) par_16, owner);
          res_l_6.add(reselem_15);
        }
      }
      tmpVal_5 = res_l_6;
    }
    Vector props = null;
    props = tmpVal_5;
    HashSet propsNoNil = new HashSet();
    HashSet res_s_27 = new HashSet();
    {

      HashSet e1_set_34 = new HashSet(props);
      IUmlProperty p = null;
      {
        for (Iterator enm_36 = e1_set_34.iterator(); enm_36.hasNext(); ) {

          IUmlProperty elem_35 = (IUmlProperty) enm_36.next();
          p = (IUmlProperty) elem_35;
          if (new Boolean(!UTIL.equals(p, null)).booleanValue()) {
            res_s_27.add(p);
          }
        }
      }
    }
    propsNoNil = res_s_27;
    return (IUmlOwnedPropeties) new UmlOwnedPropeties(propsNoNil);
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlInstanceVariableDefinitions|String


// ***** VDMTOOLS START Name=buildVariables#2|IOmlInstanceVariable|String KEEP=NO
  public IUmlProperty buildVariables (final IOmlInstanceVariable vdm_var, final String owner) throws CGException {

    IOmlAccessDefinition access = null;
    access = (IOmlAccessDefinition) vdm_var.getAccess();
    IOmlScope scope = null;
    scope = (IOmlScope) access.getScope();
    IOmlAssignmentDefinition assign = null;
    assign = (IOmlAssignmentDefinition) vdm_var.getAssignmentDefinition();
    Boolean isStatic = null;
    isStatic = access.getStaticAccess();
    String tmpVal_8 = null;
    tmpVal_8 = assign.getIdentifier();
    String name = null;
    name = tmpVal_8;
    IUmlVisibilityKind tmpVal_9 = null;
    tmpVal_9 = (IUmlVisibilityKind) (IUmlVisibilityKind) convertScopeToVisibility((IOmlScope) scope);
    IUmlVisibilityKind visibility = null;
    visibility = (IUmlVisibilityKind) tmpVal_9;
    IUmlMultiplicityElement multiplicity = null;
    IOmlType par_12 = null;
    par_12 = (IOmlType) assign.getType();
    multiplicity = (IUmlMultiplicityElement) Vdm2UmlType.exstractMultiplicity((IOmlType) par_12);
    IUmlType tmpVal_13 = null;
    IOmlType par_14 = null;
    par_14 = (IOmlType) assign.getType();
    tmpVal_13 = (IUmlType) Vdm2UmlType.convertPropertyType((IOmlType) par_14, owner);
    IUmlType type = null;
    type = (IUmlType) tmpVal_13;
    IOmlType omlType = null;
    omlType = (IOmlType) assign.getType();
    Boolean isReadOnly = new Boolean(false);
    String vdm_default = null;
    Boolean cond_20 = null;
    cond_20 = assign.hasExpression();
    if (cond_20.booleanValue()) {

      IOmlExpression par_21 = null;
      par_21 = (IOmlExpression) assign.getExpression();
      vdm_default = getDefaultValue((IOmlExpression) par_21);
    }
    else 
      vdm_default = null;
    Boolean isComposite = new Boolean(false);
    Boolean isDerived = new Boolean(false);
    IUmlType qualifier = null;
    IOmlType par_25 = null;
    par_25 = (IOmlType) assign.getType();
    qualifier = (IUmlType) Vdm2UmlType.getQualifier((IOmlType) par_25);
    {

      IUmlProperty property = (IUmlProperty) new UmlProperty(name, visibility, multiplicity, type, isReadOnly, vdm_default, isComposite, isDerived, isStatic, owner, qualifier);
      if (new Boolean(!isSimpleType((IOmlType) omlType).booleanValue()).booleanValue()) {

        CreateAssociationFromPropety((IUmlProperty) property, (IOmlType) omlType);
        return null;
      }
      else 
        return (IUmlProperty) property;
    }
  }
// ***** VDMTOOLS END Name=buildVariables#2|IOmlInstanceVariable|String


// ***** VDMTOOLS START Name=getDefaultValue#1|IOmlExpression KEEP=NO
  public String getDefaultValue (final IOmlExpression expression) throws CGException {

    boolean succ_2 = true;
    {

      succ_2 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(expression instanceof IOmlSymbolicLiteralExpression))) 
        succ_2 = false;
      if (succ_2) {

        IOmlSymbolicLiteralExpression se = (IOmlSymbolicLiteralExpression) expression;
        boolean succ_10 = true;
        {

          succ_10 = true;
          Boolean tmpVal_v_14 = null;
          IOmlLiteral obj_15 = null;
          obj_15 = (IOmlLiteral) se.getLiteral();
          tmpVal_v_14 = new Boolean(obj_15 instanceof IOmlTextLiteral);
          if (!UTIL.equals(new Boolean(true), tmpVal_v_14)) 
            succ_10 = false;
          if (succ_10) {

            IOmlTextLiteral tx = null;
            tx = (IOmlTextLiteral) se.getLiteral();
            String rexpr_18 = null;
            rexpr_18 = tx.getVal();
            return rexpr_18;
          }
          else 
            return null;
        }
      }
      else 
        return null;
    }
  }
// ***** VDMTOOLS END Name=getDefaultValue#1|IOmlExpression


// ***** VDMTOOLS START Name=convertScopeToVisibility#1|IOmlScope KEEP=NO
  public IUmlVisibilityKind convertScopeToVisibility (final IOmlScope sc) throws CGException {

    long  val = 0;
    val = sc.getValue();
    boolean succ_4 = true;
    {

      succ_4 = true;
      if (!UTIL.equals(val, OmlScopeQuotes.IQPUBLIC)) 
        succ_4 = false;
      if (succ_4) 
        return (IUmlVisibilityKind) new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPUBLIC);
      else {

        succ_4 = true;
        if (!UTIL.equals(val, OmlScopeQuotes.IQPRIVATE)) 
          succ_4 = false;
        if (!succ_4) {

          succ_4 = true;
          if (!UTIL.equals(val, OmlScopeQuotes.IQDEFAULT)) 
            succ_4 = false;
        }
        if (succ_4) 
          return (IUmlVisibilityKind) new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPRIVATE);
        else {

          succ_4 = true;
          if (!UTIL.equals(val, OmlScopeQuotes.IQPROTECTED)) 
            succ_4 = false;
          if (succ_4) 
            return (IUmlVisibilityKind) new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPROTECTED);
        }
      }
    }
    throw new CGException();
  }
// ***** VDMTOOLS END Name=convertScopeToVisibility#1|IOmlScope


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlValueDefinitions|String KEEP=NO
  public IUmlOwnedPropeties build_udef_ublock (final IOmlValueDefinitions v, final String owner) throws CGException {

    Vector q = null;
    q = v.getValueList();
    Vector tmpVal_5 = null;
    {

      Vector res_l_6 = new Vector();
      HashSet resBind_s_8 = new HashSet();
      HashSet riseq_12 = new HashSet();
      int max_13 = q.size();
      for (int i_14 = 1; i_14 <= max_13; i_14++) 
        riseq_12.add(new Integer(i_14));
      resBind_s_8 = riseq_12;
      Vector bind_l_7 = null;
      bind_l_7 = UTIL.Sort(resBind_s_8);
      Integer i = null;
      for (Iterator enm_21 = bind_l_7.iterator(); enm_21.hasNext(); ) {

        Integer e_10 = UTIL.NumberToInt(enm_21.next());
        i = e_10;
        IUmlProperty reselem_15 = null;
        IOmlValueDefinition par_16 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
          par_16 = (IOmlValueDefinition) q.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        reselem_15 = (IUmlProperty) buildValues((IOmlValueDefinition) par_16, owner);
        res_l_6.add(reselem_15);
      }
      tmpVal_5 = res_l_6;
    }
    Vector props = null;
    props = tmpVal_5;
    HashSet propsNoNil = new HashSet();
    HashSet res_s_23 = new HashSet();
    {

      HashSet e1_set_30 = new HashSet(props);
      IUmlProperty p = null;
      {
        for (Iterator enm_32 = e1_set_30.iterator(); enm_32.hasNext(); ) {

          IUmlProperty elem_31 = (IUmlProperty) enm_32.next();
          p = (IUmlProperty) elem_31;
          if (new Boolean(!UTIL.equals(p, null)).booleanValue()) {
            res_s_23.add(p);
          }
        }
      }
    }
    propsNoNil = res_s_23;
    return (IUmlOwnedPropeties) new UmlOwnedPropeties(propsNoNil);
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlValueDefinitions|String


// ***** VDMTOOLS START Name=buildValues#2|IOmlValueDefinition|String KEEP=NO
  public IUmlProperty buildValues (final IOmlValueDefinition vdm_var, final String owner) throws CGException {

    IOmlAccessDefinition access = null;
    access = (IOmlAccessDefinition) vdm_var.getAccess();
    IOmlScope scope = null;
    scope = (IOmlScope) access.getScope();
    IOmlValueShape shape = null;
    shape = (IOmlValueShape) vdm_var.getShape();
    Boolean isStatic = null;
    isStatic = access.getStaticAccess();
    IOmlPatternIdentifier patternIdent = null;
    patternIdent = (IOmlPatternIdentifier) shape.getPattern();
    String tmpVal_9 = null;
    tmpVal_9 = patternIdent.getIdentifier();
    String name = null;
    name = tmpVal_9;
    IUmlVisibilityKind tmpVal_10 = null;
    tmpVal_10 = (IUmlVisibilityKind) (IUmlVisibilityKind) convertScopeToVisibility((IOmlScope) scope);
    IUmlVisibilityKind visibility = null;
    visibility = (IUmlVisibilityKind) tmpVal_10;
    IUmlMultiplicityElement multiplicity = null;
    IOmlType par_13 = null;
    par_13 = (IOmlType) shape.getType();
    multiplicity = (IUmlMultiplicityElement) Vdm2UmlType.exstractMultiplicity((IOmlType) par_13);
    IUmlType tmpVal_14 = null;
    IOmlType par_15 = null;
    par_15 = (IOmlType) shape.getType();
    tmpVal_14 = (IUmlType) Vdm2UmlType.convertType((IOmlType) par_15);
    IUmlType type = null;
    type = (IUmlType) tmpVal_14;
    Boolean isReadOnly = new Boolean(true);
    String vdm_default = null;
    IOmlExpression par_18 = null;
    par_18 = (IOmlExpression) shape.getExpression();
    vdm_default = getDefaultValue((IOmlExpression) par_18);
    Boolean isComposite = new Boolean(false);
    Boolean isDerived = new Boolean(false);
    IUmlType qualifier = null;
    IOmlType par_22 = null;
    par_22 = (IOmlType) shape.getType();
    qualifier = (IUmlType) Vdm2UmlType.getQualifier((IOmlType) par_22);
    IOmlType omlType = null;
    omlType = (IOmlType) shape.getType();
    {

      IUmlProperty property = (IUmlProperty) new UmlProperty(name, visibility, multiplicity, type, isReadOnly, vdm_default, isComposite, isDerived, isStatic, owner, qualifier);
      if (new Boolean(!isSimpleType((IOmlType) omlType).booleanValue()).booleanValue()) {

        CreateAssociationFromPropety((IUmlProperty) property, (IOmlType) omlType);
        return null;
      }
      else 
        return (IUmlProperty) property;
    }
  }
// ***** VDMTOOLS END Name=buildValues#2|IOmlValueDefinition|String


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlTypeDefinitions|String KEEP=NO
  public IUmlOwnedTypes build_udef_ublock (final IOmlTypeDefinitions var_1_1, final String var_2_2) throws CGException {

    IOmlTypeDefinitions td = null;
    boolean succ_3 = true;
    td = (IOmlTypeDefinitions) var_1_1;
    if (!succ_3) 
      UTIL.RunTime("Run-Time Error:Pattern match failed in operation call in operation build_udef_ublock");
    {

      Vector q = null;
      q = td.getTypeList();
      Vector tmpVal_6 = null;
      {

        Vector res_l_7 = new Vector();
        HashSet resBind_s_9 = new HashSet();
        HashSet riseq_13 = new HashSet();
        int max_14 = q.size();
        for (int i_15 = 1; i_15 <= max_14; i_15++) 
          riseq_13.add(new Integer(i_15));
        resBind_s_9 = riseq_13;
        Vector bind_l_8 = null;
        bind_l_8 = UTIL.Sort(resBind_s_9);
        Integer i = null;
        for (Iterator enm_27 = bind_l_8.iterator(); enm_27.hasNext(); ) {

          Integer e_11 = UTIL.NumberToInt(enm_27.next());
          i = e_11;
          Boolean pred_21 = null;
          IOmlTypeShape obj_22 = null;
          IOmlTypeDefinition obj_23 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
            obj_23 = (IOmlTypeDefinition) q.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          obj_22 = (IOmlTypeShape) obj_23.getShape();
          pred_21 = new Boolean(obj_22 instanceof IOmlSimpleType);
          if (pred_21.booleanValue()) {

            IUmlType reselem_16 = null;
            IOmlTypeShape par_17 = null;
            IOmlTypeDefinition obj_18 = null;
            if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
              obj_18 = (IOmlTypeDefinition) q.get(i.intValue() - 1);
            else 
              UTIL.RunTime("Run-Time Error:Illegal index");
            par_17 = (IOmlTypeShape) obj_18.getShape();
            reselem_16 = (IUmlType) buildType((IOmlSimpleType) par_17);
            res_l_7.add(reselem_16);
          }
        }
        tmpVal_6 = res_l_7;
      }
      Vector tps = null;
      tps = tmpVal_6;
      UmlOwnedTypes rexpr_28 = null;
      HashSet arg_29 = new HashSet();
      HashSet set_31 = new HashSet();
      Enumeration enm_32 = tps.elements();
      while ( enm_32.hasMoreElements())
        set_31.add(enm_32.nextElement());
      arg_29 = set_31;
      rexpr_28 = new UmlOwnedTypes(arg_29);
      return (IUmlOwnedTypes) rexpr_28;
    }
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlTypeDefinitions|String


// ***** VDMTOOLS START Name=buildType#1|IOmlSimpleType KEEP=NO
  public IUmlType buildType (final IOmlSimpleType vdm_var) throws CGException {

    IUmlType rexpr_2 = null;
    IOmlType par_3 = null;
    par_3 = (IOmlType) vdm_var.getType();
    rexpr_2 = (IUmlType) Vdm2UmlType.convertType((IOmlType) par_3);
    return (IUmlType) rexpr_2;
  }
// ***** VDMTOOLS END Name=buildType#1|IOmlSimpleType


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlOperationDefinitions|String KEEP=NO
  public IUmlOwnedOperations build_udef_ublock (final IOmlOperationDefinitions opDef, final String owner) throws CGException {

    Vector tmpVal_4 = null;
    tmpVal_4 = opDef.getOperationList();
    Vector ops = null;
    ops = tmpVal_4;
    UmlOwnedOperations rexpr_5 = null;
    HashSet arg_6 = new HashSet();
    HashSet res_s_7 = new HashSet();
    {

      HashSet e_set_14 = new HashSet();
      HashSet riseq_16 = new HashSet();
      int max_17 = ops.size();
      for (int i_18 = 1; i_18 <= max_17; i_18++) 
        riseq_16.add(new Integer(i_18));
      e_set_14 = riseq_16;
      Integer i = null;
      {
        for (Iterator enm_20 = e_set_14.iterator(); enm_20.hasNext(); ) {

          Integer elem_19 = UTIL.NumberToInt(enm_20.next());
          i = elem_19;
          IUmlOperation res_s_8 = null;
          IOmlOperationDefinition par_9 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= ops.size())) 
            par_9 = (IOmlOperationDefinition) ops.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          res_s_8 = (IUmlOperation) buildOperation((IOmlOperationDefinition) par_9, owner);
          res_s_7.add(res_s_8);
        }
      }
    }
    arg_6 = res_s_7;
    rexpr_5 = new UmlOwnedOperations(arg_6);
    return (IUmlOwnedOperations) rexpr_5;
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlOperationDefinitions|String


// ***** VDMTOOLS START Name=buildOperation#2|IOmlOperationDefinition|String KEEP=NO
  public IUmlOperation buildOperation (final IOmlOperationDefinition var_1_1, final String var_2_2) throws CGException {

    IOmlOperationDefinition op = null;
    boolean succ_3 = true;
    op = (IOmlOperationDefinition) var_1_1;
    if (!succ_3) 
      UTIL.RunTime("Run-Time Error:Pattern match failed in operation call in operation buildOperation");
    {

      IOmlAccessDefinition access = null;
      access = (IOmlAccessDefinition) op.getAccess();
      IOmlScope scope = null;
      scope = (IOmlScope) access.getScope();
      IOmlExplicitOperation shape = null;
      shape = (IOmlExplicitOperation) op.getShape();
      Boolean isStatic = null;
      isStatic = access.getStaticAccess();
      String tmpVal_9 = null;
      tmpVal_9 = shape.getIdentifier();
      String name = null;
      name = tmpVal_9;
      IUmlVisibilityKind tmpVal_10 = null;
      tmpVal_10 = (IUmlVisibilityKind) (IUmlVisibilityKind) convertScopeToVisibility((IOmlScope) scope);
      IUmlVisibilityKind visibility = null;
      visibility = (IUmlVisibilityKind) tmpVal_10;
      UmlMultiplicityElement multiplicity = (UmlMultiplicityElement) new UmlMultiplicityElement(new Boolean(false), new Boolean(false), new Integer(1), new Integer(1));
      IUmlType tmpVal_17 = null;
      IOmlType par_18 = null;
      par_18 = (IOmlType) shape.getType();
      tmpVal_17 = (IUmlType) Vdm2UmlType.convertType((IOmlType) par_18);
      IUmlType type = null;
      type = (IUmlType) tmpVal_17;
      return (IUmlOperation) new UmlOperation(name, visibility, multiplicity, new Boolean(false), type, isStatic);
    }
  }
// ***** VDMTOOLS END Name=buildOperation#2|IOmlOperationDefinition|String


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlFunctionDefinitions|String KEEP=NO
  public IUmlOwnedOperations build_udef_ublock (final IOmlFunctionDefinitions opDef, final String owner) throws CGException {

    Vector tmpVal_4 = null;
    tmpVal_4 = opDef.getFunctionList();
    Vector ops = null;
    ops = tmpVal_4;
    UmlOwnedOperations rexpr_5 = null;
    HashSet arg_6 = new HashSet();
    HashSet res_s_7 = new HashSet();
    {

      HashSet e_set_14 = new HashSet();
      HashSet riseq_16 = new HashSet();
      int max_17 = ops.size();
      for (int i_18 = 1; i_18 <= max_17; i_18++) 
        riseq_16.add(new Integer(i_18));
      e_set_14 = riseq_16;
      Integer i = null;
      {
        for (Iterator enm_20 = e_set_14.iterator(); enm_20.hasNext(); ) {

          Integer elem_19 = UTIL.NumberToInt(enm_20.next());
          i = elem_19;
          IUmlOperation res_s_8 = null;
          IOmlFunctionDefinition par_9 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= ops.size())) 
            par_9 = (IOmlFunctionDefinition) ops.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          res_s_8 = (IUmlOperation) buildFunction((IOmlFunctionDefinition) par_9, owner);
          res_s_7.add(res_s_8);
        }
      }
    }
    arg_6 = res_s_7;
    rexpr_5 = new UmlOwnedOperations(arg_6);
    return (IUmlOwnedOperations) rexpr_5;
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlFunctionDefinitions|String


// ***** VDMTOOLS START Name=buildFunction#2|IOmlFunctionDefinition|String KEEP=NO
  public IUmlOperation buildFunction (final IOmlFunctionDefinition var_1_1, final String var_2_2) throws CGException {

    IOmlFunctionDefinition op = null;
    boolean succ_3 = true;
    op = (IOmlFunctionDefinition) var_1_1;
    if (!succ_3) 
      UTIL.RunTime("Run-Time Error:Pattern match failed in operation call in operation buildFunction");
    {

      IOmlAccessDefinition access = null;
      access = (IOmlAccessDefinition) op.getAccess();
      IOmlScope scope = null;
      scope = (IOmlScope) access.getScope();
      IOmlExplicitFunction shape = null;
      shape = (IOmlExplicitFunction) op.getShape();
      Boolean isStatic = null;
      isStatic = access.getStaticAccess();
      String tmpVal_9 = null;
      tmpVal_9 = shape.getIdentifier();
      String name = null;
      name = tmpVal_9;
      IUmlVisibilityKind tmpVal_10 = null;
      tmpVal_10 = (IUmlVisibilityKind) (IUmlVisibilityKind) convertScopeToVisibility((IOmlScope) scope);
      IUmlVisibilityKind visibility = null;
      visibility = (IUmlVisibilityKind) tmpVal_10;
      UmlMultiplicityElement multiplicity = (UmlMultiplicityElement) new UmlMultiplicityElement(new Boolean(false), new Boolean(false), new Integer(1), new Integer(1));
      IUmlType tmpVal_17 = null;
      IOmlType par_18 = null;
      par_18 = (IOmlType) shape.getType();
      tmpVal_17 = (IUmlType) Vdm2UmlType.convertType((IOmlType) par_18);
      IUmlType type = null;
      type = (IUmlType) tmpVal_17;
      return (IUmlOperation) new UmlOperation(name, visibility, multiplicity, new Boolean(true), type, isStatic);
    }
  }
// ***** VDMTOOLS END Name=buildFunction#2|IOmlFunctionDefinition|String


// ***** VDMTOOLS START Name=isSimpleType#1|IOmlType KEEP=NO
  public Boolean isSimpleType (final IOmlType t) throws CGException {

    boolean succ_2 = true;
    {

      succ_2 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlInjectiveMapType))) 
        succ_2 = false;
      if (!succ_2) {

        succ_2 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlGeneralMapType))) 
          succ_2 = false;
      }
      if (!succ_2) {

        succ_2 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlTypeName))) 
          succ_2 = false;
      }
      if (!succ_2) {

        succ_2 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlProductType))) 
          succ_2 = false;
      }
      if (!succ_2) {

        succ_2 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlUnionType))) 
          succ_2 = false;
      }
      if (succ_2) 
        return new Boolean(false);
      else {

        succ_2 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlSetType))) 
          succ_2 = false;
        if (succ_2) {

          IOmlSetType t1 = (IOmlSetType) t;
          Boolean rexpr_28 = null;
          IOmlType par_29 = null;
          par_29 = (IOmlType) t1.getType();
          rexpr_28 = isSimpleType((IOmlType) par_29);
          return rexpr_28;
        }
        else {

          succ_2 = true;
          if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlSeq0Type))) 
            succ_2 = false;
          if (succ_2) {

            IOmlSeq0Type t1 = (IOmlSeq0Type) t;
            Boolean rexpr_22 = null;
            IOmlType par_23 = null;
            par_23 = (IOmlType) t1.getType();
            rexpr_22 = isSimpleType((IOmlType) par_23);
            return rexpr_22;
          }
          else {

            succ_2 = true;
            if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlSeq1Type))) 
              succ_2 = false;
            if (succ_2) {

              IOmlSeq1Type t1 = (IOmlSeq1Type) t;
              Boolean rexpr_16 = null;
              IOmlType par_17 = null;
              par_17 = (IOmlType) t1.getType();
              rexpr_16 = isSimpleType((IOmlType) par_17);
              return rexpr_16;
            }
            else {

              succ_2 = true;
              if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlOptionalType))) 
                succ_2 = false;
              if (succ_2) {

                IOmlOptionalType t1 = (IOmlOptionalType) t;
                Boolean rexpr_10 = null;
                IOmlType par_11 = null;
                par_11 = (IOmlType) t1.getType();
                rexpr_10 = isSimpleType((IOmlType) par_11);
                return rexpr_10;
              }
              else 
                return new Boolean(true);
            }
          }
        }
      }
    }
  }
// ***** VDMTOOLS END Name=isSimpleType#1|IOmlType


// ***** VDMTOOLS START Name=GetSimpleTypeName#1|IUmlType KEEP=NO
  private String GetSimpleTypeName (final IUmlType t) throws CGException {

    boolean succ_2 = true;
    {

      succ_2 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IUmlBoolType))) 
        succ_2 = false;
      if (succ_2) 
        return new String("bool");
      else {

        succ_2 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IUmlIntegerType))) 
          succ_2 = false;
        if (succ_2) 
          return new String("int");
        else {

          succ_2 = true;
          if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IUmlCharType))) 
            succ_2 = false;
          if (succ_2) 
            return new String("char");
          else 
            return new String("String");
        }
      }
    }
  }
// ***** VDMTOOLS END Name=GetSimpleTypeName#1|IUmlType


// ***** VDMTOOLS START Name=CreateAssociationFromPropety#2|IUmlProperty|IOmlType KEEP=NO
  public void CreateAssociationFromPropety (final IUmlProperty property, final IOmlType omlType) throws CGException {

    boolean succ_3 = true;
    {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(omlType instanceof IOmlProductType))) 
        succ_3 = false;
      if (succ_3) 
        CreateAssociationFromPropetyProductType((IUmlProperty) property, (IOmlType) omlType);
      else {

        succ_3 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(omlType instanceof IOmlUnionType))) 
          succ_3 = false;
        if (succ_3) 
          CreateAssociationFromPropetyUnionType((IUmlProperty) property, (IOmlType) omlType);
        else 
          CreateAssociationFromPropetyGeneral((IUmlProperty) property, (IOmlType) omlType);
      }
    }
  }
// ***** VDMTOOLS END Name=CreateAssociationFromPropety#2|IUmlProperty|IOmlType


// ***** VDMTOOLS START Name=CreateAssociationFromPropetyGeneral#2|IUmlProperty|IOmlType KEEP=NO
  public void CreateAssociationFromPropetyGeneral (final IUmlProperty var_1_1, final IOmlType var_2_2) throws CGException {

    IUmlProperty property = null;
    boolean succ_3 = true;
    property = (IUmlProperty) var_1_1;
    if (!succ_3) 
      UTIL.RunTime("Run-Time Error:Pattern match failed in operation call in operation CreateAssociationFromPropetyGeneral");
    {

      String ownerClassName = null;
      Boolean cond_7 = null;
      IUmlType obj_8 = null;
      obj_8 = (IUmlType) property.getType();
      cond_7 = new Boolean(obj_8 instanceof IUmlClassNameType);
      if (cond_7.booleanValue()) {

        IUmlClassNameType pcn = null;
        pcn = (IUmlClassNameType) property.getType();
        ownerClassName = pcn.getName();
      }
      else {

        IUmlType par_9 = null;
        par_9 = (IUmlType) property.getType();
        ownerClassName = GetSimpleTypeName((IUmlType) par_9);
      }
      HashSet propOtherEnd = new HashSet();
      UmlProperty enum_set_13 = null;
      UmlClassNameType arg_17 = null;
      String arg_26 = null;
      arg_26 = property.getOwnerClass();
      arg_17 = new UmlClassNameType(arg_26);
      enum_set_13 = new UmlProperty(new String(""), new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPRIVATE), null, arg_17, null, null, new Boolean(false), null, null, ownerClassName, null);
      propOtherEnd = new HashSet();
      propOtherEnd.add(enum_set_13);
      UmlAssociation elem_28 = null;
      HashSet arg_30 = new HashSet();
      arg_30 = new HashSet();
      arg_30.add(property);
      elem_28 = new UmlAssociation(propOtherEnd, arg_30, null, GetNextId());
      associations.add(elem_28);
    }
  }
// ***** VDMTOOLS END Name=CreateAssociationFromPropetyGeneral#2|IUmlProperty|IOmlType


// ***** VDMTOOLS START Name=CreateAssociationFromPropetyProductType#2|IUmlProperty|IOmlType KEEP=NO
  public void CreateAssociationFromPropetyProductType (final IUmlProperty property, final IOmlType omlType) throws CGException {

    String tmpVal_4 = null;
    tmpVal_4 = property.getName();
    String name = null;
    name = tmpVal_4;
    IUmlProperty tmpVal_5 = null;
    tmpVal_5 = (IUmlProperty) property;
    UmlProperty prop = null;
    prop = (UmlProperty) tmpVal_5;
    {

      HashSet props = new HashSet();
      HashSet unArg_6 = new HashSet();
      HashSet res_s_7 = new HashSet();
      {

        HashSet e_set_14 = new HashSet();
        e_set_14 = new HashSet();
        e_set_14.add(omlType);
        IOmlType p = null;
        {
          for (Iterator enm_17 = e_set_14.iterator(); enm_17.hasNext(); ) {

            IOmlType elem_16 = (IOmlType) enm_17.next();
            p = (IOmlType) elem_16;
            if (new Boolean(p instanceof IOmlProductType).booleanValue()) {
              res_s_7.add(CreateProductProperty((IOmlType) p, name));
            }
          }
        }
      }
      unArg_6 = res_s_7;
      HashSet rduset_18 = new HashSet();
      for (Iterator enm_20 = unArg_6.iterator(); enm_20.hasNext(); ) {

        HashSet e_19 = (HashSet) enm_20.next();
        rduset_18.addAll(e_19);
      }
      props = rduset_18;
      prop.setName(new String(""));
      if (new Boolean((new Integer(props.size()).intValue()) > (new Integer(1).intValue())).booleanValue()) {

        UmlAssociation elem_28 = null;
        HashSet arg_30 = new HashSet();
        arg_30 = new HashSet();
        arg_30.add(prop);
        elem_28 = new UmlAssociation(props, arg_30, null, GetNextId());
        associations.add(elem_28);
      }
    }
  }
// ***** VDMTOOLS END Name=CreateAssociationFromPropetyProductType#2|IUmlProperty|IOmlType


// ***** VDMTOOLS START Name=CreateAssociationFromPropetyUnionType#2|IUmlProperty|IOmlType KEEP=NO
  public void CreateAssociationFromPropetyUnionType (final IUmlProperty property, final IOmlType omlType) throws CGException {

    String tmpVal_4 = null;
    tmpVal_4 = property.getName();
    String name = null;
    name = tmpVal_4;
    IUmlProperty tmpVal_5 = null;
    tmpVal_5 = (IUmlProperty) property;
    UmlProperty prop = null;
    prop = (UmlProperty) tmpVal_5;
    {

      HashSet props = new HashSet();
      HashSet unArg_6 = new HashSet();
      HashSet res_s_7 = new HashSet();
      {

        HashSet e_set_14 = new HashSet();
        e_set_14 = new HashSet();
        e_set_14.add(omlType);
        IOmlType p = null;
        {
          for (Iterator enm_17 = e_set_14.iterator(); enm_17.hasNext(); ) {

            IOmlType elem_16 = (IOmlType) enm_17.next();
            p = (IOmlType) elem_16;
            if (new Boolean(p instanceof IOmlUnionType).booleanValue()) {
              res_s_7.add(CreateProductProperty((IOmlType) p, name));
            }
          }
        }
      }
      unArg_6 = res_s_7;
      HashSet rduset_18 = new HashSet();
      for (Iterator enm_20 = unArg_6.iterator(); enm_20.hasNext(); ) {

        HashSet e_19 = (HashSet) enm_20.next();
        rduset_18.addAll(e_19);
      }
      props = rduset_18;
      prop.setName(new String(""));
      if (new Boolean((new Integer(props.size()).intValue()) > (new Integer(1).intValue())).booleanValue()) {

        HashSet assoc = new HashSet();
        HashSet res_s_27 = new HashSet();
        {

          IUmlProperty p = null;
          {
            for (Iterator enm_38 = props.iterator(); enm_38.hasNext(); ) {

              IUmlProperty elem_37 = (IUmlProperty) enm_38.next();
              p = (IUmlProperty) elem_37;
              UmlAssociation res_s_28 = null;
              HashSet arg_29 = new HashSet();
              arg_29 = new HashSet();
              arg_29.add(p);
              HashSet arg_30 = new HashSet();
              arg_30 = new HashSet();
              arg_30.add(prop);
              res_s_28 = new UmlAssociation(arg_29, arg_30, null, GetNextId());
              res_s_27.add(res_s_28);
            }
          }
        }
        assoc = res_s_27;
        HashSet rhs_39 = new HashSet();
        rhs_39 = (HashSet) associations.clone();
        rhs_39.addAll(assoc);
        associations = (HashSet) UTIL.clone(rhs_39);
        UmlConstraint elem_43 = null;
        HashSet arg_44 = new HashSet();
        HashSet res_s_46 = new HashSet();
        {

          IUmlAssociation a = null;
          {
            for (Iterator enm_51 = assoc.iterator(); enm_51.hasNext(); ) {

              IUmlAssociation elem_50 = (IUmlAssociation) enm_51.next();
              a = (IUmlAssociation) elem_50;
              String res_s_47 = null;
              res_s_47 = a.getId();
              res_s_46.add(res_s_47);
            }
          }
        }
        arg_44 = res_s_46;
        elem_43 = new UmlConstraint(arg_44, new String("xor"));
        constraints.add(elem_43);
      }
    }
  }
// ***** VDMTOOLS END Name=CreateAssociationFromPropetyUnionType#2|IUmlProperty|IOmlType


// ***** VDMTOOLS START Name=CreateProductProperty#2|IOmlType|String KEEP=NO
  public HashSet CreateProductProperty (final IOmlType t, final String name) throws CGException {
    if (new Boolean(t instanceof IOmlProductType).booleanValue()) {

      IOmlProductType typedType = (IOmlProductType) t;
      HashSet rexpr_35 = new HashSet();
      HashSet var1_36 = new HashSet();
      IOmlType par_37 = null;
      par_37 = (IOmlType) typedType.getLhsType();
      var1_36 = CreateProductProperty((IOmlType) par_37, name);
      HashSet var2_39 = new HashSet();
      IOmlType par_40 = null;
      par_40 = (IOmlType) typedType.getRhsType();
      var2_39 = CreateProductProperty((IOmlType) par_40, name);
      rexpr_35 = (HashSet) var1_36.clone();
      rexpr_35.addAll(var2_39);
      return rexpr_35;
    }
    else 
      if (new Boolean(t instanceof IOmlUnionType).booleanValue()) {

        IOmlUnionType typedType = (IOmlUnionType) t;
        HashSet rexpr_26 = new HashSet();
        HashSet var1_27 = new HashSet();
        IOmlType par_28 = null;
        par_28 = (IOmlType) typedType.getLhsType();
        var1_27 = CreateProductProperty((IOmlType) par_28, name);
        HashSet var2_30 = new HashSet();
        IOmlType par_31 = null;
        par_31 = (IOmlType) typedType.getRhsType();
        var2_30 = CreateProductProperty((IOmlType) par_31, name);
        rexpr_26 = (HashSet) var1_27.clone();
        rexpr_26.addAll(var2_30);
        return rexpr_26;
      }
      else {

        HashSet rexpr_7 = new HashSet();
        UmlProperty enum_set_8 = null;
        IUmlMultiplicityElement arg_11 = null;
        arg_11 = (IUmlMultiplicityElement) Vdm2UmlType.exstractMultiplicity((IOmlType) t);
        IUmlType arg_12 = null;
        arg_12 = (IUmlType) Vdm2UmlType.convertType((IOmlType) t);
        IUmlType arg_19 = null;
        arg_19 = (IUmlType) Vdm2UmlType.getQualifier((IOmlType) t);
        enum_set_8 = new UmlProperty(name, new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPRIVATE), arg_11, arg_12, null, null, new Boolean(false), null, null, new String("Implementation prosponed"), arg_19);
        rexpr_7 = new HashSet();
        rexpr_7.add(enum_set_8);
        return rexpr_7;
      }
  }
// ***** VDMTOOLS END Name=CreateProductProperty#2|IOmlType|String


// ***** VDMTOOLS START Name=GetNextId KEEP=NO
  private String GetNextId () throws CGException {

    runningId = UTIL.NumberToInt(UTIL.clone(new Integer(runningId.intValue() + new Integer(1).intValue())));
    String rexpr_4 = null;
    rexpr_4 = UTIL.ConvertToString(Util.ToString(runningId));
    return rexpr_4;
  }
// ***** VDMTOOLS END Name=GetNextId

}
;
