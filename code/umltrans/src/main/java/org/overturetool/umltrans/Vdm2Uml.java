//
// THIS FILE IS AUTOMATICALLY GENERATED!!
//
// Generated at 2009-02-27 by the VDM++ to JAVA Code Generator
// (v8.2b - Wed 18-Feb-2009 16:15:35)
//
// Supported compilers: jdk 1.4/1.5/1.6
//

// ***** VDMTOOLS START Name=HeaderComment KEEP=NO
// ***** VDMTOOLS END Name=HeaderComment

// ***** VDMTOOLS START Name=package KEEP=NO
package org.overturetool.umltrans;

// ***** VDMTOOLS END Name=package

// ***** VDMTOOLS START Name=imports KEEP=YES

import jp.co.csk.vdm.toolbox.VDM.*;

import java.util.*;
import jp.co.csk.vdm.toolbox.VDM.quotes.*;
import org.overturetool.ast.imp.*;
import org.overturetool.ast.itf.*;
@SuppressWarnings({"unchecked","unused"})
// ***** VDMTOOLS END Name=imports



public class Vdm2Uml {

// ***** VDMTOOLS START Name=vdmComp KEEP=NO
  static UTIL.VDMCompare vdmComp = new UTIL.VDMCompare();
// ***** VDMTOOLS END Name=vdmComp

// ***** VDMTOOLS START Name=associations KEEP=NO
  private HashSet associations = new HashSet();
// ***** VDMTOOLS END Name=associations

// ***** VDMTOOLS START Name=constraints KEEP=NO
  private HashSet constraints = new HashSet();
// ***** VDMTOOLS END Name=constraints

// ***** VDMTOOLS START Name=runningId KEEP=NO
  private Long runningId = null;
// ***** VDMTOOLS END Name=runningId


// ***** VDMTOOLS START Name=vdm_init_Vdm2Uml KEEP=NO
  private void vdm_init_Vdm2Uml () throws CGException {
    try {

      associations = new HashSet();
      constraints = new HashSet();
      runningId = new Long(0);
    }
    catch (Exception e){

      e.printStackTrace(System.out);
      System.out.println(e.getMessage());
    }
  }
// ***** VDMTOOLS END Name=vdm_init_Vdm2Uml


// ***** VDMTOOLS START Name=Vdm2Uml KEEP=NO
  public Vdm2Uml () throws CGException {
    vdm_init_Vdm2Uml();
  }
// ***** VDMTOOLS END Name=Vdm2Uml


// ***** VDMTOOLS START Name=init#1|IOmlSpecifications KEEP=NO
  public IUmlModel init (final IOmlSpecifications specs) throws CGException {

    UmlModel tmpVal_3 = null;
    tmpVal_3 = (UmlModel) (UmlModel) build_uuml((IOmlSpecifications) specs);
    UmlModel model = null;
    model = (UmlModel) tmpVal_3;
    {

      HashSet par_6 = new HashSet();
      HashSet var1_7 = new HashSet();
      HashSet var1_8 = new HashSet();
      var1_8 = model.getDefinitions();
      var1_7 = (HashSet) var1_8.clone();
      var1_7.addAll(associations);
      par_6 = (HashSet) var1_7.clone();
      par_6.addAll(constraints);
      model.setDefinitions(par_6);
      return (IUmlModel) model;
    }
  }
// ***** VDMTOOLS END Name=init#1|IOmlSpecifications


// ***** VDMTOOLS START Name=build_uuml#1|IOmlSpecifications KEEP=NO
  public UmlModel build_uuml (final IOmlSpecifications specs) throws CGException {

    Vector classes = null;
    classes = specs.getClassList();
    Vector uml_uclasses = null;
    {

      Vector res_l_5 = new Vector();
      HashSet resBind_s_7 = new HashSet();
      HashSet riseq_11 = new HashSet();
      int max_12 = classes.size();
      for (int i_13 = 1; i_13 <= max_12; i_13++) 
        riseq_11.add(new Long(i_13));
      resBind_s_7 = riseq_11;
      Vector bind_l_6 = null;
      bind_l_6 = UTIL.Sort(resBind_s_7);
      Long i = null;
      for (Iterator enm_19 = bind_l_6.iterator(); enm_19.hasNext(); ) {

        Long e_9 = UTIL.NumberToLong(enm_19.next());
        i = e_9;
        IUmlClass reselem_14 = null;
        IOmlClass par_15 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= classes.size())) 
          par_15 = (IOmlClass) classes.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        reselem_14 = (IUmlClass) build_uClass((IOmlClass) par_15);
        res_l_5.add(reselem_14);
      }
      uml_uclasses = res_l_5;
    }
    UmlModel rexpr_20 = null;
    HashSet arg_22 = new HashSet();
    HashSet set_24 = new HashSet();
    Enumeration enm_25 = uml_uclasses.elements();
    while ( enm_25.hasMoreElements())
      set_24.add(enm_25.nextElement());
    arg_22 = set_24;
    rexpr_20 = new UmlModel(new String("Root"), arg_22);
    return (UmlModel) rexpr_20;
  }
// ***** VDMTOOLS END Name=build_uuml#1|IOmlSpecifications


// ***** VDMTOOLS START Name=build_uClass#1|IOmlClass KEEP=NO
  public IUmlClass build_uClass (final IOmlClass c) throws CGException {

    String name = null;
    name = c.getIdentifier();
    IOmlInheritanceClause inh = null;
    Boolean cond_6 = null;
    cond_6 = c.hasInheritanceClause();
    if (cond_6.booleanValue()) 
      inh = (IOmlInheritanceClause) c.getInheritanceClause();
    else 
      inh = null;
    Vector body = null;
    body = c.getClassBody();
    Boolean isStatic = new Boolean(false);
    Boolean isActive = null;
    Long var1_10 = null;
    HashSet unArg_11 = new HashSet();
    HashSet res_s_12 = new HashSet();
    {

      HashSet e_set_21 = new HashSet();
      HashSet riseq_23 = new HashSet();
      int max_24 = body.size();
      for (int i_25 = 1; i_25 <= max_24; i_25++) 
        riseq_23.add(new Long(i_25));
      e_set_21 = riseq_23;
      Long i = null;
      {
        for (Iterator enm_27 = e_set_21.iterator(); enm_27.hasNext(); ) {

          Long elem_26 = UTIL.NumberToLong(enm_27.next());
          i = elem_26;
          Boolean pred_16 = null;
          IOmlDefinitionBlock obj_17 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= body.size())) 
            obj_17 = (IOmlDefinitionBlock) body.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          pred_16 = new Boolean(obj_17 instanceof IOmlThreadDefinition);
          if (pred_16.booleanValue()) {

            IOmlDefinitionBlock res_s_13 = null;
            if ((1 <= i.intValue()) && (i.intValue() <= body.size())) 
              res_s_13 = (IOmlDefinitionBlock) body.get(i.intValue() - 1);
            else 
              UTIL.RunTime("Run-Time Error:Illegal index");
            res_s_12.add(res_s_13);
          }
        }
      }
    }
    unArg_11 = res_s_12;
    var1_10 = new Long(unArg_11.size());
    isActive = new Boolean((var1_10.intValue()) > (new Long(0).intValue()));
    Vector dBlock = null;
    {

      Vector res_l_30 = new Vector();
      HashSet resBind_s_32 = new HashSet();
      HashSet riseq_36 = new HashSet();
      int max_37 = body.size();
      for (int i_38 = 1; i_38 <= max_37; i_38++) 
        riseq_36.add(new Long(i_38));
      resBind_s_32 = riseq_36;
      Vector bind_l_31 = null;
      bind_l_31 = UTIL.Sort(resBind_s_32);
      Long i = null;
      for (Iterator enm_47 = bind_l_31.iterator(); enm_47.hasNext(); ) {

        Long e_34 = UTIL.NumberToLong(enm_47.next());
        i = e_34;
        IUmlDefinitionBlock reselem_39 = null;
        {

          IOmlDefinitionBlock dbs = null;
          if ((1 <= i.intValue()) && (i.intValue() <= body.size())) 
            dbs = (IOmlDefinitionBlock) body.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          reselem_39 = (IUmlDefinitionBlock) (IUmlDefinitionBlock) build_udef_ub((IOmlDefinitionBlock) dbs, name);
        }
        res_l_30.add(reselem_39);
      }
      dBlock = res_l_30;
    }
    HashSet dBlockSet = new HashSet();
    HashSet res_s_49 = new HashSet();
    {

      HashSet e1_set_56 = new HashSet(dBlock);
      IUmlDefinitionBlock d = null;
      {
        for (Iterator enm_58 = e1_set_56.iterator(); enm_58.hasNext(); ) {

          IUmlDefinitionBlock elem_57 = (IUmlDefinitionBlock) enm_58.next();
          d = (IUmlDefinitionBlock) elem_57;
          if (new Boolean(!UTIL.equals(d, null)).booleanValue()) {
            res_s_49.add(d);
          }
        }
      }
    }
    dBlockSet = res_s_49;
    Boolean isAbstract = hasSubclassResponsibilityDefinition(body);
    Vector tmpVal_61 = null;
    tmpVal_61 = getSuperClasses((IOmlInheritanceClause) inh);
    Vector supers = null;
    supers = tmpVal_61;
    UmlVisibilityKind visibility = (UmlVisibilityKind) new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPUBLIC);
    IUmlTemplateSignature templateParameters = null;
    Vector par_66 = null;
    par_66 = c.getGenericTypes();
    templateParameters = (IUmlTemplateSignature) getGenericTypes(par_66);
    return (IUmlClass) new UmlClass(name, dBlockSet, isAbstract, supers, visibility, isStatic, isActive, templateParameters);
  }
// ***** VDMTOOLS END Name=build_uClass#1|IOmlClass


// ***** VDMTOOLS START Name=getGenericTypes#1|Vector KEEP=NO
  public IUmlTemplateSignature getGenericTypes (final Vector genericTypes) throws CGException {
    if (new Boolean((new Long(genericTypes.size()).intValue()) > (new Long(0).intValue())).booleanValue()) {

      UmlTemplateSignature rexpr_7 = null;
      HashSet arg_8 = new HashSet();
      HashSet res_s_9 = new HashSet();
      {

        HashSet e1_set_17 = new HashSet(genericTypes);
        IOmlType t = null;
        {
          for (Iterator enm_19 = e1_set_17.iterator(); enm_19.hasNext(); ) {

            IOmlType elem_18 = (IOmlType) enm_19.next();
            t = (IOmlType) elem_18;
            UmlTemplateParameter res_s_10 = null;
            {

              IOmlTypeName tn = (IOmlTypeName) t;
              String arg_13 = null;
              IOmlName obj_14 = null;
              obj_14 = (IOmlName) tn.getName();
              arg_13 = obj_14.getIdentifier();
              res_s_10 = new UmlTemplateParameter(arg_13);
            }
            res_s_9.add(res_s_10);
          }
        }
      }
      arg_8 = res_s_9;
      rexpr_7 = new UmlTemplateSignature(arg_8);
      return (IUmlTemplateSignature) rexpr_7;
    }
    else 
      return null;
  }
// ***** VDMTOOLS END Name=getGenericTypes#1|Vector


// ***** VDMTOOLS START Name=getSuperClasses#1|IOmlInheritanceClause KEEP=NO
  public Vector getSuperClasses (final IOmlInheritanceClause inh) throws CGException {
    if (new Boolean(UTIL.equals(inh, null)).booleanValue()) 
      return new Vector();
    else {

      Vector list = null;
      list = inh.getIdentifierList();
      Vector rexpr_7 = null;
      {

        Vector res_l_8 = new Vector();
        HashSet resBind_s_10 = new HashSet();
        HashSet riseq_14 = new HashSet();
        int max_15 = list.size();
        for (int i_16 = 1; i_16 <= max_15; i_16++) 
          riseq_14.add(new Long(i_16));
        resBind_s_10 = riseq_14;
        Vector bind_l_9 = null;
        bind_l_9 = UTIL.Sort(resBind_s_10);
        Long i = null;
        for (Iterator enm_22 = bind_l_9.iterator(); enm_22.hasNext(); ) {

          Long e_12 = UTIL.NumberToLong(enm_22.next());
          i = e_12;
          UmlClassNameType reselem_17 = null;
          String arg_18 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= list.size())) 
            arg_18 = UTIL.ConvertToString(list.get(i.intValue() - 1));
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          reselem_17 = new UmlClassNameType(arg_18);
          res_l_8.add(reselem_17);
        }
        rexpr_7 = res_l_8;
      }
      return rexpr_7;
    }
  }
// ***** VDMTOOLS END Name=getSuperClasses#1|IOmlInheritanceClause


// ***** VDMTOOLS START Name=hasSubclassResponsibilityDefinition#1|Vector KEEP=NO
  public Boolean hasSubclassResponsibilityDefinition (final Vector dBlock) throws CGException {

    Vector opList = null;
    Vector unArg_4 = null;
    {

      Vector res_l_5 = new Vector();
      HashSet resBind_s_7 = new HashSet();
      HashSet riseq_11 = new HashSet();
      int max_12 = dBlock.size();
      for (int i_13 = 1; i_13 <= max_12; i_13++) 
        riseq_11.add(new Long(i_13));
      resBind_s_7 = riseq_11;
      Vector bind_l_6 = null;
      bind_l_6 = UTIL.Sort(resBind_s_7);
      Long i = null;
      for (Iterator enm_24 = bind_l_6.iterator(); enm_24.hasNext(); ) {

        Long e_9 = UTIL.NumberToLong(enm_24.next());
        i = e_9;
        Boolean pred_19 = null;
        IOmlDefinitionBlock obj_20 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= dBlock.size())) 
          obj_20 = (IOmlDefinitionBlock) dBlock.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        pred_19 = new Boolean(obj_20 instanceof IOmlOperationDefinitions);
        if (pred_19.booleanValue()) {

          Vector reselem_14 = null;
          {

            IOmlDefinitionBlock tmpVal_16 = null;
            if ((1 <= i.intValue()) && (i.intValue() <= dBlock.size())) 
              tmpVal_16 = (IOmlDefinitionBlock) dBlock.get(i.intValue() - 1);
            else 
              UTIL.RunTime("Run-Time Error:Illegal index");
            IOmlOperationDefinitions op = null;
            op = (IOmlOperationDefinitions) tmpVal_16;
            reselem_14 = op.getOperationList();
          }
          res_l_5.add(reselem_14);
        }
      }
      unArg_4 = res_l_5;
    }
    Vector rdcseq_25 = new Vector();
    for (Iterator enm_28 = unArg_4.iterator(); enm_28.hasNext(); ) {

      Vector e_26 = (Vector) UTIL.ConvertToList(enm_28.next());
      rdcseq_25.addAll(e_26);
    }
    opList = rdcseq_25;
    HashSet hasIsSubClassResp = new HashSet();
    HashSet res_s_30 = new HashSet();
    {

      HashSet e_set_44 = new HashSet();
      HashSet riseq_46 = new HashSet();
      int max_47 = opList.size();
      for (int i_48 = 1; i_48 <= max_47; i_48++) 
        riseq_46.add(new Long(i_48));
      e_set_44 = riseq_46;
      Long i = null;
      {
        for (Iterator enm_50 = e_set_44.iterator(); enm_50.hasNext(); ) {

          Long elem_49 = UTIL.NumberToLong(enm_50.next());
          i = elem_49;
          Boolean pred_38 = null;
          IOmlOperationShape obj_39 = null;
          IOmlOperationDefinition obj_40 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= opList.size())) 
            obj_40 = (IOmlOperationDefinition) opList.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          obj_39 = (IOmlOperationShape) obj_40.getShape();
          pred_38 = new Boolean(obj_39 instanceof IOmlExplicitOperation);
          if (pred_38.booleanValue()) {

            Boolean res_s_31 = null;
            {

              IOmlExplicitOperation explicitOp = null;
              IOmlOperationDefinition obj_34 = null;
              if ((1 <= i.intValue()) && (i.intValue() <= opList.size())) 
                obj_34 = (IOmlOperationDefinition) opList.get(i.intValue() - 1);
              else 
                UTIL.RunTime("Run-Time Error:Illegal index");
              explicitOp = (IOmlExplicitOperation) obj_34.getShape();
              IOmlOperationBody obj_37 = null;
              obj_37 = (IOmlOperationBody) explicitOp.getBody();
              res_s_31 = obj_37.getSubclassResponsibility();
            }
            res_s_30.add(res_s_31);
          }
        }
      }
    }
    hasIsSubClassResp = res_s_30;
    Boolean rexpr_51 = null;
    boolean tmpQuant_52 = false;
    {

      Boolean e = null;
      {
        for (Iterator enm_59 = hasIsSubClassResp.iterator(); enm_59.hasNext() && !tmpQuant_52; ) {

          Boolean elem_58 = (Boolean) enm_59.next();
          e = elem_58;
          if (new Boolean(UTIL.equals(e, new Boolean(true))).booleanValue()) 
            tmpQuant_52 = true;
        }
      }
    }
    rexpr_51 = new Boolean(tmpQuant_52);
    return rexpr_51;
  }
// ***** VDMTOOLS END Name=hasSubclassResponsibilityDefinition#1|Vector


// ***** VDMTOOLS START Name=build_udef_ub#2|IOmlDefinitionBlock|String KEEP=NO
  private IUmlDefinitionBlock build_udef_ub (final IOmlDefinitionBlock block, final String owner) throws CGException {

    boolean succ_3 = true;
    {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlInstanceVariableDefinitions))) 
        succ_3 = false;
      if (succ_3) {

        IOmlInstanceVariableDefinitions tmp = (IOmlInstanceVariableDefinitions) block;
        return (IUmlDefinitionBlock) build_udef_ublock((IOmlInstanceVariableDefinitions) tmp, owner);
      }
      else {

        succ_3 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlValueDefinitions))) 
          succ_3 = false;
        if (succ_3) {

          IOmlValueDefinitions tmp = (IOmlValueDefinitions) block;
          return (IUmlDefinitionBlock) build_udef_ublock((IOmlValueDefinitions) tmp, owner);
        }
        else {

          succ_3 = true;
          if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlTypeDefinitions))) 
            succ_3 = false;
          if (succ_3) {

            IOmlTypeDefinitions tmp = (IOmlTypeDefinitions) block;
            return (IUmlDefinitionBlock) build_udef_ublock((IOmlTypeDefinitions) tmp, owner);
          }
          else {

            succ_3 = true;
            if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlOperationDefinitions))) 
              succ_3 = false;
            if (succ_3) {

              IOmlOperationDefinitions tmp = (IOmlOperationDefinitions) block;
              return (IUmlDefinitionBlock) build_udef_ublock((IOmlOperationDefinitions) tmp, owner);
            }
            else {

              succ_3 = true;
              if (!UTIL.equals(new Boolean(true), new Boolean(block instanceof IOmlFunctionDefinitions))) 
                succ_3 = false;
              if (succ_3) {

                IOmlFunctionDefinitions tmp = (IOmlFunctionDefinitions) block;
                return (IUmlDefinitionBlock) build_udef_ublock((IOmlFunctionDefinitions) tmp, owner);
              }
              else 
                return null;
            }
          }
        }
      }
    }
  }
// ***** VDMTOOLS END Name=build_udef_ub#2|IOmlDefinitionBlock|String


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlInstanceVariableDefinitions|String KEEP=NO
  public IUmlOwnedProperties build_udef_ublock (final IOmlInstanceVariableDefinitions v, final String owner) throws CGException {

    Vector q = null;
    q = v.getVariablesList();
    Vector props = null;
    {

      Vector res_l_6 = new Vector();
      HashSet resBind_s_8 = new HashSet();
      HashSet riseq_12 = new HashSet();
      int max_13 = q.size();
      for (int i_14 = 1; i_14 <= max_13; i_14++) 
        riseq_12.add(new Long(i_14));
      resBind_s_8 = riseq_12;
      Vector bind_l_7 = null;
      bind_l_7 = UTIL.Sort(resBind_s_8);
      Long i = null;
      for (Iterator enm_25 = bind_l_7.iterator(); enm_25.hasNext(); ) {

        Long e_10 = UTIL.NumberToLong(enm_25.next());
        i = e_10;
        Boolean pred_20 = null;
        IOmlInstanceVariableShape obj_21 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
          obj_21 = (IOmlInstanceVariableShape) q.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        pred_20 = new Boolean(obj_21 instanceof IOmlInstanceVariable);
        if (pred_20.booleanValue()) {

          IUmlProperty reselem_15 = null;
          IOmlInstanceVariableShape par_16 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
            par_16 = (IOmlInstanceVariableShape) q.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          reselem_15 = (IUmlProperty) buildVariable((IOmlInstanceVariable) par_16, owner);
          res_l_6.add(reselem_15);
        }
      }
      props = res_l_6;
    }
    UmlOwnedProperties rexpr_26 = null;
    HashSet arg_27 = new HashSet();
    HashSet res_s_28 = new HashSet();
    {

      HashSet e1_set_35 = new HashSet(props);
      IUmlProperty p = null;
      {
        for (Iterator enm_37 = e1_set_35.iterator(); enm_37.hasNext(); ) {

          IUmlProperty elem_36 = (IUmlProperty) enm_37.next();
          p = (IUmlProperty) elem_36;
          if (new Boolean(!UTIL.equals(p, null)).booleanValue()) {
            res_s_28.add(p);
          }
        }
      }
    }
    arg_27 = res_s_28;
    rexpr_26 = new UmlOwnedProperties(arg_27);
    return (IUmlOwnedProperties) rexpr_26;
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlInstanceVariableDefinitions|String


// ***** VDMTOOLS START Name=buildVariable#2|IOmlInstanceVariable|String KEEP=NO
  public IUmlProperty buildVariable (final IOmlInstanceVariable vdm_var, final String owner) throws CGException {

    IOmlAccessDefinition access = null;
    access = (IOmlAccessDefinition) vdm_var.getAccess();
    IOmlScope scope = null;
    scope = (IOmlScope) access.getScope();
    IOmlAssignmentDefinition assign = null;
    assign = (IOmlAssignmentDefinition) vdm_var.getAssignmentDefinition();
    Boolean isStatic = null;
    isStatic = access.getStaticAccess();
    String name = null;
    name = assign.getIdentifier();
    IUmlVisibilityKind visibility = (IUmlVisibilityKind) (IUmlVisibilityKind) convertScopeToVisibility((IOmlScope) scope);
    IOmlType omlType = null;
    omlType = (IOmlType) assign.getType();
    IUmlMultiplicityElement multiplicity = null;
    multiplicity = (IUmlMultiplicityElement) Vdm2UmlType.extractMultiplicity((IOmlType) omlType);
    IUmlType type = null;
    type = (IUmlType) Vdm2UmlType.convertPropertyType(omlType, owner);
    Boolean isReadOnly = new Boolean(false);
    IUmlValueSpecification vdm_default = null;
    Boolean cond_20 = null;
    cond_20 = assign.hasExpression();
    if (cond_20.booleanValue()) {

      IOmlExpression par_21 = null;
      par_21 = (IOmlExpression) assign.getExpression();
      vdm_default = (IUmlValueSpecification) getDefaultValue((IOmlExpression) par_21);
    }
    else 
      vdm_default = null;
    Boolean isComposite = isSimpleType((IOmlType) omlType);
    Boolean isDerived = new Boolean(false);
    IUmlType qualifier = null;
    qualifier = (IUmlType) Vdm2UmlType.getQualifier(omlType);
    {

      IUmlProperty property = (IUmlProperty) new UmlProperty(name, visibility, multiplicity, type, isReadOnly, vdm_default, isComposite, isDerived, isStatic, owner, qualifier);
      if (new Boolean(!isSimpleType((IOmlType) omlType).booleanValue()).booleanValue()) {

        CreateAssociationFromProperty((IUmlProperty) property, (IOmlType) omlType);
        return null;
      }
      else 
        return (IUmlProperty) property;
    }
  }
// ***** VDMTOOLS END Name=buildVariable#2|IOmlInstanceVariable|String


// ***** VDMTOOLS START Name=getDefaultValue#1|IOmlExpression KEEP=NO
  public IUmlValueSpecification getDefaultValue (final IOmlExpression expression) throws CGException {

    boolean succ_2 = true;
    {

      succ_2 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(expression instanceof IOmlSymbolicLiteralExpression))) 
        succ_2 = false;
      if (succ_2) {

        IOmlSymbolicLiteralExpression se = (IOmlSymbolicLiteralExpression) expression;
        boolean succ_10 = true;
        {

          succ_10 = true;
          Boolean tmpVal_v_20 = null;
          IOmlLiteral obj_21 = null;
          obj_21 = (IOmlLiteral) se.getLiteral();
          tmpVal_v_20 = new Boolean(obj_21 instanceof IOmlTextLiteral);
          if (!UTIL.equals(new Boolean(true), tmpVal_v_20)) 
            succ_10 = false;
          if (succ_10) {

            IOmlTextLiteral tx = null;
            tx = (IOmlTextLiteral) se.getLiteral();
            UmlLiteralString rexpr_24 = null;
            String arg_25 = null;
            arg_25 = tx.getVal();
            rexpr_24 = new UmlLiteralString(arg_25);
            return (IUmlValueSpecification) rexpr_24;
          }
          else {

            succ_10 = true;
            Boolean tmpVal_v_14 = null;
            IOmlLiteral obj_15 = null;
            obj_15 = (IOmlLiteral) se.getLiteral();
            tmpVal_v_14 = new Boolean(obj_15 instanceof IOmlNumericLiteral);
            if (!UTIL.equals(new Boolean(true), tmpVal_v_14)) 
              succ_10 = false;
            if (succ_10) {

              IOmlNumericLiteral tx = null;
              tx = (IOmlNumericLiteral) se.getLiteral();
              UmlLiteralInteger rexpr_18 = null;
              Long arg_19 = null;
              arg_19 = tx.getVal();
              rexpr_18 = new UmlLiteralInteger(arg_19);
              return (IUmlValueSpecification) rexpr_18;
            }
            else 
              return null;
          }
        }
      }
      else 
        return null;
    }
  }
// ***** VDMTOOLS END Name=getDefaultValue#1|IOmlExpression


// ***** VDMTOOLS START Name=convertScopeToVisibility#1|IOmlScope KEEP=NO
  public IUmlVisibilityKind convertScopeToVisibility (final IOmlScope sc) throws CGException {

    UmlVisibilityKind varRes_2 = null;
    {

      Long val = null;
      val = sc.getValue();
      boolean succ_5 = true;
      {

        succ_5 = true;
        if (!UTIL.equals(val, OmlScopeQuotes.IQPUBLIC)) 
          succ_5 = false;
        if (succ_5) 
          varRes_2 = (UmlVisibilityKind) new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPUBLIC);
      }
      if (!succ_5) {

        succ_5 = true;
        if (!UTIL.equals(val, OmlScopeQuotes.IQPRIVATE)) 
          succ_5 = false;
        if (!succ_5) {

          succ_5 = true;
          if (!UTIL.equals(val, OmlScopeQuotes.IQDEFAULT)) 
            succ_5 = false;
        }
        if (succ_5) 
          varRes_2 = (UmlVisibilityKind) new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPRIVATE);
      }
      if (!succ_5) {

        succ_5 = true;
        if (!UTIL.equals(val, OmlScopeQuotes.IQPROTECTED)) 
          succ_5 = false;
        if (succ_5) 
          varRes_2 = (UmlVisibilityKind) new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPROTECTED);
      }
      if (!succ_5) 
        UTIL.RunTime("Run-Time Error:No \'others\' branch in CasesExpr");
    }
    return (IUmlVisibilityKind) varRes_2;
  }
// ***** VDMTOOLS END Name=convertScopeToVisibility#1|IOmlScope


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlValueDefinitions|String KEEP=NO
  public IUmlOwnedProperties build_udef_ublock (final IOmlValueDefinitions v, final String owner) throws CGException {

    Vector q = null;
    q = v.getValueList();
    Vector props = null;
    {

      Vector res_l_6 = new Vector();
      HashSet resBind_s_8 = new HashSet();
      HashSet riseq_12 = new HashSet();
      int max_13 = q.size();
      for (int i_14 = 1; i_14 <= max_13; i_14++) 
        riseq_12.add(new Long(i_14));
      resBind_s_8 = riseq_12;
      Vector bind_l_7 = null;
      bind_l_7 = UTIL.Sort(resBind_s_8);
      Long i = null;
      for (Iterator enm_21 = bind_l_7.iterator(); enm_21.hasNext(); ) {

        Long e_10 = UTIL.NumberToLong(enm_21.next());
        i = e_10;
        IUmlProperty reselem_15 = null;
        IOmlValueDefinition par_16 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
          par_16 = (IOmlValueDefinition) q.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        reselem_15 = (IUmlProperty) buildValue((IOmlValueDefinition) par_16, owner);
        res_l_6.add(reselem_15);
      }
      props = res_l_6;
    }
    HashSet propsNoNil = new HashSet();
    HashSet res_s_23 = new HashSet();
    {

      HashSet e1_set_30 = new HashSet(props);
      IUmlProperty p = null;
      {
        for (Iterator enm_32 = e1_set_30.iterator(); enm_32.hasNext(); ) {

          IUmlProperty elem_31 = (IUmlProperty) enm_32.next();
          p = (IUmlProperty) elem_31;
          if (new Boolean(!UTIL.equals(p, null)).booleanValue()) {
            res_s_23.add(p);
          }
        }
      }
    }
    propsNoNil = res_s_23;
    return (IUmlOwnedProperties) new UmlOwnedProperties(propsNoNil);
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlValueDefinitions|String


// ***** VDMTOOLS START Name=buildValue#2|IOmlValueDefinition|String KEEP=NO
  public IUmlProperty buildValue (final IOmlValueDefinition vdm_var, final String owner) throws CGException {

    IOmlAccessDefinition access = null;
    access = (IOmlAccessDefinition) vdm_var.getAccess();
    IOmlScope scope = null;
    scope = (IOmlScope) access.getScope();
    IOmlValueShape shape = null;
    shape = (IOmlValueShape) vdm_var.getShape();
    Boolean isStatic = null;
    isStatic = access.getStaticAccess();
    IOmlPatternIdentifier patternIdent = null;
    patternIdent = (IOmlPatternIdentifier) shape.getPattern();
    String name = null;
    name = patternIdent.getIdentifier();
    IUmlVisibilityKind visibility = (IUmlVisibilityKind) (IUmlVisibilityKind) convertScopeToVisibility((IOmlScope) scope);
    IUmlMultiplicityElement multiplicity = null;
    IOmlType par_13 = null;
    par_13 = (IOmlType) shape.getType();
    multiplicity = (IUmlMultiplicityElement) Vdm2UmlType.extractMultiplicity((IOmlType) par_13);
    IUmlType type = null;
    IOmlType par_15 = null;
    par_15 = (IOmlType) shape.getType();
    type = (IUmlType) Vdm2UmlType.convertType(par_15);
    Boolean isReadOnly = new Boolean(true);
    IUmlValueSpecification vdm_default = null;
    IOmlExpression par_18 = null;
    par_18 = (IOmlExpression) shape.getExpression();
    vdm_default = (IUmlValueSpecification) getDefaultValue((IOmlExpression) par_18);
    Boolean isComposite = null;
    IOmlType par_20 = null;
    par_20 = (IOmlType) shape.getType();
    isComposite = isSimpleType((IOmlType) par_20);
    Boolean isDerived = new Boolean(false);
    IUmlType qualifier = null;
    IOmlType par_23 = null;
    par_23 = (IOmlType) shape.getType();
    qualifier = (IUmlType) Vdm2UmlType.getQualifier(par_23);
    IOmlType omlType = null;
    omlType = (IOmlType) shape.getType();
    {

      IUmlProperty property = (IUmlProperty) new UmlProperty(name, visibility, multiplicity, type, isReadOnly, vdm_default, isComposite, isDerived, isStatic, owner, qualifier);
      if (new Boolean(!isSimpleType((IOmlType) omlType).booleanValue()).booleanValue()) {

        CreateAssociationFromProperty((IUmlProperty) property, (IOmlType) omlType);
        return null;
      }
      else 
        return (IUmlProperty) property;
    }
  }
// ***** VDMTOOLS END Name=buildValue#2|IOmlValueDefinition|String


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlTypeDefinitions|String KEEP=NO
  public IUmlNestedClassifiers build_udef_ublock (final IOmlTypeDefinitions var_1_1, final String var_2_2) throws CGException {

    IOmlTypeDefinitions td = null;
    boolean succ_3 = true;
    td = (IOmlTypeDefinitions) var_1_1;
    if (!succ_3) 
      UTIL.RunTime("Run-Time Error:Pattern match failed in operation call in operation build_udef_ublock");
    {

      Vector q = null;
      q = td.getTypeList();
      Vector tmpVal_6 = null;
      {

        Vector res_l_7 = new Vector();
        HashSet resBind_s_9 = new HashSet();
        HashSet riseq_13 = new HashSet();
        int max_14 = q.size();
        for (int i_15 = 1; i_15 <= max_14; i_15++) 
          riseq_13.add(new Long(i_15));
        resBind_s_9 = riseq_13;
        Vector bind_l_8 = null;
        bind_l_8 = UTIL.Sort(resBind_s_9);
        Long i = null;
        for (Iterator enm_27 = bind_l_8.iterator(); enm_27.hasNext(); ) {

          Long e_11 = UTIL.NumberToLong(enm_27.next());
          i = e_11;
          Boolean pred_21 = null;
          IOmlTypeShape obj_22 = null;
          IOmlTypeDefinition obj_23 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
            obj_23 = (IOmlTypeDefinition) q.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          obj_22 = (IOmlTypeShape) obj_23.getShape();
          pred_21 = new Boolean(obj_22 instanceof IOmlSimpleType);
          if (pred_21.booleanValue()) {

            IUmlType reselem_16 = null;
            IOmlTypeShape par_17 = null;
            IOmlTypeDefinition obj_18 = null;
            if ((1 <= i.intValue()) && (i.intValue() <= q.size())) 
              obj_18 = (IOmlTypeDefinition) q.get(i.intValue() - 1);
            else 
              UTIL.RunTime("Run-Time Error:Illegal index");
            par_17 = (IOmlTypeShape) obj_18.getShape();
            reselem_16 = (IUmlType) buildType((IOmlSimpleType) par_17);
            res_l_7.add(reselem_16);
          }
        }
        tmpVal_6 = res_l_7;
      }
      Vector tps = null;
      tps = tmpVal_6;
      UmlNestedClassifiers rexpr_28 = null;
      HashSet arg_29 = new HashSet();
      HashSet set_31 = new HashSet();
      Enumeration enm_32 = tps.elements();
      while ( enm_32.hasMoreElements())
        set_31.add(enm_32.nextElement());
      arg_29 = set_31;
      rexpr_28 = new UmlNestedClassifiers(arg_29);
      return (IUmlNestedClassifiers) rexpr_28;
    }
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlTypeDefinitions|String


// ***** VDMTOOLS START Name=buildType#1|IOmlSimpleType KEEP=NO
  public IUmlType buildType (final IOmlSimpleType vdm_var) throws CGException {

    IUmlType rexpr_2 = null;
    IOmlType par_3 = null;
    par_3 = (IOmlType) vdm_var.getType();
    rexpr_2 = (IUmlType) Vdm2UmlType.convertType(par_3);
    return (IUmlType) rexpr_2;
  }
// ***** VDMTOOLS END Name=buildType#1|IOmlSimpleType


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlOperationDefinitions|String KEEP=NO
  public IUmlOwnedOperations build_udef_ublock (final IOmlOperationDefinitions opDef, final String owner) throws CGException {

    Vector tmpVal_4 = null;
    tmpVal_4 = opDef.getOperationList();
    Vector ops = null;
    ops = tmpVal_4;
    UmlOwnedOperations rexpr_5 = null;
    HashSet arg_6 = new HashSet();
    HashSet res_s_7 = new HashSet();
    {

      HashSet e_set_14 = new HashSet();
      HashSet riseq_16 = new HashSet();
      int max_17 = ops.size();
      for (int i_18 = 1; i_18 <= max_17; i_18++) 
        riseq_16.add(new Long(i_18));
      e_set_14 = riseq_16;
      Long i = null;
      {
        for (Iterator enm_20 = e_set_14.iterator(); enm_20.hasNext(); ) {

          Long elem_19 = UTIL.NumberToLong(enm_20.next());
          i = elem_19;
          IUmlOperation res_s_8 = null;
          IOmlOperationDefinition par_9 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= ops.size())) 
            par_9 = (IOmlOperationDefinition) ops.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          res_s_8 = (IUmlOperation) buildOperation((IOmlOperationDefinition) par_9, owner);
          res_s_7.add(res_s_8);
        }
      }
    }
    arg_6 = res_s_7;
    rexpr_5 = new UmlOwnedOperations(arg_6);
    return (IUmlOwnedOperations) rexpr_5;
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlOperationDefinitions|String


// ***** VDMTOOLS START Name=buildOperation#2|IOmlOperationDefinition|String KEEP=NO
  public IUmlOperation buildOperation (final IOmlOperationDefinition var_1_1, final String var_2_2) throws CGException {

    IOmlOperationDefinition op = null;
    boolean succ_3 = true;
    op = (IOmlOperationDefinition) var_1_1;
    if (!succ_3) 
      UTIL.RunTime("Run-Time Error:Pattern match failed in operation call in operation buildOperation");
    {

      IOmlAccessDefinition access = null;
      access = (IOmlAccessDefinition) op.getAccess();
      IOmlScope scope = null;
      scope = (IOmlScope) access.getScope();
      IOmlExplicitOperation shape = null;
      shape = (IOmlExplicitOperation) op.getShape();
      Boolean isStatic = null;
      isStatic = access.getStaticAccess();
      String name = null;
      name = shape.getIdentifier();
      IUmlVisibilityKind visibility = (IUmlVisibilityKind) (IUmlVisibilityKind) convertScopeToVisibility((IOmlScope) scope);
      UmlMultiplicityElement multiplicity = (UmlMultiplicityElement) new UmlMultiplicityElement(new Boolean(false), new Boolean(false), new Long(1), new Long(1));
      IUmlType type = null;
      IOmlType par_18 = null;
      par_18 = (IOmlType) shape.getType();
      type = (IUmlType) Vdm2UmlType.convertType(par_18);
      Vector tmpVal_19 = null;
      Vector par_20 = null;
      par_20 = shape.getParameterList();
      IOmlType par_21 = null;
      par_21 = (IOmlType) shape.getType();
      tmpVal_19 = buildParameters(par_20, (IOmlType) par_21);
      Vector pars = null;
      pars = tmpVal_19;
      return (IUmlOperation) new UmlOperation(name, visibility, multiplicity, new Boolean(false), type, isStatic, new UmlParameters(pars));
    }
  }
// ***** VDMTOOLS END Name=buildOperation#2|IOmlOperationDefinition|String


// ***** VDMTOOLS START Name=buildParameters#2|Vector|IOmlType KEEP=NO
  private Vector buildParameters (final Vector parms, final IOmlType type) throws CGException {

    Vector names = null;
    {

      Vector res_l_5 = new Vector();
      HashSet resBind_s_7 = new HashSet();
      HashSet riseq_11 = new HashSet();
      int max_12 = parms.size();
      for (int i_13 = 1; i_13 <= max_12; i_13++) 
        riseq_11.add(new Long(i_13));
      resBind_s_7 = riseq_11;
      Vector bind_l_6 = null;
      bind_l_6 = UTIL.Sort(resBind_s_7);
      Long i = null;
      for (Iterator enm_24 = bind_l_6.iterator(); enm_24.hasNext(); ) {

        Long e_9 = UTIL.NumberToLong(enm_24.next());
        i = e_9;
        Boolean pred_19 = null;
        IOmlPattern obj_20 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= parms.size())) 
          obj_20 = (IOmlPattern) parms.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        pred_19 = new Boolean(obj_20 instanceof IOmlPatternIdentifier);
        if (pred_19.booleanValue()) {

          String reselem_14 = null;
          {

            IOmlPatternIdentifier p = null;
            if ((1 <= i.intValue()) && (i.intValue() <= parms.size())) 
              p = (IOmlPatternIdentifier) parms.get(i.intValue() - 1);
            else 
              UTIL.RunTime("Run-Time Error:Illegal index");
            reselem_14 = p.getIdentifier();
          }
          res_l_5.add(reselem_14);
        }
      }
      names = res_l_5;
    }
    Vector tmpVal_25 = null;
    tmpVal_25 = buildParameterTypes((IOmlType) type);
    Vector tps = null;
    tps = tmpVal_25;
    UmlParameter ret = null;
    {

      Object t = null;
      if (new Boolean(type instanceof IOmlOperationType).booleanValue()) {

        IOmlOperationType tmp = (IOmlOperationType) type;
        t = tmp;
      }
      else {

        IOmlPartialFunctionType tmp = (IOmlPartialFunctionType) type;
        t = tmp;
      }
      IUmlType arg_38 = null;
      {

        IUmlType tmpType = null;
        IOmlType par_44 = null;
        if ((t instanceof IOmlPartialFunctionType)) 
          par_44 = (IOmlType) ((IOmlPartialFunctionType) t).getRngType();
        else 
          if ((t instanceof IOmlOperationType)) 
            par_44 = (IOmlType) ((IOmlOperationType) t).getRngType();
        tmpType = (IUmlType) Vdm2UmlType.convertType(par_44);
        arg_38 = (IUmlType) tmpType;
      }
      IUmlMultiplicityElement arg_39 = null;
      IOmlType par_45 = null;
      if ((t instanceof IOmlPartialFunctionType)) 
        par_45 = (IOmlType) ((IOmlPartialFunctionType) t).getRngType();
      else 
        if ((t instanceof IOmlOperationType)) 
          par_45 = (IOmlType) ((IOmlOperationType) t).getRngType();
      arg_39 = (IUmlMultiplicityElement) Vdm2UmlType.extractMultiplicity((IOmlType) par_45);
      ret = new UmlParameter(new String("return"), arg_38, arg_39, new String(""), new UmlParameterDirectionKind(UmlParameterDirectionKindQuotes.IQRETURN));
    }
    Vector ps = null;
    {

      Vector res_l_48 = new Vector();
      HashSet resBind_s_50 = new HashSet();
      HashSet riseq_54 = new HashSet();
      int max_55 = names.size();
      for (int i_56 = 1; i_56 <= max_55; i_56++) 
        riseq_54.add(new Long(i_56));
      resBind_s_50 = riseq_54;
      Vector bind_l_49 = null;
      bind_l_49 = UTIL.Sort(resBind_s_50);
      Long i = null;
      for (Iterator enm_73 = bind_l_49.iterator(); enm_73.hasNext(); ) {

        Long e_52 = UTIL.NumberToLong(enm_73.next());
        i = e_52;
        UmlParameter reselem_57 = null;
        String arg_58 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= names.size())) 
          arg_58 = UTIL.ConvertToString(names.get(i.intValue() - 1));
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        IUmlType arg_59 = null;
        IOmlType par_65 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= tps.size())) 
          par_65 = (IOmlType) tps.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        arg_59 = (IUmlType) Vdm2UmlType.convertType(par_65);
        IUmlMultiplicityElement arg_60 = null;
        IOmlType par_68 = null;
        if ((1 <= i.intValue()) && (i.intValue() <= tps.size())) 
          par_68 = (IOmlType) tps.get(i.intValue() - 1);
        else 
          UTIL.RunTime("Run-Time Error:Illegal index");
        arg_60 = (IUmlMultiplicityElement) Vdm2UmlType.extractMultiplicity((IOmlType) par_68);
        reselem_57 = new UmlParameter(arg_58, arg_59, arg_60, new String(""), new UmlParameterDirectionKind(UmlParameterDirectionKindQuotes.IQIN));
        res_l_48.add(reselem_57);
      }
      ps = res_l_48;
    }
    Vector rexpr_74 = null;
    Vector var2_76 = null;
    var2_76 = new Vector();
    var2_76.add(ret);
    rexpr_74 = (Vector) ps.clone();
    rexpr_74.addAll(var2_76);
    return rexpr_74;
  }
// ***** VDMTOOLS END Name=buildParameters#2|Vector|IOmlType


// ***** VDMTOOLS START Name=buildParameterTypes#1|IOmlType KEEP=NO
  private Vector buildParameterTypes (final IOmlType t) throws CGException {

    boolean succ_2 = true;
    {

      succ_2 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlProductType))) 
        succ_2 = false;
      if (succ_2) {

        IOmlType tmpVal_22 = null;
        tmpVal_22 = (IOmlType) t;
        IOmlProductType type = null;
        type = (IOmlProductType) tmpVal_22;
        Vector rexpr_23 = null;
        Vector var1_24 = null;
        IOmlType par_25 = null;
        par_25 = (IOmlType) type.getLhsType();
        var1_24 = buildParameterTypes((IOmlType) par_25);
        Vector var2_26 = null;
        IOmlType par_27 = null;
        par_27 = (IOmlType) type.getRhsType();
        var2_26 = buildParameterTypes((IOmlType) par_27);
        rexpr_23 = (Vector) var1_24.clone();
        rexpr_23.addAll(var2_26);
        return rexpr_23;
      }
      else {

        succ_2 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlOperationType))) 
          succ_2 = false;
        if (succ_2) {

          IOmlType tmpVal_16 = null;
          tmpVal_16 = (IOmlType) t;
          IOmlOperationType type = null;
          type = (IOmlOperationType) tmpVal_16;
          Vector rexpr_17 = null;
          IOmlType par_18 = null;
          par_18 = (IOmlType) type.getDomType();
          rexpr_17 = buildParameterTypes((IOmlType) par_18);
          return rexpr_17;
        }
        else {

          succ_2 = true;
          if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlPartialFunctionType))) 
            succ_2 = false;
          if (succ_2) {

            IOmlType tmpVal_10 = null;
            tmpVal_10 = (IOmlType) t;
            IOmlPartialFunctionType type = null;
            type = (IOmlPartialFunctionType) tmpVal_10;
            Vector rexpr_11 = null;
            IOmlType par_12 = null;
            par_12 = (IOmlType) type.getDomType();
            rexpr_11 = buildParameterTypes((IOmlType) par_12);
            return rexpr_11;
          }
          else {

            Vector rexpr_5 = null;
            rexpr_5 = new Vector();
            rexpr_5.add(t);
            return rexpr_5;
          }
        }
      }
    }
  }
// ***** VDMTOOLS END Name=buildParameterTypes#1|IOmlType


// ***** VDMTOOLS START Name=build_udef_ublock#2|IOmlFunctionDefinitions|String KEEP=NO
  public IUmlOwnedOperations build_udef_ublock (final IOmlFunctionDefinitions opDef, final String owner) throws CGException {

    Vector tmpVal_4 = null;
    tmpVal_4 = opDef.getFunctionList();
    Vector ops = null;
    ops = tmpVal_4;
    UmlOwnedOperations rexpr_5 = null;
    HashSet arg_6 = new HashSet();
    HashSet res_s_7 = new HashSet();
    {

      HashSet e_set_14 = new HashSet();
      HashSet riseq_16 = new HashSet();
      int max_17 = ops.size();
      for (int i_18 = 1; i_18 <= max_17; i_18++) 
        riseq_16.add(new Long(i_18));
      e_set_14 = riseq_16;
      Long i = null;
      {
        for (Iterator enm_20 = e_set_14.iterator(); enm_20.hasNext(); ) {

          Long elem_19 = UTIL.NumberToLong(enm_20.next());
          i = elem_19;
          IUmlOperation res_s_8 = null;
          IOmlFunctionDefinition par_9 = null;
          if ((1 <= i.intValue()) && (i.intValue() <= ops.size())) 
            par_9 = (IOmlFunctionDefinition) ops.get(i.intValue() - 1);
          else 
            UTIL.RunTime("Run-Time Error:Illegal index");
          res_s_8 = (IUmlOperation) buildFunction((IOmlFunctionDefinition) par_9, owner);
          res_s_7.add(res_s_8);
        }
      }
    }
    arg_6 = res_s_7;
    rexpr_5 = new UmlOwnedOperations(arg_6);
    return (IUmlOwnedOperations) rexpr_5;
  }
// ***** VDMTOOLS END Name=build_udef_ublock#2|IOmlFunctionDefinitions|String


// ***** VDMTOOLS START Name=buildFunction#2|IOmlFunctionDefinition|String KEEP=NO
  public IUmlOperation buildFunction (final IOmlFunctionDefinition var_1_1, final String var_2_2) throws CGException {

    IOmlFunctionDefinition op = null;
    boolean succ_3 = true;
    op = (IOmlFunctionDefinition) var_1_1;
    if (!succ_3) 
      UTIL.RunTime("Run-Time Error:Pattern match failed in operation call in operation buildFunction");
    {

      IOmlAccessDefinition access = null;
      access = (IOmlAccessDefinition) op.getAccess();
      IOmlScope scope = null;
      scope = (IOmlScope) access.getScope();
      IOmlExplicitFunction shape = null;
      shape = (IOmlExplicitFunction) op.getShape();
      Boolean isStatic = null;
      isStatic = access.getStaticAccess();
      String name = null;
      name = shape.getIdentifier();
      IUmlVisibilityKind visibility = (IUmlVisibilityKind) (IUmlVisibilityKind) convertScopeToVisibility((IOmlScope) scope);
      UmlMultiplicityElement multiplicity = (UmlMultiplicityElement) new UmlMultiplicityElement(new Boolean(false), new Boolean(false), new Long(1), new Long(1));
      IUmlType type = null;
      IOmlType par_18 = null;
      par_18 = (IOmlType) shape.getType();
      type = (IUmlType) Vdm2UmlType.convertType(par_18);
      IOmlParameter pnames = null;
      Boolean cond_21 = null;
      Long var1_22 = null;
      Vector unArg_23 = null;
      unArg_23 = shape.getParameterList();
      var1_22 = new Long(unArg_23.size());
      cond_21 = new Boolean(var1_22.intValue() == new Long(0).intValue());
      if (cond_21.booleanValue()) 
        pnames = null;
      else {

        HashSet tmpSet_25 = new HashSet();
        Vector unArg_29 = null;
        unArg_29 = shape.getParameterList();
        HashSet set_30 = new HashSet();
        Enumeration enm_31 = unArg_29.elements();
        while ( enm_31.hasMoreElements())
          set_30.add(enm_31.nextElement());
        tmpSet_25 = set_30;
        IOmlParameter p = null;
        boolean succ_27 = false;
        for (Iterator enm_32 = tmpSet_25.iterator(); enm_32.hasNext() && !succ_27; ) {

          IOmlParameter tmpElem_28 = (IOmlParameter) enm_32.next();
          succ_27 = true;
          p = (IOmlParameter) tmpElem_28;
        }
        if (!succ_27) 
          UTIL.RunTime("Run-Time Error:The binding environment was empty");
        pnames = (IOmlParameter) p;
      }
      Vector tmpVal_33 = null;
      Vector par_34 = null;
      if (new Boolean(!UTIL.equals(pnames, null)).booleanValue()) 
        par_34 = pnames.getPatternList();
      else 
        par_34 = new Vector();
      IOmlType par_39 = null;
      par_39 = (IOmlType) shape.getType();
      tmpVal_33 = buildParameters(par_34, (IOmlType) par_39);
      Vector pars = null;
      pars = tmpVal_33;
      return (IUmlOperation) new UmlOperation(name, visibility, multiplicity, new Boolean(true), type, isStatic, new UmlParameters(pars));
    }
  }
// ***** VDMTOOLS END Name=buildFunction#2|IOmlFunctionDefinition|String


// ***** VDMTOOLS START Name=isSimpleType#1|IOmlType KEEP=NO
  public Boolean isSimpleType (final IOmlType t) throws CGException {

    Boolean varRes_2 = null;
    boolean succ_3 = true;
    {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlInjectiveMapType))) 
        succ_3 = false;
      if (!succ_3) {

        succ_3 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlGeneralMapType))) 
          succ_3 = false;
      }
      if (!succ_3) {

        succ_3 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlTypeName))) 
          succ_3 = false;
      }
      if (!succ_3) {

        succ_3 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlProductType))) 
          succ_3 = false;
      }
      if (!succ_3) {

        succ_3 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlUnionType))) 
          succ_3 = false;
      }
      if (succ_3) 
        varRes_2 = new Boolean(false);
    }
    if (!succ_3) {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlSetType))) 
        succ_3 = false;
      if (succ_3) {

        IOmlSetType t1 = (IOmlSetType) t;
        IOmlType par_20 = null;
        par_20 = (IOmlType) t1.getType();
        varRes_2 = isSimpleType((IOmlType) par_20);
      }
    }
    if (!succ_3) {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlSeq0Type))) 
        succ_3 = false;
      if (succ_3) {

        IOmlSeq0Type t1 = (IOmlSeq0Type) t;
        IOmlType par_25 = null;
        par_25 = (IOmlType) t1.getType();
        varRes_2 = isSimpleType((IOmlType) par_25);
      }
    }
    if (!succ_3) {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlSeq1Type))) 
        succ_3 = false;
      if (succ_3) {

        IOmlSeq1Type t1 = (IOmlSeq1Type) t;
        IOmlType par_30 = null;
        par_30 = (IOmlType) t1.getType();
        varRes_2 = isSimpleType((IOmlType) par_30);
      }
    }
    if (!succ_3) {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IOmlOptionalType))) 
        succ_3 = false;
      if (succ_3) {

        IOmlOptionalType t1 = (IOmlOptionalType) t;
        IOmlType par_35 = null;
        par_35 = (IOmlType) t1.getType();
        varRes_2 = isSimpleType((IOmlType) par_35);
      }
    }
    if (!succ_3) 
      varRes_2 = new Boolean(true);
    return varRes_2;
  }
// ***** VDMTOOLS END Name=isSimpleType#1|IOmlType


// ***** VDMTOOLS START Name=GetSimpleTypeName#1|IUmlType KEEP=NO
  private String GetSimpleTypeName (final IUmlType t) throws CGException {

    String varRes_2 = null;
    boolean succ_3 = true;
    {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IUmlBoolType))) 
        succ_3 = false;
      if (succ_3) 
        varRes_2 = new String("bool");
    }
    if (!succ_3) {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IUmlIntegerType))) 
        succ_3 = false;
      if (succ_3) 
        varRes_2 = new String("int");
    }
    if (!succ_3) {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(t instanceof IUmlCharType))) 
        succ_3 = false;
      if (succ_3) 
        varRes_2 = new String("char");
    }
    if (!succ_3) 
      varRes_2 = new String("String");
    return varRes_2;
  }
// ***** VDMTOOLS END Name=GetSimpleTypeName#1|IUmlType


// ***** VDMTOOLS START Name=CreateAssociationFromProperty#2|IUmlProperty|IOmlType KEEP=NO
  public void CreateAssociationFromProperty (final IUmlProperty property, final IOmlType omlType) throws CGException {

    boolean succ_3 = true;
    {

      succ_3 = true;
      if (!UTIL.equals(new Boolean(true), new Boolean(omlType instanceof IOmlProductType))) 
        succ_3 = false;
      if (succ_3) 
        CreateAssociationFromPropertyProductType((IUmlProperty) property, (IOmlType) omlType);
      else {

        succ_3 = true;
        if (!UTIL.equals(new Boolean(true), new Boolean(omlType instanceof IOmlUnionType))) 
          succ_3 = false;
        if (succ_3) 
          CreateAssociationFromPropertyUnionType((IUmlProperty) property, (IOmlType) omlType);
        else 
          CreateAssociationFromPropertyGeneral((IUmlProperty) property, (IOmlType) omlType);
      }
    }
  }
// ***** VDMTOOLS END Name=CreateAssociationFromProperty#2|IUmlProperty|IOmlType


// ***** VDMTOOLS START Name=CreateAssociationFromPropertyGeneral#2|IUmlProperty|IOmlType KEEP=NO
  public void CreateAssociationFromPropertyGeneral (final IUmlProperty var_1_1, final IOmlType var_2_2) throws CGException {

    IUmlProperty property = null;
    boolean succ_3 = true;
    property = (IUmlProperty) var_1_1;
    if (!succ_3) 
      UTIL.RunTime("Run-Time Error:Pattern match failed in operation call in operation CreateAssociationFromPropertyGeneral");
    {

      String ownerClassName = null;
      Boolean cond_7 = null;
      IUmlType obj_8 = null;
      obj_8 = (IUmlType) property.getType();
      cond_7 = new Boolean(obj_8 instanceof IUmlClassNameType);
      if (cond_7.booleanValue()) {

        IUmlClassNameType pcn = null;
        pcn = (IUmlClassNameType) property.getType();
        ownerClassName = pcn.getName();
      }
      else {

        IUmlType par_9 = null;
        par_9 = (IUmlType) property.getType();
        ownerClassName = GetSimpleTypeName((IUmlType) par_9);
      }
      HashSet propOtherEnd = new HashSet();
      UmlProperty enum_set_13 = null;
      UmlClassNameType arg_17 = null;
      String arg_26 = null;
      arg_26 = property.getOwnerClass();
      arg_17 = new UmlClassNameType(arg_26);
      enum_set_13 = new UmlProperty(new String(""), new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPRIVATE), null, arg_17, null, null, new Boolean(false), null, null, ownerClassName, null);
      propOtherEnd = new HashSet();
      propOtherEnd.add(enum_set_13);
      UmlAssociation elem_28 = null;
      HashSet arg_30 = new HashSet();
      arg_30 = new HashSet();
      arg_30.add(property);
      elem_28 = new UmlAssociation(propOtherEnd, arg_30, null, GetNextId());
      associations.add(elem_28);
    }
  }
// ***** VDMTOOLS END Name=CreateAssociationFromPropertyGeneral#2|IUmlProperty|IOmlType


// ***** VDMTOOLS START Name=CreateAssociationFromPropertyProductType#2|IUmlProperty|IOmlType KEEP=NO
  public void CreateAssociationFromPropertyProductType (final IUmlProperty property, final IOmlType omlType) throws CGException {

    String tmpVal_4 = null;
    tmpVal_4 = property.getName();
    String name = null;
    name = tmpVal_4;
    UmlProperty prop = (UmlProperty) property;
    HashSet props = new HashSet();
    HashSet unArg_7 = new HashSet();
    HashSet res_s_8 = new HashSet();
    {

      HashSet e_set_15 = new HashSet();
      e_set_15 = new HashSet();
      e_set_15.add(omlType);
      IOmlType p = null;
      {
        for (Iterator enm_18 = e_set_15.iterator(); enm_18.hasNext(); ) {

          IOmlType elem_17 = (IOmlType) enm_18.next();
          p = (IOmlType) elem_17;
          if (new Boolean(p instanceof IOmlProductType).booleanValue()) {
            res_s_8.add(CreateEndProperty((IOmlType) p, name));
          }
        }
      }
    }
    unArg_7 = res_s_8;
    HashSet rduset_19 = new HashSet();
    for (Iterator enm_21 = unArg_7.iterator(); enm_21.hasNext(); ) {

      HashSet e_20 = (HashSet) enm_21.next();
      rduset_19.addAll(e_20);
    }
    props = rduset_19;
    {

      prop.setName(new String(""));
      if (new Boolean((new Long(props.size()).intValue()) > (new Long(1).intValue())).booleanValue()) {

        UmlAssociation elem_29 = null;
        HashSet arg_31 = new HashSet();
        arg_31 = new HashSet();
        arg_31.add(prop);
        elem_29 = new UmlAssociation(props, arg_31, null, GetNextId());
        associations.add(elem_29);
      }
    }
  }
// ***** VDMTOOLS END Name=CreateAssociationFromPropertyProductType#2|IUmlProperty|IOmlType


// ***** VDMTOOLS START Name=CreateAssociationFromPropertyUnionType#2|IUmlProperty|IOmlType KEEP=NO
  public void CreateAssociationFromPropertyUnionType (final IUmlProperty property, final IOmlType omlType) throws CGException {

    String tmpVal_4 = null;
    tmpVal_4 = property.getName();
    String name = null;
    name = tmpVal_4;
    UmlProperty prop = (UmlProperty) property;
    HashSet props = new HashSet();
    HashSet unArg_7 = new HashSet();
    HashSet res_s_8 = new HashSet();
    {

      HashSet e_set_15 = new HashSet();
      e_set_15 = new HashSet();
      e_set_15.add(omlType);
      IOmlType p = null;
      {
        for (Iterator enm_18 = e_set_15.iterator(); enm_18.hasNext(); ) {

          IOmlType elem_17 = (IOmlType) enm_18.next();
          p = (IOmlType) elem_17;
          if (new Boolean(p instanceof IOmlUnionType).booleanValue()) {
            res_s_8.add(CreateEndProperty((IOmlType) p, name));
          }
        }
      }
    }
    unArg_7 = res_s_8;
    HashSet rduset_19 = new HashSet();
    for (Iterator enm_21 = unArg_7.iterator(); enm_21.hasNext(); ) {

      HashSet e_20 = (HashSet) enm_21.next();
      rduset_19.addAll(e_20);
    }
    props = rduset_19;
    {

      prop.setName(new String(""));
      if (new Boolean((new Long(props.size()).intValue()) > (new Long(1).intValue())).booleanValue()) {

        HashSet assoc = new HashSet();
        HashSet res_s_28 = new HashSet();
        {

          IUmlProperty p = null;
          {
            for (Iterator enm_39 = props.iterator(); enm_39.hasNext(); ) {

              IUmlProperty elem_38 = (IUmlProperty) enm_39.next();
              p = (IUmlProperty) elem_38;
              UmlAssociation res_s_29 = null;
              HashSet arg_30 = new HashSet();
              arg_30 = new HashSet();
              arg_30.add(p);
              HashSet arg_31 = new HashSet();
              arg_31 = new HashSet();
              arg_31.add(prop);
              res_s_29 = new UmlAssociation(arg_30, arg_31, null, GetNextId());
              res_s_28.add(res_s_29);
            }
          }
        }
        assoc = res_s_28;
        HashSet rhs_40 = new HashSet();
        rhs_40 = (HashSet) associations.clone();
        rhs_40.addAll(assoc);
        associations = (HashSet) UTIL.clone(rhs_40);
        UmlConstraint elem_44 = null;
        HashSet arg_45 = new HashSet();
        HashSet res_s_47 = new HashSet();
        {

          IUmlAssociation a = null;
          {
            for (Iterator enm_52 = assoc.iterator(); enm_52.hasNext(); ) {

              IUmlAssociation elem_51 = (IUmlAssociation) enm_52.next();
              a = (IUmlAssociation) elem_51;
              String res_s_48 = null;
              res_s_48 = a.getId();
              res_s_47.add(res_s_48);
            }
          }
        }
        arg_45 = res_s_47;
        elem_44 = new UmlConstraint(arg_45, new UmlLiteralString(new String("xor")));
        constraints.add(elem_44);
      }
    }
  }
// ***** VDMTOOLS END Name=CreateAssociationFromPropertyUnionType#2|IUmlProperty|IOmlType


// ***** VDMTOOLS START Name=CreateEndProperty#2|IOmlType|String KEEP=NO
  public HashSet CreateEndProperty (final IOmlType t, final String name) throws CGException {
    if (new Boolean(t instanceof IOmlProductType).booleanValue()) {

      IOmlProductType typedType = (IOmlProductType) t;
      HashSet rexpr_35 = new HashSet();
      HashSet var1_36 = new HashSet();
      IOmlType par_37 = null;
      par_37 = (IOmlType) typedType.getLhsType();
      var1_36 = CreateEndProperty((IOmlType) par_37, name);
      HashSet var2_39 = new HashSet();
      IOmlType par_40 = null;
      par_40 = (IOmlType) typedType.getRhsType();
      var2_39 = CreateEndProperty((IOmlType) par_40, name);
      rexpr_35 = (HashSet) var1_36.clone();
      rexpr_35.addAll(var2_39);
      return rexpr_35;
    }
    else 
      if (new Boolean(t instanceof IOmlUnionType).booleanValue()) {

        IOmlUnionType typedType = (IOmlUnionType) t;
        HashSet rexpr_26 = new HashSet();
        HashSet var1_27 = new HashSet();
        IOmlType par_28 = null;
        par_28 = (IOmlType) typedType.getLhsType();
        var1_27 = CreateEndProperty((IOmlType) par_28, name);
        HashSet var2_30 = new HashSet();
        IOmlType par_31 = null;
        par_31 = (IOmlType) typedType.getRhsType();
        var2_30 = CreateEndProperty((IOmlType) par_31, name);
        rexpr_26 = (HashSet) var1_27.clone();
        rexpr_26.addAll(var2_30);
        return rexpr_26;
      }
      else {

        HashSet rexpr_7 = new HashSet();
        UmlProperty enum_set_8 = null;
        IUmlMultiplicityElement arg_11 = null;
        arg_11 = (IUmlMultiplicityElement) Vdm2UmlType.extractMultiplicity((IOmlType) t);
        IUmlType arg_12 = null;
        arg_12 = (IUmlType) Vdm2UmlType.convertType(t);
        IUmlType arg_19 = null;
        arg_19 = (IUmlType) Vdm2UmlType.getQualifier(t);
        enum_set_8 = new UmlProperty(name, new UmlVisibilityKind(UmlVisibilityKindQuotes.IQPRIVATE), arg_11, arg_12, null, null, new Boolean(false), null, null, new String("Implementation prosponed"), arg_19);
        rexpr_7 = new HashSet();
        rexpr_7.add(enum_set_8);
        return rexpr_7;
      }
  }
// ***** VDMTOOLS END Name=CreateEndProperty#2|IOmlType|String


// ***** VDMTOOLS START Name=GetNextId KEEP=NO
  private String GetNextId () throws CGException {

    runningId = UTIL.NumberToLong(UTIL.clone(new Long(runningId.intValue() + new Long(1).intValue())));
    String rexpr_4 = null;
    rexpr_4 = UTIL.ConvertToString(Util.ToString(runningId));
    return rexpr_4;
  }
// ***** VDMTOOLS END Name=GetNextId

}
;
