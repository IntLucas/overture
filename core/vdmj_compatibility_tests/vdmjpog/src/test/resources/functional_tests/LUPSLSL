-- TCErrors: WARNING:5012:35,1 WARNING:5000:12,1 WARNING:5000:13,1 WARNING:5000:14,1 WARNING:5000:15,1 WARNING:5000:16,1 WARNING:5000:43,1 WARNING:5000:57,1 WARNING:5000:73,1 WARNING:5000:96,1 WARNING:5000:106,1 WARNING:5000:129,1 WARNING:5000:156,1 WARNING:5000:189,1 PROOFOBLIGATION: fDIwOjEgTWF4T2ZTZXQsKGZvcmFsbCBzOnNldCBvZiAoaW50KSAmCiAgcHJlX01heE9mU2V0KHMpID0+IHBvc3RfTWF4T2ZTZXQocywgbGV0IGUgaW4gc2V0IHMgaW4gKGlmICgoY2FyZCBzKSA9IDEpCiAgdGhlbiBlCiAgZWxzZSBsZXQgbXI6aW50ID0gTWF4T2ZTZXQoKHMgXCB7ZX0pKSBpbiAoaWYgKGUgPiBtcikKICB0aGVuIGUKICBlbHNlIG1yKSkpKQoscG9zdCBjb25kaXRpb24sbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDIyOjYgTWF4T2ZTZXQsKGZvcmFsbCBzOnNldCBvZiAoaW50KSAmIChzIDw+IHt9KSA9PgogIGV4aXN0cyBlIGluIHNldCBzKQosbGV0IGJlIHN0IGV4aXN0ZW5jZSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDI2OjE2IE1heE9mU2V0LCBtciwoZm9yYWxsIHM6c2V0IG9mIChpbnQpICYgKHMgPD4ge30pID0+CiAgKGZvcmFsbCBlIGluIHNldCBzICYKICAgIChub3QgKChjYXJkIHMpID0gMSkgPT4KICAgICAgcHJlX01heE9mU2V0KChzIFwge2V9KSkpKSkKLGZ1bmN0aW9uIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDIwOjEgTWF4T2ZTZXQsIG1yLChmb3JhbGwgczpzZXQgb2YgKGludCkgJiAocyA8PiB7fSkgPT4KICAoZm9yYWxsIGUgaW4gc2V0IHMgJgogICAgKG5vdCAoKGNhcmQgcykgPSAxKSA9PgogICAgICBDYXJkSW50KHMpID4gQ2FyZEludCgocyBcIHtlfSkpKSkpCixyZWN1cnNpdmUgZnVuY3Rpb24sbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDM3OjMxIGx1cHNsdG9rLCBjb21wYXRpYmxlLChmb3JhbGwgYTphcnJheSwgazpuYXQxICYKICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLChrIC0gMSl9ICYgKGEoaikgPD0gYShrKSkgPT4KICAgIGogPiAwKSkKLHN1YnR5cGUsbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDM3OjU4IGx1cHNsdG9rLCBjb21wYXRpYmxlLChmb3JhbGwgYTphcnJheSwgazpuYXQxICYKICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLChrIC0gMSl9ICYKICAgIGogaW4gc2V0IGluZHMgYSkpCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDM3OjY0IGx1cHNsdG9rLCBjb21wYXRpYmxlLChmb3JhbGwgYTphcnJheSwgazpuYXQxICYKICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLChrIC0gMSl9ICYKICAgIGsgaW4gc2V0IGluZHMgYSkpCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDQxOjkgbHVwc2x0b2ssKGZvcmFsbCBhOmFycmF5LCBrOm5hdDEgJgogIChsZXQgY29tcGF0aWJsZTpzZXQgb2YgKG5hdCkgPSB7bHVwc2x0b2soYSwgaikgfCBbaiBpbiBzZXQgezEsIC4uLiAsKGsgLSAxKX1dICYgKGEoaikgPD0gYShrKSl9IGluCiAgICAobm90IChjb21wYXRpYmxlID0ge30pID0+CiAgICAgIHByZV9NYXhPZlNldChjb21wYXRpYmxlKSkpKQosZnVuY3Rpb24gYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDM1OjEgbHVwc2x0b2ssKGZvcmFsbCBhOmFycmF5LCBrOm5hdDEgJgogIGxldCBjb21wYXRpYmxlOnNldCBvZiAobmF0KSA9IHtsdXBzbHRvayhhLCBqKSB8IFtqIGluIHNldCB7MSwgLi4uICwoayAtIDEpfV0gJiAoYShqKSA8PSBhKGspKX0gaW4gKGlmIChjb21wYXRpYmxlID0ge30pCiAgdGhlbiAxCiAgZWxzZSAoTWF4T2ZTZXQoY29tcGF0aWJsZSkgKyAxKSkgPj0gMCkKLHN1YnR5cGUsbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDQ1OjMgbHVwc2wsKGZvcmFsbCBhOmFycmF5ICYKICBwcmVfTWF4T2ZTZXQoe2x1cHNsdG9rKGEsIGopIHwgW2ogaW4gc2V0IChpbmRzIGEpXX0pKQosZnVuY3Rpb24gYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDQzOjEgbHVwc2wsKGZvcmFsbCBhOmFycmF5ICYKICBNYXhPZlNldCh7bHVwc2x0b2soYSwgaikgfCBbaiBpbiBzZXQgKGluZHMgYSldfSkgPj0gMCkKLHN1YnR5cGUsbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDQ5OjMzIGFzY2VuZGluZywoZm9yYWxsIGE6YXJyYXksIHM6c2V0IG9mIChpbnQpICYgKHMgc3Vic2V0IChpbmRzIGEpKSA9PgogIChmb3JhbGwgaSwgaiBpbiBzZXQgcyAmCiAgICBpIGluIHNldCBpbmRzIGEpKQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDQ5OjM5IGFzY2VuZGluZywoZm9yYWxsIGE6YXJyYXksIHM6c2V0IG9mIChpbnQpICYgKHMgc3Vic2V0IChpbmRzIGEpKSA9PgogIChmb3JhbGwgaSwgaiBpbiBzZXQgcyAmCiAgICBqIGluIHNldCBpbmRzIGEpKQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDUzOjQgbHVwc2xTcGVjLChmb3JhbGwgYTphcnJheSAmCiAgcHJlX01heE9mU2V0KHsoY2FyZCBzKSB8IFtzIGluIHNldCAocG93ZXIgKGluZHMgYSkpXSAmIGFzY2VuZGluZyhhLCBzKX0pKQosZnVuY3Rpb24gYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDUzOjQ4IGx1cHNsU3BlYywoZm9yYWxsIGE6YXJyYXkgJgogIChmb3JhbGwgcyBpbiBzZXQgKHBvd2VyIChpbmRzIGEpKSAmCiAgICBwcmVfYXNjZW5kaW5nKGEsIHMpKSkKLGZ1bmN0aW9uIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDU3OjEgbHVwc2xPcDFMYXNraSwobHVwc2xTcGVjKGEpID0gUkVTVUxUKQosb3BlcmF0aW9uIHBvc3QgY29uZGl0aW9uLG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDYyOjExIGx1cHNsT3AxTGFza2kscHJlX01heE9mU2V0KGx1cHNscykKLGZ1bmN0aW9uIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDU3OjEgbHVwc2xPcDFMYXNraSxSRVNVTFQgPj0gMAosc3VidHlwZSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDczOjEgbHVwc21PcDFHcmllcywobHVwc2xTcGVjKGEpID0gUkVTVUxUKQosb3BlcmF0aW9uIHBvc3QgY29uZGl0aW9uLG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDc1OjE3IGx1cHNtT3AxR3JpZXMsMSBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDg1OjcgbHVwc200a29wMUdyaWVzLChsZW4gbHVwc2xhcnIpIGluIHNldCBpbmRzIGx1cHNsYXJyCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDg1OjMxIGx1cHNtNGtvcDFHcmllcyxrIGluIHNldCBpbmRzIGEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDg2OjI5IGx1cHNtNGtvcDFHcmllcyxrIGluIHNldCBpbmRzIGEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDg4OjEyIGx1cHNtNGtvcDFHcmllcyxleGlzdHMxIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmICgobHVwc2xhcnIoeCkgPiBhKGspKSBhbmQgKGZvcmFsbCBqIGluIHNldCB7MSwgLi4uICwoeCAtIDEpfSAmIChsdXBzbGFycihqKSA8PSBhKGspKSkpCix1bmlxdWUgZXhpc3RlbmNlIGJpbmRpbmcsbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDg5OjE0IGx1cHNtNGtvcDFHcmllcywoZm9yYWxsIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmCiAgeCBpbiBzZXQgaW5kcyBsdXBzbGFycikKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDg5OjI4IGx1cHNtNGtvcDFHcmllcywoZm9yYWxsIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmCiAgayBpbiBzZXQgaW5kcyBhKQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDkwOjQ0IGx1cHNtNGtvcDFHcmllcywoZm9yYWxsIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmCiAgKChsdXBzbGFycih4KSA+IGEoaykpID0+CiAgICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLCh4IC0gMSl9ICYKICAgICAgaiBpbiBzZXQgaW5kcyBsdXBzbGFycikpKQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDkwOjU5IGx1cHNtNGtvcDFHcmllcywoZm9yYWxsIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmCiAgKChsdXBzbGFycih4KSA+IGEoaykpID0+CiAgICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLCh4IC0gMSl9ICYKICAgICAgayBpbiBzZXQgaW5kcyBhKSkpCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDkxOjcgbHVwc200a29wMUdyaWVzLGkgPiAwIGFuZCBpIDw9IGxlbiAobHVwc2xhcnIpICsgMQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDkxOjIyIGx1cHNtNGtvcDFHcmllcyxrIGluIHNldCBpbmRzIGEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDk2OjEgbHVwc2xPcDJMYXNraSwobHVwc2xTcGVjKGEpID0gUkVTVUxUKQosb3BlcmF0aW9uIHBvc3QgY29uZGl0aW9uLG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDEwNjoxIGx1cHNtT3AyR3JpZXMsKGx1cHNsU3BlYyhhKSA9IFJFU1VMVCkKLG9wZXJhdGlvbiBwb3N0IGNvbmRpdGlvbixudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEwODoxNyBsdXBzbU9wMkdyaWVzLDEgaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDExODo3IGx1cHNtNGtvcDJHcmllcywobGVuIGx1cHNsYXJyKSBpbiBzZXQgaW5kcyBsdXBzbGFycgosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDExODozMSBsdXBzbTRrb3AyR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDExOToyOSBsdXBzbTRrb3AyR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEyMjo3IGx1cHNtNGtvcDJHcmllcyx3aGlsZSAobHVwc2xhcnIoaSkgPD0gYShrKSkgZG8gLi4uCix3aGlsZSBsb29wIHRlcm1pbmF0aW9uLG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDEyMjoxMyBsdXBzbTRrb3AyR3JpZXMsaSBpbiBzZXQgaW5kcyBsdXBzbGFycgosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDEyMjoyOCBsdXBzbTRrb3AyR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEyNDo3IGx1cHNtNGtvcDJHcmllcyxpID4gMCBhbmQgaSA8PSBsZW4gKGx1cHNsYXJyKSArIDEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDEyNDoyMiBsdXBzbTRrb3AyR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEyOToxIGx1cHNsT3AzTGFza2ksKGx1cHNsU3BlYyhhKSA9IFJFU1VMVCkKLG9wZXJhdGlvbiBwb3N0IGNvbmRpdGlvbixudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE0NToxMSBsdXBzbHRva29wMUxhc2tpLGogaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE0NToxNyBsdXBzbHRva29wMUxhc2tpLGsgaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE0Njo0NCBsdXBzbHRva29wMUxhc2tpLGogaW4gc2V0IGluZHMgbHVwc2xhcnIKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDE1MDoxNCBsdXBzbHRva29wMUxhc2tpLHByZV9NYXhPZlNldChjb21wYXRpYmxlKQosZnVuY3Rpb24gYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE0MDoxIGx1cHNsdG9rb3AxTGFza2ksUkVTVUxUID49IDAKLHN1YnR5cGUsbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE1NjoxIGx1cHNtT3AzR3JpZXMsKGx1cHNsU3BlYyhhKSA9IFJFU1VMVCkKLG9wZXJhdGlvbiBwb3N0IGNvbmRpdGlvbixudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE1ODoxNyBsdXBzbU9wM0dyaWVzLDEgaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE3MDo3IGx1cHNtNGtvcDNHcmllcywobGVuIGx1cHNsYXJyKSBpbiBzZXQgaW5kcyBsdXBzbGFycgosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE3MDozMSBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3MTozMyBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3MjoxMSBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3MjoxNyBsdXBzbTRrb3AzR3JpZXMsMSBpbiBzZXQgaW5kcyBsdXBzbGFycgosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE3Mzo3IGx1cHNtNGtvcDNHcmllcywxID4gMCBhbmQgMSA8PSBsZW4gKGx1cHNsYXJyKSArIDEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDE3MzoyMiBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3Nzo4IGx1cHNtNGtvcDNHcmllcyx3aGlsZSAobGkgPD4gKHJlIC0gMSkpIGRvIC4uLgosd2hpbGUgbG9vcCB0ZXJtaW5hdGlvbixudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3OToxNCBsdXBzbTRrb3AzR3JpZXMsbSBpbiBzZXQgaW5kcyBsdXBzbGFycgosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE3OToyNyBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE4NDoxMCBsdXBzbTRrb3AzR3JpZXMscmUgPiAwIGFuZCByZSA8PSBsZW4gKGx1cHNsYXJyKSArIDEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDE4NDoyNiBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE4OToxIGx1cHNsT3A0TGFza2ksKGx1cHNsU3BlYyhhKSA9IFJFU1VMVCkKLG9wZXJhdGlvbiBwb3N0IGNvbmRpdGlvbixudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDIwNDoxMSBsdXBzbHRva29wMkxhc2tpLGogaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDIwNDoxNyBsdXBzbHRva29wMkxhc2tpLGsgaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDIwNToyMCBsdXBzbHRva29wMkxhc2tpLGogaW4gc2V0IGluZHMgbHVwc2xhcnIKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDIwNjoyMyBsdXBzbHRva29wMkxhc2tpLGogaW4gc2V0IGluZHMgbHVwc2xhcnIKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDIwMDoxIGx1cHNsdG9rb3AyTGFza2ksUkVTVUxUID49IDAKLHN1YnR5cGUsbnVsbCxVbnByb3ZlZHw=


--LUPSL.vdmsl

types

array = seq1 of int;

values

a1: array = [1,2,9,4,7,3]; --,11,8,14,6]; 
a2: array = [4,3,2,1];
a3 = [1,2,3,4]; 
a4 = [2];
a5 = [2,2,2,2];

functions

MaxOfSet: set of int -> int
MaxOfSet(s) ==
 let e in set s in
   if card s = 1 then
      e
   else
      let mr = MaxOfSet(s\{e}) in
         if e > mr then e else mr
 pre s <> {}
 post RESULT in set s and forall e in set s & e <= RESULT
 measure CardInt;

CardInt: set of int -> nat
CardInt(s) == card s;

lupsltok : array * nat1 -> nat
lupsltok(a,k) ==
 let compatible = {lupsltok(a,j) | j in set{1,...,k-1} & a(j)<=a(k)} 
 in
   if compatible = {} 
   then 1 
   else MaxOfSet(compatible) + 1; 

lupsl : array -> nat
lupsl(a) == 
  MaxOfSet({lupsltok(a,j) | j in set inds a});

ascending : array * set of int -> bool
ascending(a,s) ==
   forall i,j in set s & i<j => a(i)<=a(j) pre s subset (inds a);

lupslSpec : array -> int
lupslSpec(a) ==
   MaxOfSet({ card s | s in set power inds a & ascending(a,s) })

operations

lupslOp1Laski : array ==> nat
lupslOp1Laski(a) == 
  (dcl lupsls : set of nat := {};
   for all k in set inds a do
      lupsls := lupsls union {lupsltok(a,k)};
   return MaxOfSet(lupsls);
  )
post lupslSpec(a) = RESULT;

state lups of
  lupslarr : array 
init s == s = mk_lups([1])
end

operations

lupsmOp1Gries : array ==> nat
lupsmOp1Gries(a) == 
  (lupslarr := [a(1)];
   for k = 2 to len a do
      lupsm4kop1Gries(a,k);
   return len lupslarr;
  )
post lupslSpec(a) = RESULT;
 
lupsm4kop1Gries : array * nat1 ==> ()
lupsm4kop1Gries(a,k) ==
  (dcl i : int; 
   if lupslarr(len lupslarr)<=a(k) then
      lupslarr := lupslarr^[a(k)]
   else
     (i := iota x in set {1,...,len lupslarr} &
             lupslarr(x) > a(k) and 
             forall j in set {1,...,x-1} & lupslarr(j) <= a(k);
      lupslarr(i) := a(k);
     );
  )
pre k in set inds a;
 
lupslOp2Laski : array ==> nat
lupslOp2Laski(a) == 
  (dcl lupslmax : nat := 0;
   for k = 1 to len a do
      let lak = lupsltok(a,k) in
        if lak > lupslmax then lupslmax := lak;
   return lupslmax;
  )
post lupslSpec(a) = RESULT;
 
lupsmOp2Gries : array ==> nat
lupsmOp2Gries(a) == 
  (lupslarr := [a(1)];
   for k = 2 to len a do
      lupsm4kop2Gries(a,k);
   return len lupslarr;
  )
post lupslSpec(a) = RESULT;

lupsm4kop2Gries : array * nat1 ==> ()
lupsm4kop2Gries(a,k) ==
  (dcl i : int; 
   if lupslarr(len lupslarr)<=a(k) then
      lupslarr := lupslarr^[a(k)]
   else
     (i := 1;
      while lupslarr(i) <= a(k) do
         i := i+1;
      lupslarr(i) := a(k);
     );
  )
pre k in set inds a;
 
lupslOp3Laski : array ==> nat
lupslOp3Laski(a) == 
  (dcl lupslmax : nat := 0; 
   for k = 1 to len a do
      let lak = lupsltokop1Laski(a,k) in
        if lak > lupslmax 
        then lupslmax := lak;
   return lupslmax;
  )
post lupslSpec(a) = RESULT;

lupsltokop1Laski : array * nat1 ==> nat
lupsltokop1Laski(a,k) ==
  (dcl compatible : set of int := {};
   dcl erg : int; 
   for j = 1 to k-1 do
       if a(j)<=a(k) then
          compatible := (compatible union {lupslarr(j)});
   if compatible = {} then 
      erg := 1
   else 
      erg := MaxOfSet(compatible) + 1;
   lupslarr := lupslarr^[erg];
   return erg;
  )
pre k in set inds a; 
 
lupsmOp3Gries : array ==> nat
lupsmOp3Gries(a) == 
  (lupslarr := [a(1)];
   for k = 2 to len a do
      lupsm4kop3Gries(a,k);
   return len lupslarr;
  )
post lupslSpec(a) = RESULT;
 
lupsm4kop3Gries : array * nat1 ==> ()
lupsm4kop3Gries(a,k) ==
  (dcl li : int,
       re : int,
       m  : int; 
   if lupslarr(len lupslarr)<=a(k) then
          lupslarr := lupslarr^[a(k)]
   elseif a(k)< lupslarr(1) then 
      lupslarr(1) := a(k)
   else  
      (li := 1;
       re := len lupslarr;
       while li <> re-1 do
         (m := (li+re) div 2;
          if lupslarr(m)<=a(k) then
             li := m
          else
             re := m;
         );
         lupslarr(re) := a(k);
       );
  )
pre k in set inds a;
 
lupslOp4Laski : array ==> nat
lupslOp4Laski(a) == 
  (dcl lupslmax : nat := 0; 
   for k = 1 to len a do
      let lak = lupsltokop2Laski(a,k) in
        if lak > lupslmax 
        then lupslmax := lak;
   return lupslmax;
  )
post lupslSpec(a) = RESULT;
 
lupsltokop2Laski : array * nat1 ==> nat
lupsltokop2Laski(a,k) ==
  (dcl erg : int := 0; 
   for j = 1 to k-1 do
       if a(j)<=a(k) then
          if erg < lupslarr(j) 
          then erg := lupslarr(j);
   erg := erg+1;
   lupslarr := lupslarr^[erg];
   return erg;
  )
pre k in set inds a; 

 