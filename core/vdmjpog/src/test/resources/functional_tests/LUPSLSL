-- TCErrors: WARNING:5012:35,1 WARNING:5000:12,1 WARNING:5000:13,1 WARNING:5000:14,1 WARNING:5000:15,1 WARNING:5000:16,1 WARNING:5000:43,1 WARNING:5000:57,1 WARNING:5000:73,1 WARNING:5000:96,1 WARNING:5000:106,1 WARNING:5000:129,1 WARNING:5000:156,1 WARNING:5000:189,1 PROOFOBLIGATION: fDIwIE1heE9mU2V0LChmb3JhbGwgczpzZXQgb2YgKGludCkgJgogIHByZV9NYXhPZlNldChzKSA9PiBwb3N0X01heE9mU2V0KHMsIGxldCBlIGluIHNldCBzIGluIChpZiAoKGNhcmQgcykgPSAxKQogIHRoZW4gZQogIGVsc2UgbGV0IG1yOmludCA9IE1heE9mU2V0KChzIFwge2V9KSkgaW4gKGlmIChlID4gbXIpCiAgdGhlbiBlCiAgZWxzZSBtcikpKSkKLHBvc3QgY29uZGl0aW9uLG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDIyIE1heE9mU2V0LChmb3JhbGwgczpzZXQgb2YgKGludCkgJiAocyA8PiB7fSkgPT4KICBleGlzdHMgZSBpbiBzZXQgcykKLGxldCBiZSBzdCBleGlzdGVuY2UsbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDI2IE1heE9mU2V0LCBtciwoZm9yYWxsIHM6c2V0IG9mIChpbnQpICYgKHMgPD4ge30pID0+CiAgKGZvcmFsbCBlIGluIHNldCBzICYKICAgIChub3QgKChjYXJkIHMpID0gMSkgPT4KICAgICAgcHJlX01heE9mU2V0KChzIFwge2V9KSkpKSkKLGZ1bmN0aW9uIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDIwIE1heE9mU2V0LCBtciwoZm9yYWxsIHM6c2V0IG9mIChpbnQpICYgKHMgPD4ge30pID0+CiAgKGZvcmFsbCBlIGluIHNldCBzICYKICAgIChub3QgKChjYXJkIHMpID0gMSkgPT4KICAgICAgQ2FyZEludChzKSA+IENhcmRJbnQoKHMgXCB7ZX0pKSkpKQoscmVjdXJzaXZlIGZ1bmN0aW9uLG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDM3IGx1cHNsdG9rLCBjb21wYXRpYmxlLChmb3JhbGwgYTphcnJheSwgazpuYXQxICYKICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLChrIC0gMSl9ICYgKGEoaikgPD0gYShrKSkgPT4KICAgIGogPiAwKSkKLHN1YnR5cGUsbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDM3IGx1cHNsdG9rLCBjb21wYXRpYmxlLChmb3JhbGwgYTphcnJheSwgazpuYXQxICYKICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLChrIC0gMSl9ICYKICAgIGogaW4gc2V0IGluZHMgYSkpCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDM3IGx1cHNsdG9rLCBjb21wYXRpYmxlLChmb3JhbGwgYTphcnJheSwgazpuYXQxICYKICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLChrIC0gMSl9ICYKICAgIGsgaW4gc2V0IGluZHMgYSkpCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDQxIGx1cHNsdG9rLChmb3JhbGwgYTphcnJheSwgazpuYXQxICYKICAobGV0IGNvbXBhdGlibGU6c2V0IG9mIChuYXQpID0ge2x1cHNsdG9rKGEsIGopIHwgW2ogaW4gc2V0IHsxLCAuLi4gLChrIC0gMSl9XSAmIChhKGopIDw9IGEoaykpfSBpbgogICAgKG5vdCAoY29tcGF0aWJsZSA9IHt9KSA9PgogICAgICBwcmVfTWF4T2ZTZXQoY29tcGF0aWJsZSkpKSkKLGZ1bmN0aW9uIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDM1IGx1cHNsdG9rLChmb3JhbGwgYTphcnJheSwgazpuYXQxICYKICBsZXQgY29tcGF0aWJsZTpzZXQgb2YgKG5hdCkgPSB7bHVwc2x0b2soYSwgaikgfCBbaiBpbiBzZXQgezEsIC4uLiAsKGsgLSAxKX1dICYgKGEoaikgPD0gYShrKSl9IGluIChpZiAoY29tcGF0aWJsZSA9IHt9KQogIHRoZW4gMQogIGVsc2UgKE1heE9mU2V0KGNvbXBhdGlibGUpICsgMSkpID49IDApCixzdWJ0eXBlLG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDQ1IGx1cHNsLChmb3JhbGwgYTphcnJheSAmCiAgcHJlX01heE9mU2V0KHtsdXBzbHRvayhhLCBqKSB8IFtqIGluIHNldCAoaW5kcyBhKV19KSkKLGZ1bmN0aW9uIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDQzIGx1cHNsLChmb3JhbGwgYTphcnJheSAmCiAgTWF4T2ZTZXQoe2x1cHNsdG9rKGEsIGopIHwgW2ogaW4gc2V0IChpbmRzIGEpXX0pID49IDApCixzdWJ0eXBlLG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDQ5IGFzY2VuZGluZywoZm9yYWxsIGE6YXJyYXksIHM6c2V0IG9mIChpbnQpICYgKHMgc3Vic2V0IChpbmRzIGEpKSA9PgogIChmb3JhbGwgaSwgaiBpbiBzZXQgcyAmCiAgICBpIGluIHNldCBpbmRzIGEpKQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDQ5IGFzY2VuZGluZywoZm9yYWxsIGE6YXJyYXksIHM6c2V0IG9mIChpbnQpICYgKHMgc3Vic2V0IChpbmRzIGEpKSA9PgogIChmb3JhbGwgaSwgaiBpbiBzZXQgcyAmCiAgICBqIGluIHNldCBpbmRzIGEpKQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDUzIGx1cHNsU3BlYywoZm9yYWxsIGE6YXJyYXkgJgogIHByZV9NYXhPZlNldCh7KGNhcmQgcykgfCBbcyBpbiBzZXQgKHBvd2VyIChpbmRzIGEpKV0gJiBhc2NlbmRpbmcoYSwgcyl9KSkKLGZ1bmN0aW9uIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDUzIGx1cHNsU3BlYywoZm9yYWxsIGE6YXJyYXkgJgogIChmb3JhbGwgcyBpbiBzZXQgKHBvd2VyIChpbmRzIGEpKSAmCiAgICBwcmVfYXNjZW5kaW5nKGEsIHMpKSkKLGZ1bmN0aW9uIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDU3IGx1cHNsT3AxTGFza2ksKGx1cHNsU3BlYyhhKSA9IFJFU1VMVCkKLG9wZXJhdGlvbiBwb3N0IGNvbmRpdGlvbixudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDYyIGx1cHNsT3AxTGFza2kscHJlX01heE9mU2V0KGx1cHNscykKLGZ1bmN0aW9uIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDU3IGx1cHNsT3AxTGFza2ksUkVTVUxUID49IDAKLHN1YnR5cGUsbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDczIGx1cHNtT3AxR3JpZXMsKGx1cHNsU3BlYyhhKSA9IFJFU1VMVCkKLG9wZXJhdGlvbiBwb3N0IGNvbmRpdGlvbixudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDc1IGx1cHNtT3AxR3JpZXMsMSBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDg1IGx1cHNtNGtvcDFHcmllcywobGVuIGx1cHNsYXJyKSBpbiBzZXQgaW5kcyBsdXBzbGFycgosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDg1IGx1cHNtNGtvcDFHcmllcyxrIGluIHNldCBpbmRzIGEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDg2IGx1cHNtNGtvcDFHcmllcyxrIGluIHNldCBpbmRzIGEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDg4IGx1cHNtNGtvcDFHcmllcyxleGlzdHMxIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmICgobHVwc2xhcnIoeCkgPiBhKGspKSBhbmQgKGZvcmFsbCBqIGluIHNldCB7MSwgLi4uICwoeCAtIDEpfSAmIChsdXBzbGFycihqKSA8PSBhKGspKSkpCix1bmlxdWUgZXhpc3RlbmNlIGJpbmRpbmcsbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDg5IGx1cHNtNGtvcDFHcmllcywoZm9yYWxsIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmCiAgeCBpbiBzZXQgaW5kcyBsdXBzbGFycikKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDg5IGx1cHNtNGtvcDFHcmllcywoZm9yYWxsIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmCiAgayBpbiBzZXQgaW5kcyBhKQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDkwIGx1cHNtNGtvcDFHcmllcywoZm9yYWxsIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmCiAgKChsdXBzbGFycih4KSA+IGEoaykpID0+CiAgICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLCh4IC0gMSl9ICYKICAgICAgaiBpbiBzZXQgaW5kcyBsdXBzbGFycikpKQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDkwIGx1cHNtNGtvcDFHcmllcywoZm9yYWxsIHggaW4gc2V0IHsxLCAuLi4gLChsZW4gbHVwc2xhcnIpfSAmCiAgKChsdXBzbGFycih4KSA+IGEoaykpID0+CiAgICAoZm9yYWxsIGogaW4gc2V0IHsxLCAuLi4gLCh4IC0gMSl9ICYKICAgICAgayBpbiBzZXQgaW5kcyBhKSkpCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDkxIGx1cHNtNGtvcDFHcmllcyxpID4gMCBhbmQgaSA8PSBsZW4gKGx1cHNsYXJyKSArIDEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDkxIGx1cHNtNGtvcDFHcmllcyxrIGluIHNldCBpbmRzIGEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDk2IGx1cHNsT3AyTGFza2ksKGx1cHNsU3BlYyhhKSA9IFJFU1VMVCkKLG9wZXJhdGlvbiBwb3N0IGNvbmRpdGlvbixudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEwNiBsdXBzbU9wMkdyaWVzLChsdXBzbFNwZWMoYSkgPSBSRVNVTFQpCixvcGVyYXRpb24gcG9zdCBjb25kaXRpb24sbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDEwOCBsdXBzbU9wMkdyaWVzLDEgaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDExOCBsdXBzbTRrb3AyR3JpZXMsKGxlbiBsdXBzbGFycikgaW4gc2V0IGluZHMgbHVwc2xhcnIKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDExOCBsdXBzbTRrb3AyR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDExOSBsdXBzbTRrb3AyR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEyMiBsdXBzbTRrb3AyR3JpZXMsd2hpbGUgKGx1cHNsYXJyKGkpIDw9IGEoaykpIGRvIC4uLgosd2hpbGUgbG9vcCB0ZXJtaW5hdGlvbixudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEyMiBsdXBzbTRrb3AyR3JpZXMsaSBpbiBzZXQgaW5kcyBsdXBzbGFycgosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDEyMiBsdXBzbTRrb3AyR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEyNCBsdXBzbTRrb3AyR3JpZXMsaSA+IDAgYW5kIGkgPD0gbGVuIChsdXBzbGFycikgKyAxCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEyNCBsdXBzbTRrb3AyR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDEyOSBsdXBzbE9wM0xhc2tpLChsdXBzbFNwZWMoYSkgPSBSRVNVTFQpCixvcGVyYXRpb24gcG9zdCBjb25kaXRpb24sbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE0NSBsdXBzbHRva29wMUxhc2tpLGogaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE0NSBsdXBzbHRva29wMUxhc2tpLGsgaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE0NiBsdXBzbHRva29wMUxhc2tpLGogaW4gc2V0IGluZHMgbHVwc2xhcnIKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDE1MCBsdXBzbHRva29wMUxhc2tpLHByZV9NYXhPZlNldChjb21wYXRpYmxlKQosZnVuY3Rpb24gYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE0MCBsdXBzbHRva29wMUxhc2tpLFJFU1VMVCA+PSAwCixzdWJ0eXBlLG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDE1NiBsdXBzbU9wM0dyaWVzLChsdXBzbFNwZWMoYSkgPSBSRVNVTFQpCixvcGVyYXRpb24gcG9zdCBjb25kaXRpb24sbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE1OCBsdXBzbU9wM0dyaWVzLDEgaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE3MCBsdXBzbTRrb3AzR3JpZXMsKGxlbiBsdXBzbGFycikgaW4gc2V0IGluZHMgbHVwc2xhcnIKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDE3MCBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3MSBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3MiBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3MiBsdXBzbTRrb3AzR3JpZXMsMSBpbiBzZXQgaW5kcyBsdXBzbGFycgosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE3MyBsdXBzbTRrb3AzR3JpZXMsMSA+IDAgYW5kIDEgPD0gbGVuIChsdXBzbGFycikgKyAxCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3MyBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE3NyBsdXBzbTRrb3AzR3JpZXMsd2hpbGUgKGxpIDw+IChyZSAtIDEpKSBkbyAuLi4KLHdoaWxlIGxvb3AgdGVybWluYXRpb24sbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE3OSBsdXBzbTRrb3AzR3JpZXMsbSBpbiBzZXQgaW5kcyBsdXBzbGFycgosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDE3OSBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE4NCBsdXBzbTRrb3AzR3JpZXMscmUgPiAwIGFuZCByZSA8PSBsZW4gKGx1cHNsYXJyKSArIDEKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDE4NCBsdXBzbTRrb3AzR3JpZXMsayBpbiBzZXQgaW5kcyBhCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkfA== PROOFOBLIGATION: fDE4OSBsdXBzbE9wNExhc2tpLChsdXBzbFNwZWMoYSkgPSBSRVNVTFQpCixvcGVyYXRpb24gcG9zdCBjb25kaXRpb24sbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDIwNCBsdXBzbHRva29wMkxhc2tpLGogaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDIwNCBsdXBzbHRva29wMkxhc2tpLGsgaW4gc2V0IGluZHMgYQosc2VxdWVuY2UgYXBwbHksbnVsbCxVbnByb3ZlZHw= PROOFOBLIGATION: fDIwNSBsdXBzbHRva29wMkxhc2tpLGogaW4gc2V0IGluZHMgbHVwc2xhcnIKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDIwNiBsdXBzbHRva29wMkxhc2tpLGogaW4gc2V0IGluZHMgbHVwc2xhcnIKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWR8 PROOFOBLIGATION: fDIwMCBsdXBzbHRva29wMkxhc2tpLFJFU1VMVCA+PSAwCixzdWJ0eXBlLG51bGwsVW5wcm92ZWR8


--LUPSL.vdmsl

types

array = seq1 of int;

values

a1: array = [1,2,9,4,7,3]; --,11,8,14,6]; 
a2: array = [4,3,2,1];
a3 = [1,2,3,4]; 
a4 = [2];
a5 = [2,2,2,2];

functions

MaxOfSet: set of int -> int
MaxOfSet(s) ==
 let e in set s in
   if card s = 1 then
      e
   else
      let mr = MaxOfSet(s\{e}) in
         if e > mr then e else mr
 pre s <> {}
 post RESULT in set s and forall e in set s & e <= RESULT
 measure CardInt;

CardInt: set of int -> nat
CardInt(s) == card s;

lupsltok : array * nat1 -> nat
lupsltok(a,k) ==
 let compatible = {lupsltok(a,j) | j in set{1,...,k-1} & a(j)<=a(k)} 
 in
   if compatible = {} 
   then 1 
   else MaxOfSet(compatible) + 1; 

lupsl : array -> nat
lupsl(a) == 
  MaxOfSet({lupsltok(a,j) | j in set inds a});

ascending : array * set of int -> bool
ascending(a,s) ==
   forall i,j in set s & i<j => a(i)<=a(j) pre s subset (inds a);

lupslSpec : array -> int
lupslSpec(a) ==
   MaxOfSet({ card s | s in set power inds a & ascending(a,s) })

operations

lupslOp1Laski : array ==> nat
lupslOp1Laski(a) == 
  (dcl lupsls : set of nat := {};
   for all k in set inds a do
      lupsls := lupsls union {lupsltok(a,k)};
   return MaxOfSet(lupsls);
  )
post lupslSpec(a) = RESULT;

state lups of
  lupslarr : array 
init s == s = mk_lups([1])
end

operations

lupsmOp1Gries : array ==> nat
lupsmOp1Gries(a) == 
  (lupslarr := [a(1)];
   for k = 2 to len a do
      lupsm4kop1Gries(a,k);
   return len lupslarr;
  )
post lupslSpec(a) = RESULT;
 
lupsm4kop1Gries : array * nat1 ==> ()
lupsm4kop1Gries(a,k) ==
  (dcl i : int; 
   if lupslarr(len lupslarr)<=a(k) then
      lupslarr := lupslarr^[a(k)]
   else
     (i := iota x in set {1,...,len lupslarr} &
             lupslarr(x) > a(k) and 
             forall j in set {1,...,x-1} & lupslarr(j) <= a(k);
      lupslarr(i) := a(k);
     );
  )
pre k in set inds a;
 
lupslOp2Laski : array ==> nat
lupslOp2Laski(a) == 
  (dcl lupslmax : nat := 0;
   for k = 1 to len a do
      let lak = lupsltok(a,k) in
        if lak > lupslmax then lupslmax := lak;
   return lupslmax;
  )
post lupslSpec(a) = RESULT;
 
lupsmOp2Gries : array ==> nat
lupsmOp2Gries(a) == 
  (lupslarr := [a(1)];
   for k = 2 to len a do
      lupsm4kop2Gries(a,k);
   return len lupslarr;
  )
post lupslSpec(a) = RESULT;

lupsm4kop2Gries : array * nat1 ==> ()
lupsm4kop2Gries(a,k) ==
  (dcl i : int; 
   if lupslarr(len lupslarr)<=a(k) then
      lupslarr := lupslarr^[a(k)]
   else
     (i := 1;
      while lupslarr(i) <= a(k) do
         i := i+1;
      lupslarr(i) := a(k);
     );
  )
pre k in set inds a;
 
lupslOp3Laski : array ==> nat
lupslOp3Laski(a) == 
  (dcl lupslmax : nat := 0; 
   for k = 1 to len a do
      let lak = lupsltokop1Laski(a,k) in
        if lak > lupslmax 
        then lupslmax := lak;
   return lupslmax;
  )
post lupslSpec(a) = RESULT;

lupsltokop1Laski : array * nat1 ==> nat
lupsltokop1Laski(a,k) ==
  (dcl compatible : set of int := {};
   dcl erg : int; 
   for j = 1 to k-1 do
       if a(j)<=a(k) then
          compatible := (compatible union {lupslarr(j)});
   if compatible = {} then 
      erg := 1
   else 
      erg := MaxOfSet(compatible) + 1;
   lupslarr := lupslarr^[erg];
   return erg;
  )
pre k in set inds a; 
 
lupsmOp3Gries : array ==> nat
lupsmOp3Gries(a) == 
  (lupslarr := [a(1)];
   for k = 2 to len a do
      lupsm4kop3Gries(a,k);
   return len lupslarr;
  )
post lupslSpec(a) = RESULT;
 
lupsm4kop3Gries : array * nat1 ==> ()
lupsm4kop3Gries(a,k) ==
  (dcl li : int,
       re : int,
       m  : int; 
   if lupslarr(len lupslarr)<=a(k) then
          lupslarr := lupslarr^[a(k)]
   elseif a(k)< lupslarr(1) then 
      lupslarr(1) := a(k)
   else  
      (li := 1;
       re := len lupslarr;
       while li <> re-1 do
         (m := (li+re) div 2;
          if lupslarr(m)<=a(k) then
             li := m
          else
             re := m;
         );
         lupslarr(re) := a(k);
       );
  )
pre k in set inds a;
 
lupslOp4Laski : array ==> nat
lupslOp4Laski(a) == 
  (dcl lupslmax : nat := 0; 
   for k = 1 to len a do
      let lak = lupsltokop2Laski(a,k) in
        if lak > lupslmax 
        then lupslmax := lak;
   return lupslmax;
  )
post lupslSpec(a) = RESULT;
 
lupsltokop2Laski : array * nat1 ==> nat
lupsltokop2Laski(a,k) ==
  (dcl erg : int := 0; 
   for j = 1 to k-1 do
       if a(j)<=a(k) then
          if erg < lupslarr(j) 
          then erg := lupslarr(j);
   erg := erg+1;
   lupslarr := lupslarr^[erg];
   return erg;
  )
pre k in set inds a; 

 