-- TCErrors: WARNING:5000:54,3 WARNING:5000:59,3 WARNING:5000:64,3 WARNING:5000:71,1 PROOFOBLIGATION: cmVzcG9uc2VEQiwwLGZvcmFsbCBtMSwgbTIgaW4gc2V0IHt7PE1pc3NpbGVBPiB8LT4gW21rXyg8RmxhcmVPbmVBPiwgOTAwKSwgbWtfKDxGbGFyZVR3b0E+LCA1MDApLCBta18oPERvTm90aGluZ0E+LCAxMDApLCBta18oPEZsYXJlT25lQT4sIDUwMCldfSwgezxNaXNzaWxlQj4gfC0+IFtta18oPEZsYXJlVHdvQj4sIDUwMCksIG1rXyg8RmxhcmVUd29CPiwgNzAwKV19LCB7PE1pc3NpbGVDPiB8LT4gW21rXyg8RmxhcmVPbmVDPiwgNDAwKSwgbWtfKDxEb05vdGhpbmdDPiwgMTAwKSwgbWtfKDxGbGFyZVR3b0M+LCA0MDApLCBta18oPEZsYXJlT25lQz4sIDUwMCldfX0gJgogIGZvcmFsbCBkMyBpbiBzZXQgZG9tIG0xLCBkNCBpbiBzZXQgZG9tIG0yICYKICAgIGQzID0gZDQgPT4gbTEoZDMpID0gbTIoZDQpCixtYXAgc2VxdWVuY2UgY29tcGF0aWJsZSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: bWlzc2lsZVByaW9yaXR5LDAsZm9yYWxsIG0xLCBtMiBpbiBzZXQge3s8TWlzc2lsZUE+IHwtPiAxfSwgezxNaXNzaWxlQj4gfC0+IDJ9LCB7PE1pc3NpbGVDPiB8LT4gM30sIHs8Tm9uZT4gfC0+IDB9fSAmCiAgZm9yYWxsIGQzIGluIHNldCBkb20gbTEsIGQ0IGluIHNldCBkb20gbTIgJgogICAgZDMgPSBkNCA9PiBtMShkMykgPSBtMihkNCkKLG1hcCBzZXF1ZW5jZSBjb21wYXRpYmxlLG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: dGVzdHZhbDEsMCwoKCgoaW52X0FuZ2xlKDg4KSBhbmQgKGlzX25hdCg4OCkpKSkpCmFuZCAoKChpbnZfQW5nbGUoNzApIGFuZCAoaXNfbmF0KDcwKSkpKSkKYW5kICgoKGludl9BbmdsZSgyMjIpIGFuZCAoaXNfbmF0KDIyMikpKSkpCmFuZCAoKChpbnZfQW5nbGUoNDQpIGFuZCAoaXNfbmF0KDQ0KSkpKSkpCixzdWJ0eXBlLG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: dGVzdHZhbDIsMCwoKCgoaW52X0FuZ2xlKDE4OCkgYW5kIChpc19uYXQoMTg4KSkpKSkKYW5kICgoKGludl9BbmdsZSg3MCkgYW5kIChpc19uYXQoNzApKSkpKQphbmQgKCgoaW52X0FuZ2xlKDIpIGFuZCAoaXNfbmF0KDIpKSkpKQphbmQgKCgoaW52X0FuZ2xlKDQ0KSBhbmQgKGlzX25hdCg0NCkpKSkpKQosc3VidHlwZSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: dGVzdHZhbDMsMCwoKCgoaW52X0FuZ2xlKDI4OCkgYW5kIChpc19uYXQoMjg4KSkpKSkKYW5kICgoKGludl9BbmdsZSgxNzApIGFuZCAoaXNfbmF0KDE3MCkpKSkpCmFuZCAoKChpbnZfQW5nbGUoMjIyKSBhbmQgKGlzX25hdCgyMjIpKSkpKQphbmQgKCgoaW52X0FuZ2xlKDQ0KSBhbmQgKGlzX25hdCg0NCkpKSkpKQosc3VidHlwZSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: Q00sIGN1ck1pcywgYW5nbGUsMCwoZm9yYWxsIG1pc3NpbGVJbnB1dHM6TWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXI6T3V0cHV0LCBsYXN0TWlzc2lsZTptYXAgKE1hZ0lkKSB0byAoW01pc3NpbGVUeXBlXSksIGN1clRpbWU6bmF0ICYKICAobm90IChtaXNzaWxlSW5wdXRzID0gW10pID0+CiAgICBtaXNzaWxlSW5wdXRzIDw+IFtdKSkKLG5vbi1lbXB0eSBzZXF1ZW5jZSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: Q00sMCwoZm9yYWxsIG1pc3NpbGVJbnB1dHM6TWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXI6T3V0cHV0LCBsYXN0TWlzc2lsZTptYXAgKE1hZ0lkKSB0byAoW01pc3NpbGVUeXBlXSksIGN1clRpbWU6bmF0ICYKICAobm90IChtaXNzaWxlSW5wdXRzID0gW10pID0+CiAgICAobGV0IG1rXyhjdXJNaXMsIGFuZ2xlKTpNaXNzaWxlSW5wdXQgPSAoaGQgbWlzc2lsZUlucHV0cyksIG1hZ2lkOk1hZ0lkID0gQW5nbGUyTWFnSWQoYW5nbGUpIGluCiAgICAgIChub3QgKG1hZ2lkIG5vdCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpID0+CiAgICAgICAgKChtYWdpZCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpID0+CiAgICAgICAgICBjdXJNaXMgaW4gc2V0IGRvbSBtaXNzaWxlUHJpb3JpdHkpKSkpKQosbWFwIGFwcGx5LG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: Q00sMCwoZm9yYWxsIG1pc3NpbGVJbnB1dHM6TWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXI6T3V0cHV0LCBsYXN0TWlzc2lsZTptYXAgKE1hZ0lkKSB0byAoW01pc3NpbGVUeXBlXSksIGN1clRpbWU6bmF0ICYKICAobm90IChtaXNzaWxlSW5wdXRzID0gW10pID0+CiAgICAobGV0IG1rXyhjdXJNaXMsIGFuZ2xlKTpNaXNzaWxlSW5wdXQgPSAoaGQgbWlzc2lsZUlucHV0cyksIG1hZ2lkOk1hZ0lkID0gQW5nbGUyTWFnSWQoYW5nbGUpIGluCiAgICAgIChub3QgKG1hZ2lkIG5vdCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpID0+CiAgICAgICAgKChtYWdpZCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpID0+CiAgICAgICAgICBsYXN0TWlzc2lsZShtYWdpZCkgaW4gc2V0IGRvbSBtaXNzaWxlUHJpb3JpdHkpKSkpKQosbWFwIGFwcGx5LG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: Q00sMCwoZm9yYWxsIG1pc3NpbGVJbnB1dHM6TWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXI6T3V0cHV0LCBsYXN0TWlzc2lsZTptYXAgKE1hZ0lkKSB0byAoW01pc3NpbGVUeXBlXSksIGN1clRpbWU6bmF0ICYKICAobm90IChtaXNzaWxlSW5wdXRzID0gW10pID0+CiAgICAobGV0IG1rXyhjdXJNaXMsIGFuZ2xlKTpNaXNzaWxlSW5wdXQgPSAoaGQgbWlzc2lsZUlucHV0cyksIG1hZ2lkOk1hZ0lkID0gQW5nbGUyTWFnSWQoYW5nbGUpIGluCiAgICAgIChub3QgKG1hZ2lkIG5vdCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpID0+CiAgICAgICAgKChtYWdpZCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpID0+CiAgICAgICAgICAoKGlzXyhsYXN0TWlzc2lsZShtYWdpZCksIDxNaXNzaWxlQT4pKSBvcgogICAgICAgICAgKGlzXyhsYXN0TWlzc2lsZShtYWdpZCksIDxNaXNzaWxlQj4pKSBvcgogICAgICAgICAgKGlzXyhsYXN0TWlzc2lsZShtYWdpZCksIDxNaXNzaWxlQz4pKSBvcgogICAgICAgICAgKGlzXyhsYXN0TWlzc2lsZShtYWdpZCksIDxOb25lPikpKSkpKSkpCixzdWJ0eXBlLG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: Q00sMCwoZm9yYWxsIG1pc3NpbGVJbnB1dHM6TWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXI6T3V0cHV0LCBsYXN0TWlzc2lsZTptYXAgKE1hZ0lkKSB0byAoW01pc3NpbGVUeXBlXSksIGN1clRpbWU6bmF0ICYKICAobm90IChtaXNzaWxlSW5wdXRzID0gW10pID0+CiAgICAobGV0IG1rXyhjdXJNaXMsIGFuZ2xlKTpNaXNzaWxlSW5wdXQgPSAoaGQgbWlzc2lsZUlucHV0cyksIG1hZ2lkOk1hZ0lkID0gQW5nbGUyTWFnSWQoYW5nbGUpIGluCiAgICAgIChub3QgKG1hZ2lkIG5vdCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpID0+CiAgICAgICAgKChtYWdpZCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpID0+CiAgICAgICAgICBtYWdpZCBpbiBzZXQgZG9tIGxhc3RNaXNzaWxlKSkpKSkKLG1hcCBhcHBseSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: Q00sIG5ld091dHB1dCwwLChmb3JhbGwgbWlzc2lsZUlucHV0czpNaXNzaWxlSW5wdXRzLCBvdXRwdXRTb0ZhcjpPdXRwdXQsIGxhc3RNaXNzaWxlOm1hcCAoTWFnSWQpIHRvIChbTWlzc2lsZVR5cGVdKSwgY3VyVGltZTpuYXQgJgogIChub3QgKG1pc3NpbGVJbnB1dHMgPSBbXSkgPT4KICAgIChsZXQgbWtfKGN1ck1pcywgYW5nbGUpOk1pc3NpbGVJbnB1dCA9IChoZCBtaXNzaWxlSW5wdXRzKSwgbWFnaWQ6TWFnSWQgPSBBbmdsZTJNYWdJZChhbmdsZSkgaW4KICAgICAgKCgobWFnaWQgbm90IGluIHNldCAoZG9tIGxhc3RNaXNzaWxlKSkgb3IgKChtYWdpZCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpIGFuZCAobWlzc2lsZVByaW9yaXR5KGN1ck1pcykgPiBtaXNzaWxlUHJpb3JpdHkobGFzdE1pc3NpbGUobWFnaWQpKSkpKSA9PgogICAgICAgIGN1ck1pcyBpbiBzZXQgZG9tIHJlc3BvbnNlREIpKSkpCixtYXAgYXBwbHksbnVsbCxVbnByb3ZlZCw= PROOFOBLIGATION: Q00sMCwoZm9yYWxsIG1pc3NpbGVJbnB1dHM6TWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXI6T3V0cHV0LCBsYXN0TWlzc2lsZTptYXAgKE1hZ0lkKSB0byAoW01pc3NpbGVUeXBlXSksIGN1clRpbWU6bmF0ICYKICAobm90IChtaXNzaWxlSW5wdXRzID0gW10pID0+CiAgICAobGV0IG1rXyhjdXJNaXMsIGFuZ2xlKTpNaXNzaWxlSW5wdXQgPSAoaGQgbWlzc2lsZUlucHV0cyksIG1hZ2lkOk1hZ0lkID0gQW5nbGUyTWFnSWQoYW5nbGUpIGluCiAgICAgICgoKG1hZ2lkIG5vdCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpIG9yICgobWFnaWQgaW4gc2V0IChkb20gbGFzdE1pc3NpbGUpKSBhbmQgKG1pc3NpbGVQcmlvcml0eShjdXJNaXMpID4gbWlzc2lsZVByaW9yaXR5KGxhc3RNaXNzaWxlKG1hZ2lkKSkpKSkgPT4KICAgICAgICAobGV0IG5ld091dHB1dDpPdXRwdXQgPSBJbnRlcnJ1cHRQbGFuKGN1clRpbWUsIG91dHB1dFNvRmFyLCByZXNwb25zZURCKGN1ck1pcyksIG1hZ2lkKSBpbgogICAgICAgICAgQ01MZW4obWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXIsIGxhc3RNaXNzaWxlLCBjdXJUaW1lKSA+IENNTGVuKCh0bCBtaXNzaWxlSW5wdXRzKSwgbmV3T3V0cHV0LCAobGFzdE1pc3NpbGUgKysge21hZ2lkIHwtPiBjdXJNaXN9KSwgKGN1clRpbWUgKyBzdGVwTGVuZ3RoKSkpKSkpKQoscmVjdXJzaXZlIGZ1bmN0aW9uLG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: Q00sMCwoZm9yYWxsIG1pc3NpbGVJbnB1dHM6TWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXI6T3V0cHV0LCBsYXN0TWlzc2lsZTptYXAgKE1hZ0lkKSB0byAoW01pc3NpbGVUeXBlXSksIGN1clRpbWU6bmF0ICYKICAobm90IChtaXNzaWxlSW5wdXRzID0gW10pID0+CiAgICAobGV0IG1rXyhjdXJNaXMsIGFuZ2xlKTpNaXNzaWxlSW5wdXQgPSAoaGQgbWlzc2lsZUlucHV0cyksIG1hZ2lkOk1hZ0lkID0gQW5nbGUyTWFnSWQoYW5nbGUpIGluCiAgICAgICgoKG1hZ2lkIG5vdCBpbiBzZXQgKGRvbSBsYXN0TWlzc2lsZSkpIG9yICgobWFnaWQgaW4gc2V0IChkb20gbGFzdE1pc3NpbGUpKSBhbmQgKG1pc3NpbGVQcmlvcml0eShjdXJNaXMpID4gbWlzc2lsZVByaW9yaXR5KGxhc3RNaXNzaWxlKG1hZ2lkKSkpKSkgPT4KICAgICAgICAobGV0IG5ld091dHB1dDpPdXRwdXQgPSBJbnRlcnJ1cHRQbGFuKGN1clRpbWUsIG91dHB1dFNvRmFyLCByZXNwb25zZURCKGN1ck1pcyksIG1hZ2lkKSBpbgogICAgICAgICAgbWlzc2lsZUlucHV0cyA8PiBbXSkpKSkpCixub24tZW1wdHkgc2VxdWVuY2UsbnVsbCxVbnByb3ZlZCw= PROOFOBLIGATION: Q00sMCwoZm9yYWxsIG1pc3NpbGVJbnB1dHM6TWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXI6T3V0cHV0LCBsYXN0TWlzc2lsZTptYXAgKE1hZ0lkKSB0byAoW01pc3NpbGVUeXBlXSksIGN1clRpbWU6bmF0ICYKICAobm90IChtaXNzaWxlSW5wdXRzID0gW10pID0+CiAgICAobGV0IG1rXyhjdXJNaXMsIGFuZ2xlKTpNaXNzaWxlSW5wdXQgPSAoaGQgbWlzc2lsZUlucHV0cyksIG1hZ2lkOk1hZ0lkID0gQW5nbGUyTWFnSWQoYW5nbGUpIGluCiAgICAgIChub3QgKChtYWdpZCBub3QgaW4gc2V0IChkb20gbGFzdE1pc3NpbGUpKSBvciAoKG1hZ2lkIGluIHNldCAoZG9tIGxhc3RNaXNzaWxlKSkgYW5kIChtaXNzaWxlUHJpb3JpdHkoY3VyTWlzKSA+IG1pc3NpbGVQcmlvcml0eShsYXN0TWlzc2lsZShtYWdpZCkpKSkpID0+CiAgICAgICAgQ01MZW4obWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXIsIGxhc3RNaXNzaWxlLCBjdXJUaW1lKSA+IENNTGVuKCh0bCBtaXNzaWxlSW5wdXRzKSwgb3V0cHV0U29GYXIsIGxhc3RNaXNzaWxlLCAoY3VyVGltZSArIHN0ZXBMZW5ndGgpKSkpKSkKLHJlY3Vyc2l2ZSBmdW5jdGlvbixudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: Q00sMCwoZm9yYWxsIG1pc3NpbGVJbnB1dHM6TWlzc2lsZUlucHV0cywgb3V0cHV0U29GYXI6T3V0cHV0LCBsYXN0TWlzc2lsZTptYXAgKE1hZ0lkKSB0byAoW01pc3NpbGVUeXBlXSksIGN1clRpbWU6bmF0ICYKICAobm90IChtaXNzaWxlSW5wdXRzID0gW10pID0+CiAgICAobGV0IG1rXyhjdXJNaXMsIGFuZ2xlKTpNaXNzaWxlSW5wdXQgPSAoaGQgbWlzc2lsZUlucHV0cyksIG1hZ2lkOk1hZ0lkID0gQW5nbGUyTWFnSWQoYW5nbGUpIGluCiAgICAgIChub3QgKChtYWdpZCBub3QgaW4gc2V0IChkb20gbGFzdE1pc3NpbGUpKSBvciAoKG1hZ2lkIGluIHNldCAoZG9tIGxhc3RNaXNzaWxlKSkgYW5kIChtaXNzaWxlUHJpb3JpdHkoY3VyTWlzKSA+IG1pc3NpbGVQcmlvcml0eShsYXN0TWlzc2lsZShtYWdpZCkpKSkpID0+CiAgICAgICAgbWlzc2lsZUlucHV0cyA8PiBbXSkpKSkKLG5vbi1lbXB0eSBzZXF1ZW5jZSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: SW50ZXJydXB0UGxhbiwwLChmb3JhbGwgY3VyVGltZTpuYXQsIGV4cE91dHB1dDpPdXRwdXQsIHBsYW46UGxhbiwgbWFnaWQ6TWFnSWQgJgogICgobWFnaWQgaW4gc2V0IChkb20gZXhwT3V0cHV0KSkgPT4KICAgIG1hZ2lkIGluIHNldCBkb20gZXhwT3V0cHV0KSkKLG1hcCBhcHBseSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: SW50ZXJydXB0UGxhbiwwLChmb3JhbGwgY3VyVGltZTpuYXQsIGV4cE91dHB1dDpPdXRwdXQsIHBsYW46UGxhbiwgbWFnaWQ6TWFnSWQgJgogIGZvcmFsbCBsZG9tMSBpbiBzZXQgZG9tIHttYWdpZCB8LT4gKChpZiAobWFnaWQgaW4gc2V0IChkb20gZXhwT3V0cHV0KSkKICB0aGVuIExlYXZlUHJlZml4VW5jaGFuZ2VkKGV4cE91dHB1dChtYWdpZCksIGN1clRpbWUpCiAgZWxzZSBbXSkgXiBNYWtlT3V0cHV0RnJvbVBsYW4oY3VyVGltZSwgcGxhbikpfSwgcmRvbTIgaW4gc2V0IGRvbSAoe21hZ2lkfSA8LTogZXhwT3V0cHV0KSAmCiAgbGRvbTEgPSByZG9tMiA9PiB7bWFnaWQgfC0+ICgoaWYgKG1hZ2lkIGluIHNldCAoZG9tIGV4cE91dHB1dCkpCiAgdGhlbiBMZWF2ZVByZWZpeFVuY2hhbmdlZChleHBPdXRwdXQobWFnaWQpLCBjdXJUaW1lKQogIGVsc2UgW10pIF4gTWFrZU91dHB1dEZyb21QbGFuKGN1clRpbWUsIHBsYW4pKX0obGRvbTEpID0gKHttYWdpZH0gPC06IGV4cE91dHB1dCkocmRvbTIpKQosbWFwIGNvbXBhdGlibGUsbnVsbCxVbnByb3ZlZCw= PROOFOBLIGATION: TGVhdmVQcmVmaXhVbmNoYW5nZWQsMCwoZm9yYWxsIG91dHB1dF9sOnNlcSBvZiAoT3V0cHV0U3RlcCksIGN1clRpbWU6bmF0ICYKICAoZm9yYWxsIGkgaW4gc2V0IChpbmRzIG91dHB1dF9sKSAmIGxldCBta18oLSwgdCk6T3V0cHV0U3RlcCA9IG91dHB1dF9sKGkpIGluICh0IDw9IGN1clRpbWUpID0+CiAgICBpIGluIHNldCBpbmRzIG91dHB1dF9sKSkKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: TGVhdmVQcmVmaXhVbmNoYW5nZWQsIHQsMCwoZm9yYWxsIG91dHB1dF9sOnNlcSBvZiAoT3V0cHV0U3RlcCksIGN1clRpbWU6bmF0ICYKICAoZm9yYWxsIGkgaW4gc2V0IChpbmRzIG91dHB1dF9sKSAmCiAgICBpIGluIHNldCBpbmRzIG91dHB1dF9sKSkKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: TWFrZU91dHB1dEZyb21QbGFuLCBmbGFyZSwgdCwwLChmb3JhbGwgY3VyVGltZTpuYXQsIHJlc3BvbnNlOnNlcSBvZiAoUmVzcG9uc2UpICYKICAobGV0IG91dHB1dDpzZXEgb2YgKE91dHB1dFN0ZXApID0gT3V0cHV0QXRUaW1lWmVybyhyZXNwb25zZSkgaW4KICAgIChmb3JhbGwgaSBpbiBzZXQgKGluZHMgb3V0cHV0KSAmCiAgICAgIGkgaW4gc2V0IGluZHMgb3V0cHV0KSkpCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: T3V0cHV0QXRUaW1lWmVybywgZmlyc3RGbGFyZSwwLChmb3JhbGwgcmVzcG9uc2U6c2VxIG9mIChSZXNwb25zZSkgJgogIChsZXQgYWJzVGltZXM6c2VxIG9mICgoRmxhcmVUeXBlICogbmF0KSkgPSBSZWxhdGl2ZVRvQWJzb2x1dGVUaW1lcyhyZXNwb25zZSkgaW4KICAgIGFic1RpbWVzIDw+IFtdKSkKLG5vbi1lbXB0eSBzZXF1ZW5jZSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: T3V0cHV0QXRUaW1lWmVybywgdCwwLChmb3JhbGwgcmVzcG9uc2U6c2VxIG9mIChSZXNwb25zZSkgJgogIChsZXQgYWJzVGltZXM6c2VxIG9mICgoRmxhcmVUeXBlICogbmF0KSkgPSBSZWxhdGl2ZVRvQWJzb2x1dGVUaW1lcyhyZXNwb25zZSkgaW4KICAgIChsZXQgbWtfKGZpcnN0RmxhcmUsIC0pOihGbGFyZVR5cGUgKiBuYXQpID0gKGhkIGFic1RpbWVzKSBpbgogICAgICAoZm9yYWxsIGkgaW4gc2V0IHsyLCAuLi4gLChsZW4gYWJzVGltZXMpfSAmCiAgICAgICAgKGkgLSAxKSBpbiBzZXQgaW5kcyBhYnNUaW1lcykpKSkKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: T3V0cHV0QXRUaW1lWmVybywgZiwwLChmb3JhbGwgcmVzcG9uc2U6c2VxIG9mIChSZXNwb25zZSkgJgogIChsZXQgYWJzVGltZXM6c2VxIG9mICgoRmxhcmVUeXBlICogbmF0KSkgPSBSZWxhdGl2ZVRvQWJzb2x1dGVUaW1lcyhyZXNwb25zZSkgaW4KICAgIChsZXQgbWtfKGZpcnN0RmxhcmUsIC0pOihGbGFyZVR5cGUgKiBuYXQpID0gKGhkIGFic1RpbWVzKSBpbgogICAgICAoZm9yYWxsIGkgaW4gc2V0IHsyLCAuLi4gLChsZW4gYWJzVGltZXMpfSAmCiAgICAgICAgaSBpbiBzZXQgaW5kcyBhYnNUaW1lcykpKSkKLHNlcXVlbmNlIGFwcGx5LG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: UmVsYXRpdmVUb0Fic29sdXRlVGltZXMsIGYsIHQsMCwoZm9yYWxsIHRzOnNlcSBvZiAoUmVzcG9uc2UpICYKICAobm90ICh0cyA9IFtdKSA9PgogICAgdHMgPD4gW10pKQosbm9uLWVtcHR5IHNlcXVlbmNlLG51bGwsVW5wcm92ZWQs PROOFOBLIGATION: UmVsYXRpdmVUb0Fic29sdXRlVGltZXMsIG5zLDAsKGZvcmFsbCB0czpzZXEgb2YgKFJlc3BvbnNlKSAmCiAgKG5vdCAodHMgPSBbXSkgPT4KICAgIFJlc3BMZW4odHMpID4gUmVzcExlbigodGwgdHMpKSkpCixyZWN1cnNpdmUgZnVuY3Rpb24sbnVsbCxVbnByb3ZlZCw= PROOFOBLIGATION: UmVsYXRpdmVUb0Fic29sdXRlVGltZXMsIG5zLDAsKGZvcmFsbCB0czpzZXEgb2YgKFJlc3BvbnNlKSAmCiAgKG5vdCAodHMgPSBbXSkgPT4KICAgIHRzIDw+IFtdKSkKLG5vbi1lbXB0eSBzZXF1ZW5jZSxudWxsLFVucHJvdmVkLA== PROOFOBLIGATION: UmVsYXRpdmVUb0Fic29sdXRlVGltZXMsIG5mLCBudCwwLChmb3JhbGwgdHM6c2VxIG9mIChSZXNwb25zZSkgJgogIChub3QgKHRzID0gW10pID0+CiAgICAobGV0IG1rXyhmLCB0KTpSZXNwb25zZSA9IChoZCB0cyksIG5zOnNlcSBvZiAoKEZsYXJlVHlwZSAqIG5hdCkpID0gUmVsYXRpdmVUb0Fic29sdXRlVGltZXMoKHRsIHRzKSkgaW4KICAgICAgKGZvcmFsbCBpIGluIHNldCAoaW5kcyBucykgJgogICAgICAgIGkgaW4gc2V0IGluZHMgbnMpKSkpCixzZXF1ZW5jZSBhcHBseSxudWxsLFVucHJvdmVkLA==


--CMflat.vdmsl

\begin{vdm_al}
types

  MissileInputs = seq of MissileInput;

  MissileInput = MissileType * Angle;

  MissileType = <MissileA> | <MissileB> | <MissileC> | <None>;

  Angle = nat
  inv num == num <= 360;

  Output = map MagId to seq of OutputStep;

  MagId = token;

  OutputStep = FlareType * AbsTime;

  Response = FlareType * nat;

  AbsTime = nat;

  FlareType = <FlareOneA>  | <FlareTwoA>  | <FlareOneB> |
              <FlareTwoB>  | <FlareOneC>  | <FlareTwoC> |
              <DoNothingA> | <DoNothingB> | <DoNothingC>;

  Plan = seq of (FlareType * Delay);

  Delay = nat;

values

  responseDB : map MissileType to Plan =
    {<MissileA> |-> [ mk_(<FlareOneA>,900), mk_(<FlareTwoA>,500),
                      mk_(<DoNothingA>,100), mk_(<FlareOneA>,500)],
     <MissileB> |-> [ mk_(<FlareTwoB>,500), mk_(<FlareTwoB>,700)],
     <MissileC> |-> [ mk_(<FlareOneC>,400), mk_(<DoNothingC>,100),
                      mk_(<FlareTwoC>,400), mk_(<FlareOneC>,500)]
    };

  missilePriority : map MissileType to nat
                      = {<MissileA> |-> 1,
                         <MissileB> |-> 2,
                         <MissileC> |-> 3,
                         <None> |-> 0};

  stepLength : nat = 100;

  testval1 : MissileInputs = [mk_(<MissileA>,88),
                              mk_(<MissileB>,70),
                              mk_(<MissileA>,222),
                              mk_(<MissileC>,44)];

  testval2 : MissileInputs = [mk_(<MissileC>,188),
                              mk_(<MissileB>,70),
                              mk_(<MissileA>,2),
                              mk_(<MissileC>,44)];

  testval3 : MissileInputs = [mk_(<MissileA>,288),
                              mk_(<MissileB>,170),
                              mk_(<MissileA>,222),
                              mk_(<MissileC>,44)];

functions

CounterMeasures: MissileInputs -> Output
CounterMeasures(missileInputs) ==
  CM(missileInputs,{|->},{|->},0);

CM: MissileInputs * Output * map MagId to [MissileType] * 
    nat -> Output
CM( missileInputs, outputSoFar, lastMissile, curTime) ==
  if missileInputs = []
  then outputSoFar
  else let mk_(curMis,angle) = hd missileInputs,
           magid = Angle2MagId(angle)
       in
         if magid not in set dom lastMissile or
            (magid in set dom lastMissile and
             missilePriority(curMis) > 
             missilePriority(lastMissile(magid)))
         then let newOutput = 
                     InterruptPlan(curTime,outputSoFar,
                                   responseDB(curMis),
                                   magid)
              in CM(tl missileInputs, newOutput, 
                    lastMissile ++ {magid |-> curMis},
                    curTime + stepLength)
         else CM(tl missileInputs, outputSoFar, 
                 lastMissile,curTime + stepLength)
measure CMLen;

CMLen: MissileInputs * Output * map MagId to [MissileType] * nat -> nat
CMLen(list,-,-,-) == len list;
    
InterruptPlan: nat * Output * Plan * MagId -> Output
InterruptPlan(curTime,expOutput,plan,magid) ==
  {magid |-> (if magid in set dom expOutput
              then LeavePrefixUnchanged(expOutput(magid), 
                                        curTime)
              else []) ^
              MakeOutputFromPlan(curTime, plan)} 
  munion
  ({magid} <-: expOutput);

LeavePrefixUnchanged: seq of OutputStep * nat -> 
                      seq of OutputStep
LeavePrefixUnchanged(output_l, curTime) ==
  [output_l(i) | i in set inds output_l
               & let mk_(-,t) = output_l(i) in t <= curTime];

MakeOutputFromPlan : nat * seq of Response -> seq of OutputStep
MakeOutputFromPlan(curTime, response) ==
  let output = OutputAtTimeZero(response) in
    [let mk_(flare,t) = output(i)
     in
       mk_(flare,t+curTime)
    | i in set inds output];

OutputAtTimeZero : seq of Response -> seq of OutputStep
OutputAtTimeZero(response) ==
  let absTimes = RelativeToAbsoluteTimes(response) in
    let mk_(firstFlare,-) = hd absTimes in
      [mk_(firstFlare,0)] ^
      [ let mk_(-,t) = absTimes(i-1),
            mk_(f,-) = absTimes(i) in
          mk_(f,t) | i in set {2,...,len absTimes}];

RelativeToAbsoluteTimes : seq of Response -> 
                          seq of (FlareType * nat)
RelativeToAbsoluteTimes(ts) ==
  if ts = []
  then []
  else let mk_(f,t) = hd ts,
           ns = RelativeToAbsoluteTimes(tl ts) in
         [mk_(f,t)] ^ [ let mk_(nf, nt) = ns(i)
                        in mk_(nf, nt + t)
                      | i in set inds ns]
measure RespLen;

RespLen: seq of Response -> nat
RespLen(l) ==
  len l;

Angle2MagId: Angle -> MagId
Angle2MagId(angle) ==
  if angle < 90
  then mk_token("Magazine 1")
  elseif angle < 180
  then mk_token("Magazine 2")
  elseif angle < 270
  then mk_token("Magazine 3")
  else mk_token("Magazine 4");
\end{vdm_al}

\begin{rtinfo}[RelativeToAbsoluteTimes]
{vdm.tc}[DefaultMod]
\end{rtinfo}