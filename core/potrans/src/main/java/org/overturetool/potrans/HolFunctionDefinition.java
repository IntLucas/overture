//
// THIS FILE IS AUTOMATICALLY GENERATED!!
//
// Generated at 2008-11-08 by the VDM++ to JAVA Code Generator
// (v8.1.1b - Fri 24-Oct-2008 08:59:25)
//
// Supported compilers: jdk 1.4/1.5/1.6
//

// ***** VDMTOOLS START Name=HeaderComment KEEP=NO
// ***** VDMTOOLS END Name=HeaderComment

// ***** VDMTOOLS START Name=package KEEP=NO
package org.overturetool.potrans;

// ***** VDMTOOLS END Name=package

// ***** VDMTOOLS START Name=imports KEEP=YES

import jp.co.csk.vdm.toolbox.VDM.*;
import java.util.*;
// ***** VDMTOOLS END Name=imports



public class HolFunctionDefinition extends HolDefinition {

// ***** VDMTOOLS START Name=vdmComp KEEP=NO
  static UTIL.VDMCompare vdmComp = new UTIL.VDMCompare();
// ***** VDMTOOLS END Name=vdmComp

// ***** VDMTOOLS START Name=name KEEP=NO
  private String name = null;
// ***** VDMTOOLS END Name=name

// ***** VDMTOOLS START Name=function KEEP=NO
  private HolFunction function = null;
// ***** VDMTOOLS END Name=function


// ***** VDMTOOLS START Name=vdm_init_HolFunctionDefinition KEEP=NO
  private void vdm_init_HolFunctionDefinition () throws CGException {}
// ***** VDMTOOLS END Name=vdm_init_HolFunctionDefinition


// ***** VDMTOOLS START Name=HolFunctionDefinition KEEP=NO
  public HolFunctionDefinition () throws CGException {
    vdm_init_HolFunctionDefinition();
  }
// ***** VDMTOOLS END Name=HolFunctionDefinition


// ***** VDMTOOLS START Name=HolFunctionDefinition#2|String|HolFunction KEEP=NO
  public HolFunctionDefinition (final String newN, final HolFunction newF) throws CGException {

    vdm_init_HolFunctionDefinition();
    {

      name = UTIL.ConvertToString(UTIL.clone(newN));
      function = (HolFunction) UTIL.clone(newF);
    }
  }
// ***** VDMTOOLS END Name=HolFunctionDefinition#2|String|HolFunction


// ***** VDMTOOLS START Name=setTypeInformation#1|HolTypeDescription KEEP=NO
  public void setTypeInformation (final HolTypeDescription typeInfo) throws CGException {
    function.setTypeInformation((HolTypeDescription) typeInfo);
  }
// ***** VDMTOOLS END Name=setTypeInformation#1|HolTypeDescription


// ***** VDMTOOLS START Name=provides KEEP=NO
  public HashSet provides () throws CGException {

    HashSet rexpr_1 = new HashSet();
    rexpr_1 = new HashSet();
    rexpr_1.add(name);
    return rexpr_1;
  }
// ***** VDMTOOLS END Name=provides


// ***** VDMTOOLS START Name=requires KEEP=NO
  public HashSet requires () throws CGException {

    HashSet rexpr_1 = new HashSet();
    HashSet var1_2 = new HashSet();
    var1_2 = function.requires();
    rexpr_1 = (HashSet) var1_2.clone();
    rexpr_1.removeAll(provides());
    return rexpr_1;
  }
// ***** VDMTOOLS END Name=requires


// ***** VDMTOOLS START Name=print KEEP=NO
  public String print () throws CGException {
    if (new Boolean(function instanceof HolLambdaFunction).booleanValue()) {

      String params = getParameterDescription(getBoundedVars((HolLambdaFunction) function), getDomainTypes((HolLambdaFunction) function));
      String rexpr_31 = null;
      Vector unArg_32 = null;
      unArg_32 = new Vector();
      unArg_32.add(new String("Define `"));
      unArg_32.add(name);
      unArg_32.add(new String(" "));
      unArg_32.add(params);
      unArg_32.add(new String(" = "));
      String e_seq_38 = null;
      HolExpression obj_39 = null;
      obj_39 = (HolExpression) (HolExpression) getBody((HolLambdaFunction) function);
      e_seq_38 = obj_39.print();
      unArg_32.add(e_seq_38);
      unArg_32.add(new String("`;\n"));
      String e_seq_42 = null;
      String var1_43 = null;
      var1_43 = new String("BasicProvers.export_rewrites([\"").concat(name);
      e_seq_42 = var1_43.concat(new String("_def\"]);\n"));
      unArg_32.add(e_seq_42);
      String rdcseq_47 = new String();
      for (Iterator enm_50 = unArg_32.iterator(); enm_50.hasNext(); ) {

        String e_48 = UTIL.ConvertToString(enm_50.next());
        rdcseq_47 = rdcseq_47.concat(e_48);
      }
      rexpr_31 = rdcseq_47;
      return rexpr_31;
    }
    else {

      String rexpr_3 = null;
      Vector unArg_4 = null;
      unArg_4 = new Vector();
      unArg_4.add(new String("Define `"));
      String e_seq_6 = null;
      HolApplication obj_7 = null;
      Vector arg_9 = null;
      arg_9 = new Vector();
      arg_9.add(new HolIdentifier(name));
      arg_9.add(function);
      obj_7 = new HolApplication(new HolReferedFunction(new HolNativeIdentifier(new String("$="))), arg_9);
      e_seq_6 = obj_7.print();
      unArg_4.add(e_seq_6);
      unArg_4.add(new String("`;\n"));
      String e_seq_16 = null;
      String var1_17 = null;
      var1_17 = new String("BasicProvers.export_rewrites([\"").concat(name);
      e_seq_16 = var1_17.concat(new String("_def\"]);\n"));
      unArg_4.add(e_seq_16);
      String rdcseq_21 = new String();
      for (Iterator enm_24 = unArg_4.iterator(); enm_24.hasNext(); ) {

        String e_22 = UTIL.ConvertToString(enm_24.next());
        rdcseq_21 = rdcseq_21.concat(e_22);
      }
      rexpr_3 = rdcseq_21;
      return rexpr_3;
    }
  }
// ***** VDMTOOLS END Name=print


// ***** VDMTOOLS START Name=getParameterDescription#2|Vector|Vector KEEP=NO
  private String getParameterDescription (final Vector names, final Vector ptypes) throws CGException {

    String varRes_3 = null;
    if (new Boolean(UTIL.equals(names, new Vector())).booleanValue()) 
      varRes_3 = new String("");
    else {

      Vector unArg_8 = null;
      unArg_8 = new Vector();
      unArg_8.add(new String("("));
      String e_seq_10 = null;
      HolIdentifier obj_11 = null;
      obj_11 = (HolIdentifier) (HolIdentifier) names.get(0);
      e_seq_10 = obj_11.print();
      unArg_8.add(e_seq_10);
      unArg_8.add(new String(":"));
      String e_seq_14 = null;
      HolType obj_15 = null;
      obj_15 = (HolType) (HolType) ptypes.get(0);
      e_seq_14 = obj_15.print(new org.overturetool.potrans.quotes.term());
      unArg_8.add(e_seq_14);
      unArg_8.add(new String(") "));
      unArg_8.add(getParameterDescription(new Vector(names.subList(1, names.size())), new Vector(ptypes.subList(1, ptypes.size()))));
      String rdcseq_24 = new String();
      for (Iterator enm_27 = unArg_8.iterator(); enm_27.hasNext(); ) {

        String e_25 = UTIL.ConvertToString(enm_27.next());
        rdcseq_24 = rdcseq_24.concat(e_25);
      }
      varRes_3 = rdcseq_24;
    }
    return varRes_3;
  }
// ***** VDMTOOLS END Name=getParameterDescription#2|Vector|Vector


// ***** VDMTOOLS START Name=getDomainTypes#1|HolLambdaFunction KEEP=NO
  private Vector getDomainTypes (final HolLambdaFunction function) throws CGException {

    Vector varRes_2 = null;
    HolProductType obj_3 = null;
    HolFunctionType obj_4 = null;
    obj_4 = (HolFunctionType) function.getType();
    obj_3 = (HolProductType) obj_4.getDomain();
    varRes_2 = obj_3.getTypes();
    return varRes_2;
  }
// ***** VDMTOOLS END Name=getDomainTypes#1|HolLambdaFunction


// ***** VDMTOOLS START Name=getBoundedVars#1|HolLambdaFunction KEEP=NO
  private Vector getBoundedVars (final HolLambdaFunction function) throws CGException {

    Vector varRes_2 = null;
    varRes_2 = function.getBoundedVars();
    return varRes_2;
  }
// ***** VDMTOOLS END Name=getBoundedVars#1|HolLambdaFunction


// ***** VDMTOOLS START Name=getBody#1|HolLambdaFunction KEEP=NO
  private HolExpression getBody (final HolLambdaFunction function) throws CGException {

    HolExpression varRes_2 = null;
    varRes_2 = (HolExpression) function.getBody();
    return (HolExpression) varRes_2;
  }
// ***** VDMTOOLS END Name=getBody#1|HolLambdaFunction

}
;
